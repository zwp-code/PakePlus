var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,s=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&i(e,n,t[n]);if(o)for(var n of o(t))a.call(t,n)&&i(e,n,t[n]);return e},r=(e,o)=>t(e,n(o));import{m as d,g as c,d as u,r as p,c as m,o as g,a as f,t as h,_ as v,G as b,u as y,i as k,w,b as x,e as C,f as S,h as I,j as D,k as _,l as V,F as $,n as T,p as L,q as E,s as P,v as U,x as M,y as B,z as A,A as O,B as j,C as R,D as F,E as H,H as N,I as z,J as q,K as Q,T as W,L as K,M as J,N as G,O as Z,P as X,Q as Y,R as ee,S as te,U as ne,V as oe,W as le,X as ae,Y as ie,Z as se,$ as re,a0 as de,a1 as ce,a2 as ue,a3 as pe,a4 as me,a5 as ge,a6 as fe,a7 as he,a8 as ve,a9 as be,aa as ye,ab as ke,ac as we,ad as xe,ae as Ce,af as Se,ag as Ie,ah as De,ai as _e,aj as Ve,ak as $e,al as Te,am as Le,an as Ee}from"./index-6a0d579b.js";import{b as Pe}from"./boy-09783d30.js";import{g as Ue,v as Me}from"./validator-ad586801.js";import{l as Be}from"./logo-6a1fb798.js";import{N as Ae}from"./NoticeDialog-6b8c53c3.js";import{F as Oe,u as je,q as Re,Q as Fe}from"./qq-f535eb68.js";import{u as He}from"./useWindow-cd5ccb2a.js";import{w as Ne}from"./windowHeader-771d8f32.js";import{u as ze,w as qe,r as Qe}from"./xlsx-eef54bab.js";var We,Ke,Je,Ge,Ze,Xe,Ye={exports:{}};
/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/We=Ye,Ke="undefined"!=typeof window&&void 0!==window.document?window.document:{},Je=We.exports,Ge=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,o=t.length,l={};n<o;n++)if((e=t[n])&&e[1]in Ke){for(n=0;n<e.length;n++)l[t[0][n]]=e[n];return l}return!1}(),Ze={change:Ge.fullscreenchange,error:Ge.fullscreenerror},Xe={request:function(e,t){return new Promise(function(n,o){var l=function(){this.off("change",l),n()}.bind(this);this.on("change",l);var a=(e=e||Ke.documentElement)[Ge.requestFullscreen](t);a instanceof Promise&&a.then(l).catch(o)}.bind(this))},exit:function(){return new Promise(function(e,t){if(this.isFullscreen){var n=function(){this.off("change",n),e()}.bind(this);this.on("change",n);var o=Ke[Ge.exitFullscreen]();o instanceof Promise&&o.then(n).catch(t)}else e()}.bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,t){var n=Ze[e];n&&Ke.addEventListener(n,t,!1)},off:function(e,t){var n=Ze[e];n&&Ke.removeEventListener(n,t,!1)},raw:Ge},Ge?(Object.defineProperties(Xe,{isFullscreen:{get:function(){return Boolean(Ke[Ge.fullscreenElement])}},element:{enumerable:!0,get:function(){return Ke[Ge.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(Ke[Ge.fullscreenEnabled])}}}),Je?We.exports=Xe:window.screenfull=Xe):Je?We.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};var et=Ye.exports;const tt=u({name:"DonateDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close"],setup(e,t){const{proxy:n}=c();let o=p({dialogVisible:e.visible,thanks:[],payTypeList:[{value:"0",label:"支付宝",icon:"alipay",color:"#447df6"},{value:"1",label:"微信",icon:"wx",color:"#2cac30"}],payInfo:{payType:"0",status:"0",outTradeNo:"",totalAmount:"",subject:"赞助",version:"",uid:"",orderType:"2"},loading:!1,wxPayInfo:null,wxPayData:null,payTimer:null});const l=m((()=>e=>new URL(`/svg/${e}.svg`,window.location.origin).href));let a={handleSelect(e,t){o.payInfo.payType=e.value},handleClose(){o.dialogVisible=!1,t.emit("close")},handleGenerateOrder(){if(o.payInfo.outTradeNo=b(),o.payInfo.totalAmount=String(parseFloat(Number(o.payInfo.totalAmount).toFixed(1))),"0"===o.payInfo.totalAmount)return n.$message.warning("金额需要大于等于1喔");const e=n.$bmob.Query("Order");e.set("payType",o.payInfo.payType),e.set("status",o.payInfo.status),e.set("subject",o.payInfo.subject),e.set("totalAmount",o.payInfo.totalAmount),e.set("uid",y.v1()),e.set("version",o.payInfo.version),e.set("outTradeNo",o.payInfo.outTradeNo),e.set("orderType",o.payInfo.orderType),e.save().then((async e=>{"0"===o.payInfo.payType?a.handleAliPay(e):a.handleWxPay()})).catch((e=>{o.loading=!1,n.$message.error("赞助失败，请稍后再试吧！")}))},async handleAliPay(e){try{let t=r(s({},e),{returnUrl:window.location.origin+"/about"}),o=k()?"wap":"page";const l=await n.$http.alipay(t,o);a.handleClose(),window.open(l.data.url,"_blank")}catch(t){o.loading=!1,n.$message.error("跳转支付失败，请换一种方式吧~")}},async handleWxPay(){try{let e=o.payInfo.outTradeNo,t=Math.floor((new Date).getTime()/1e3),l=w({mch_id:n.$config.WX_MCH_ID,out_trade_no:e,total_fee:o.payInfo.totalAmount,body:o.payInfo.subject,timestamp:String(t),notify_url:"https://api.zwpyyds.com/px/api/wxpay/notify"},n.$config.WX_KEY),a={mch_id:n.$config.WX_MCH_ID,out_trade_no:e,total_fee:o.payInfo.totalAmount,body:o.payInfo.subject,timestamp:String(t),notify_url:"https://api.zwpyyds.com/px/api/wxpay/notify",sign:l};o.wxPayData=JSON.parse(JSON.stringify(a)),a.time_expire="2m";const i=await n.$http.wxPay(a);o.loading=!1,0===i.data.code?o.wxPayInfo=i.data:n.$message.error("请求支付失败，请联系作者")}catch(e){o.loading=!1,n.$message.error("请求支付失败，请联系作者")}},handleConfirm:async()=>""===o.payInfo.version.trim()||""===o.payInfo.totalAmount.trim()?n.$message.warning("请填写赞助信息喔~"):(o.payInfo.totalAmount=String(parseFloat(Number(o.payInfo.totalAmount).toFixed(1))),0===Number(o.payInfo.totalAmount)?n.$message.warning("金额需要大于等于1喔"):(o.loading=!0,void a.handleGenerateOrder())),handleFinishWxPay(){o.wxPayData&&(o.payTimer&&clearTimeout(o.payTimer),o.loading=!0,o.payTimer=setTimeout((async()=>{try{const e=await n.$http.wxPayVerify(o.wxPayData);e.data.status?(n.$message.success(e.data.msg),o.loading=!1,a.handleClose(),setTimeout((()=>{window.location.reload()}),1e3)):(o.loading=!1,n.$message.error(e.data.msg))}catch(e){o.loading=!1,n.$message.error("查询支付失败，请联系作者")}}),5e3))}};return g((()=>{f()&&(o.payInfo.payType="1")})),r(s(s({},h(o)),a),{getIcon:l,checkIsClientEnv:f})}}),nt=e=>(M("data-v-9ae5fd84"),e=e(),B(),e),ot={key:0,class:"donate-content scrollbar"},lt={class:"flex-column-start full-w",style:{margin:"20px 0",gap:"15px"}},at=nt((()=>D("p",null,"未知足下如何称呼？",-1))),it={class:"flex-column-start full-w",style:{margin:"20px 0",gap:"15px"}},st=nt((()=>D("p",null,"赞助金额",-1))),rt={key:1,class:"donate-item flex-center"},dt=nt((()=>D("p",null,"请您在微信支付时填写留言(昵称),以便在赞助列表中展示！",-1))),ct={key:2,style:{margin:"10px 0"},class:"full-w"},ut=nt((()=>D("p",null,"支付类型",-1))),pt={class:"page-box"},mt=["onClick"],gt=["src"],ft={key:1,class:"donate-content scrollbar"},ht={class:"donate-item flex-center"},vt=nt((()=>D("p",null,"请使用微信扫一扫完成支付（有效期2分钟）",-1))),bt={class:"dialog-footer"},yt=A("取 消"),kt=A("确 定"),wt=A("已完成支付");var xt=v(tt,[["render",function(e,t,n,o,l,a){const i=x("el-input"),s=x("el-image"),r=x("el-button"),d=x("el-dialog");return C(),S(d,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dialogVisible=t),title:"赞助作者",width:400,"lock-scroll":!1,"before-close":e.handleClose,class:"z-dialog",center:""},{footer:I((()=>[D("span",bt,[e.wxPayInfo?_("v-if",!0):(C(),S(r,{key:0,onClick:e.handleClose},{default:I((()=>[yt])),_:1},8,["onClick"])),e.wxPayInfo?(C(),S(r,{key:2,type:"success",onClick:e.handleFinishWxPay,loading:e.loading},{default:I((()=>[wt])),_:1},8,["onClick","loading"])):(C(),S(r,{key:1,type:"primary",onClick:e.handleConfirm,loading:e.loading},{default:I((()=>[kt])),_:1},8,["onClick","loading"]))])])),default:I((()=>{var n,o;return[e.wxPayInfo?(C(),V("div",ft,[D("div",ht,[T(s,{src:null==(o=null==(n=e.wxPayInfo)?void 0:n.data)?void 0:o.QRcode_url,fit:"contain"},null,8,["src"]),vt])])):(C(),V("div",ot,[e.checkIsClientEnv()?_("v-if",!0):(C(),V($,{key:0},[D("div",lt,[at,T(i,{modelValue:e.payInfo.version,"onUpdate:modelValue":t[0]||(t[0]=t=>e.payInfo.version=t),placeholder:"请输入您的大名",clearable:""},null,8,["modelValue"])]),D("div",it,[st,T(i,{type:"number",modelValue:e.payInfo.totalAmount,"onUpdate:modelValue":t[1]||(t[1]=t=>e.payInfo.totalAmount=t),placeholder:"请输入赞助金额",clearable:""},null,8,["modelValue"])])],64)),e.checkIsClientEnv()?(C(),V("div",rt,[T(s,{style:{"border-radius":"10px"},src:"/static/png/wxDonate-e124c4fb.png",fit:"contain"},null,8,["src"]),dt])):_("v-if",!0),e.checkIsClientEnv()?_("v-if",!0):(C(),V("div",ct,[ut,D("div",pt,[(C(!0),V($,null,L(e.payTypeList,((t,n)=>(C(),V("div",{class:E(["page-icon flex-column-center pointer",{active:n==e.payInfo.payType}]),key:t.value,onClick:o=>e.handleSelect(t,n)},[D("img",{src:e.getIcon(t.icon),style:P({backgroundColor:t.color})},null,12,gt),D("span",null,U(t.label),1)],10,mt)))),128))])]))]))]})),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-9ae5fd84"],["__file","D:/project/pixel-grid/src/components/dialog/DonateDialog.vue"]]);const Ct=u({name:"AddLinkOrDonateDialog",components:{},props:{visible:{type:Boolean,default:!1},title:{type:String,default:"添 加"},type:{type:String,default:"Link"}},emits:["close"],setup(e,t){const{proxy:n}=c();O();let o=p({loading:!1,dialogVisible:e.visible,form:{Link:{label:"",type:"",url:"",icon:"",fontColor:""},Donate:{name:"",avatar:"null",link:"null",amount:0}}}),l={handleClose(){o.dialogVisible=!1,t.emit("close")},async handleConfirm(){o.loading=!0;const t=n.$bmob.Query(e.type);for(let n in o.form[e.type])"amount"===n?t.set(n,Number(o.form[e.type][n])):t.set(n,o.form[e.type][n]);t.save().then((e=>{o.loading=!1,n.$message.success("添加成功"),l.handleClose()})).catch((e=>{o.loading=!1,n.$message.error("添加失败")}))}};return s(s({},h(o)),l)}}),St=["src"],It={class:"dialog-footer"},Dt=A("取 消"),_t=A("确 定");var Vt=v(Ct,[["render",function(e,t,n,o,l,a){const i=x("el-input"),s=x("el-form-item"),r=x("el-color-picker"),d=x("el-link"),c=x("el-form"),u=x("el-button"),p=x("el-dialog");return C(),S(p,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[9]||(t[9]=t=>e.dialogVisible=t),title:e.title,"before-close":e.handleClose,class:"z-dialog",center:"","close-on-click-modal":!1,width:350},{footer:I((()=>[D("span",It,[T(u,{onClick:e.handleClose},{default:I((()=>[Dt])),_:1},8,["onClick"]),T(u,{type:"primary",onClick:e.handleConfirm,loading:e.loading},{default:I((()=>[_t])),_:1},8,["onClick","loading"])])])),default:I((()=>["Link"===e.type?(C(),S(c,{key:0,model:e.form.Link,"label-position":"top"},{default:I((()=>[T(s,{label:"链接名称"},{default:I((()=>[T(i,{modelValue:e.form.Link.label,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.Link.label=t),placeholder:"请输入名称",clearable:""},null,8,["modelValue"])])),_:1}),T(s,{label:"链接图标颜色"},{default:I((()=>[T(r,{modelValue:e.form.Link.type,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.Link.type=t)},null,8,["modelValue"])])),_:1}),T(s,{label:"链接字体颜色"},{default:I((()=>[T(r,{modelValue:e.form.Link.fontColor,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.Link.fontColor=t)},null,8,["modelValue"])])),_:1}),T(s,{label:"链接URL"},{default:I((()=>[T(i,{modelValue:e.form.Link.url,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.Link.url=t),placeholder:"请输入链接",clearable:""},null,8,["modelValue"])])),_:1}),T(s,{label:"链接图标"},{default:I((()=>[T(i,{modelValue:e.form.Link.icon,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.Link.icon=t),placeholder:"请输入链接",clearable:""},null,8,["modelValue"])])),_:1}),T(s,{label:"预览"},{default:I((()=>{var t;return[T(d,{underline:!1,class:"link",type:"#"===e.form.Link.type.slice(0,1)?"":e.form.Link.type,style:P({color:(null==(t=e.form.Link)?void 0:t.fontColor)||e.form.Link.type})},{default:I((()=>[e.form.Link.icon?(C(),V("img",{key:0,src:e.form.Link.icon,style:P({backgroundColor:e.form.Link.type})},null,12,St)):_("v-if",!0),A(" "+U(e.form.Link.label),1)])),_:1},8,["type","style"])]})),_:1})])),_:1},8,["model"])):"Donate"===e.type?(C(),S(c,{key:1,model:e.form.Donate,"label-position":"top"},{default:I((()=>[T(s,{label:"赞助名称"},{default:I((()=>[T(i,{modelValue:e.form.Donate.name,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.Donate.name=t),placeholder:"请输入名称",clearable:""},null,8,["modelValue"])])),_:1}),T(s,{label:"赞助外链"},{default:I((()=>[T(i,{modelValue:e.form.Donate.link,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.Donate.link=t),placeholder:"请输入外链",clearable:""},null,8,["modelValue"])])),_:1}),T(s,{label:"赞助头像"},{default:I((()=>[T(i,{modelValue:e.form.Donate.avatar,"onUpdate:modelValue":t[7]||(t[7]=t=>e.form.Donate.avatar=t),placeholder:"请输入头像",clearable:""},null,8,["modelValue"])])),_:1}),T(s,{label:"赞助金额"},{default:I((()=>[T(i,{modelValue:e.form.Donate.amount,"onUpdate:modelValue":t[8]||(t[8]=t=>e.form.Donate.amount=t),placeholder:"请输入金额",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])):_("v-if",!0)])),_:1},8,["modelValue","title","before-close"])}],["__scopeId","data-v-2b378a9e"],["__file","D:/project/pixel-grid/src/components/dialog/AddLinkOrDonateDialog.vue"]]);const $t=u({name:"ValidateSecretDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close","update"],setup(e,t){const n=j(),{proxy:o}=c(),l=O();let a=p({form:{secret:"",id:"0",desc:o.$config.secretTypeList[0].desc},loading:!1,rules:{secret:[{required:!0,trigger:"change",message:"请输入密钥"}]},dialogVisible:e.visible});const i=m((()=>e=>"xsgz"===e?new URL("/logo.png",window.location.origin).href:new URL(`/img/${e}.png`,window.location.origin).href));let d={handleSelect(e,t){a.form.id=String(t),a.form.desc=e.desc},handleClose(){a.dialogVisible=!1,t.emit("close")},handleToPrice(){d.handleClose(),o.$router.push("/price")},handleXsgzSecret(){const e=o.$bmob.Query("Key");e.equalTo("isUse","==","0"),e.equalTo("key","==",a.form.secret),e.select("objectId","key","exp","version"),e.limit(1),e.find(!1).then((e=>{if(!e.length)return a.loading=!1,o.$message.error("校验失败，密钥不存在或已被使用");d.handleUpdateKey(e[0],"Key","isUse")})).catch((e=>{a.loading=!1,o.$message.error("校验失败，请联系作者")}))},handleUpdateKey(e,t,n,i="key"){const s=o.$bmob.Query(t);s.set("id",e.objectId),s.set(n,"1"),s.set("userId",l.userData.uid),s.save().then((t=>{d.handleUpdateUser(e,i)})).catch((e=>{a.loading=!1,o.$message.error("校验失败，请联系作者")}))},handleCocoSecret(){const e=o.$bmob.Query("Key");e.equalTo("isUse","==","0"),e.equalTo("key","==",a.form.secret),e.select("objectId","key","exp","version"),e.limit(1),e.find(!1).then((e=>{if(!e.length)return a.loading=!1,o.$message.error("校验失败，密钥不存在或已被使用");d.handleUpdateKey(e[0],"Key","isUse","cocoKey")})).catch((e=>{a.loading=!1,o.$message.error("校验失败，请联系作者")}))},handleUpdateUser(e,t){let n=R((new Date).getTime()+2592e6*e.exp);"0"===a.form.id&&"key"===t&&(n="0");let i={vip:e.version,vipEndAt:n};l.updateUserInfo(o,i,(()=>{o.$message.success("校验成功"),a.loading=!1,d.handleClose()}),(()=>{o.$message.error("校验失败，请联系作者"),a.loading=!1}))},async handleConfirm(e){if(l.checkIsLogin())return d.handleClose();e&&e.validate((e=>{if(!e)return!1;a.loading=!0,"0"===a.form.id?d.handleXsgzSecret():"1"===a.form.id&&d.handleCocoSecret()}))}};return r(s(s({},h(a)),d),{ruleFormRef:n,getIcon:i})}}),Tt=(e=>(M("data-v-46e1da75"),e=e(),B(),e))((()=>D("p",null,"密钥类型",-1))),Lt={class:"page-box"},Et=["onClick"],Pt=["src"],Ut={key:0,class:"type-desc text-justify"},Mt={key:1,class:"type-desc text-justify"},Bt=A(" 像素格子会员版本分为标准版（免费），专业版以及高级版，具体详情可在 "),At=A(" 中查看 "),Ot={class:"dialog-footer"},jt=A("取 消"),Rt=A("确 定");var Ft=v($t,[["render",function(e,t,n,o,l,a){const i=x("el-input"),s=x("el-form-item"),r=x("el-form"),d=x("el-button"),c=x("el-dialog");return C(),S(c,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[3]||(t[3]=t=>e.dialogVisible=t),title:"激活密钥","before-close":e.handleClose,class:"z-dialog",center:"","close-on-click-modal":!1,width:350},{footer:I((()=>[D("span",Ot,[T(d,{onClick:e.handleClose},{default:I((()=>[jt])),_:1},8,["onClick"]),T(d,{type:"primary",onClick:t[2]||(t[2]=t=>e.handleConfirm(e.ruleFormRef)),loading:e.loading},{default:I((()=>[Rt])),_:1},8,["loading"])])])),default:I((()=>[T(r,{ref:"ruleFormRef",model:e.form,"label-position":"top",rules:e.rules},{default:I((()=>[T(s,{label:"密钥",prop:"secret"},{default:I((()=>[T(i,{modelValue:e.form.secret,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.secret=t),placeholder:"请输入密钥",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),D("div",null,[Tt,D("div",Lt,[(C(!0),V($,null,L(e.$config.secretTypeList,((t,n)=>(C(),V("div",{class:E(["page-icon flex-column-center pointer",{active:n==e.form.id}]),key:t.value,onClick:o=>e.handleSelect(t,n)},[D("img",{src:e.getIcon(t.value)},null,8,Pt),D("span",null,U(t.label),1)],10,Et)))),128))])]),"0"!==e.form.id?(C(),V("div",Ut,U(e.form.desc),1)):(C(),V("div",Mt,[Bt,D("span",{style:{color:"#0052d9"},class:"pointer",onClick:t[1]||(t[1]=(...t)=>e.handleToPrice&&e.handleToPrice(...t))},"价格页面"),At]))])),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-46e1da75"],["__file","D:/project/pixel-grid/src/components/dialog/ValidateSecretDialog.vue"]]);const Ht=u({name:"SettingsDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close"],setup(e,t){let{proxy:n}=c();const o=O();let l=p({dialogVisible:e.visible,TriggerTime:[{label:"2秒后",value:2},{label:"3秒后",value:3},{label:"4秒后",value:4},{label:"5秒后",value:5}],pindouBrandList:[]}),a={handleClose(){l.dialogVisible=!1,t.emit("close")},handleChange:(e,t,l="")=>"autoTheme"===t?n.$utils.cache.settings.set(JSON.stringify(o.settingsOption)):""===l&&o.checkVipFunction(t)?o.settingsOption[t]=!e:(""!==l?o.settingsOption[t].forEach((t=>{t.key===l&&(t.color=F(H(e)))})):o.settingsOption[t]=e,void n.$utils.cache.settings.set(JSON.stringify(o.settingsOption))),handleCommand(e){o.checkVipFunction("autoBackup")||(o.settingsOption.autoBackupTime=e,n.$utils.cache.settings.set(JSON.stringify(o.settingsOption)))},handlePindouCommand(e){o.settingsOption.defaultPindou=e,n.$utils.cache.settings.set(JSON.stringify(o.settingsOption))}};return g((()=>{let e=n.$utils.cache.pindou.get();e&&(l.pindouBrandList=JSON.parse(e))})),r(s(s({},h(l)),a),{editSpaceStore:o})}}),Nt=e=>(M("data-v-fd7a8b9c"),e=e(),B(),e),zt={class:"content scrollbar"},qt={class:"flex-between full-w"},Qt=Nt((()=>D("p",null,"宠物栏",-1))),Wt={class:"flex-between full-w"},Kt=Nt((()=>D("p",null,"智能主题",-1))),Jt={class:"flex-between full-w"},Gt=Nt((()=>D("p",null,"自动备份",-1))),Zt={class:"flex-between full-w",style:{"margin-top":"10px"}},Xt=Nt((()=>D("p",null,"自动备份时间",-1))),Yt={class:"el-dropdown-link"},en={class:"flex-between full-w"},tn=Nt((()=>D("p",null,"默认拼豆品牌",-1))),nn={class:"el-dropdown-link"},on=Nt((()=>D("div",{class:"flex-between full-w"},[D("p",null,"快捷键颜色配置")],-1))),ln={class:"keyOption-box full-w"},an={class:"option-slider-title"};const sn=u({name:"HomeHeader",components:{DonateDialog:xt,AddLinkOrDonateDialog:Vt,SettingsDialog:v(Ht,[["render",function(e,t,n,o,l,a){const i=x("el-switch"),s=x("el-divider"),r=x("ArrowDown"),d=x("el-icon"),c=x("el-dropdown-item"),u=x("el-dropdown-menu"),p=x("el-dropdown"),m=x("el-color-picker"),g=x("el-dialog");return C(),S(g,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=t=>e.dialogVisible=t),title:"设 置",width:400,"before-close":e.handleClose,class:"z-dialog",center:""},{default:I((()=>[D("div",zt,[D("div",qt,[Qt,T(i,{modelValue:e.editSpaceStore.PetVisible,"onUpdate:modelValue":t[0]||(t[0]=t=>e.editSpaceStore.PetVisible=t)},null,8,["modelValue"])]),D("div",Wt,[Kt,T(i,{modelValue:e.editSpaceStore.settingsOption.autoTheme,"onUpdate:modelValue":t[1]||(t[1]=t=>e.editSpaceStore.settingsOption.autoTheme=t),onChange:t[2]||(t[2]=t=>e.handleChange(t,"autoTheme"))},null,8,["modelValue"])]),T(s,{"border-style":"dashed"}),D("div",Jt,[Gt,T(i,{modelValue:e.editSpaceStore.settingsOption.autoBackup,"onUpdate:modelValue":t[3]||(t[3]=t=>e.editSpaceStore.settingsOption.autoBackup=t),onChange:t[4]||(t[4]=t=>e.handleChange(t,"autoBackup"))},null,8,["modelValue"])]),_(' <el-divider border-style="dashed" /> '),D("div",Zt,[Xt,T(p,{onCommand:e.handleCommand,disabled:!e.editSpaceStore.settingsOption.autoBackup},{dropdown:I((()=>[T(u,null,{default:I((()=>[(C(!0),V($,null,L(e.TriggerTime,(e=>(C(),S(c,{key:e.value,command:e.value},{default:I((()=>[A(U(e.label),1)])),_:2},1032,["command"])))),128))])),_:1})])),default:I((()=>{var t;return[D("span",Yt,[A(U(null==(t=e.TriggerTime.find((t=>t.value==e.editSpaceStore.settingsOption.autoBackupTime)))?void 0:t.label)+" ",1),T(d,null,{default:I((()=>[T(r)])),_:1})])]})),_:1},8,["onCommand","disabled"])]),T(s,{"border-style":"dashed"}),D("div",en,[tn,T(p,{onCommand:e.handlePindouCommand,"max-height":200},{dropdown:I((()=>[T(u,null,{default:I((()=>[(C(!0),V($,null,L(e.pindouBrandList,(e=>(C(),S(c,{key:e.value,command:e.value},{default:I((()=>[A(U(e.label),1)])),_:2},1032,["command"])))),128))])),_:1})])),default:I((()=>{var t;return[D("span",nn,[A(U(null==(t=e.pindouBrandList.find((t=>t.value==e.editSpaceStore.settingsOption.defaultPindou)))?void 0:t.label)+" ",1),T(d,null,{default:I((()=>[T(r)])),_:1})])]})),_:1},8,["onCommand"])]),T(s,{"border-style":"dashed"}),on,D("div",ln,[(C(!0),V($,null,L(e.editSpaceStore.settingsOption.colorKeyOptions,(t=>(C(),V("div",{key:t.key,class:"flex-between keyOption-item"},[D("p",an,"快捷键["+U(t.key)+"]",1),T(m,{modelValue:t.color,"onUpdate:modelValue":e=>t.color=e,"show-alpha":"",disabled:e.editSpaceStore.checkVipFunction("colorKeyOptions",0,!1),onChange:n=>e.handleChange(n,"colorKeyOptions",t.key)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])))),128))])])])),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-fd7a8b9c"],["__file","D:/project/pixel-grid/src/components/dialog/SettingsDialog.vue"]]),ValidateSecretDialog:Ft},props:{},emits:["changeLanguage","changeTheme"],setup(e,t){const{proxy:n}=c(),{locale:o}=N(),l=O();let a=p({donateVisible:!1,avatarUrl:"",addVisible:!1,addType:"",addTitle:"",isShowMessage:!1,validateVisible:!1}),i={getUserAvatar:m((()=>l.userData.avatar&&""!==l.userData.avatar?l.userData.avatar.startsWith("http")?l.userData.avatar:`${n.$config.HUAWEI_OBS_CONFIG.HOST}${l.userData.avatar}`:"0"==l.userData.sex?Pe:Ue)),requireLogo:m((()=>q()?new URL(`/${q()}/logo.png`,window.location.origin).href:new URL("/logo.png",self.location).href)),getUserVip:m((()=>{var e;return l.userData&&(null==(e=l.userData)?void 0:e.vip)&&""!==l.userData.vip&&l.versionInfoData?l.versionInfoData[Number(l.userData.vip)]:{label:"标准版",type:"success"}})),getUserVipEndAt:m((()=>{var e;return l.userData&&(null==(e=l.userData)?void 0:e.vipEndAt)&&"0"!==l.userData.vipEndAt?`版本有效期：${l.userData.vipEndAt.split(" ")[0]}`:"版本有效期：永久"}))},u={handleCommand(e){o.value=e,n.$utils.cache.lang.set(e),l.lang=e,t.emit("changeLanguage")},changeTheme(){t.emit("changeTheme")},handleDownloadClient(){if("null"===l.clientDownloadLink)return n.$message.info("暂无下载链接");window.open(l.clientDownloadLink,"_blank")},handleAdd(e,t){a.addVisible=!0,a.addType=e,a.addTitle=t},handleUpdateUser(e,t,o){let a=R((new Date).getTime()+2592e6*e.exp);const i=n.$bmob.Query("User");i.set("id",l.userData.objectId),i.set("vipEndAt",a),i.set("vip",e.version),i.save().then((i=>{n.$message.success("校验成功"),l.userData.vip=e.version,l.userData.vipEndAt=a,l.saveUserInfo(l.userData),t.confirmButtonLoading=!1,t.confirmButtonText="确 认",o()})).catch((e=>{t.confirmButtonText="确 认",n.$message.error("校验失败，请联系作者"),t.confirmButtonLoading=!1,o()}))},handleUpdateKey(e,t,o){const a=n.$bmob.Query("Key");a.set("id",e.objectId),a.set("isUse","1"),a.set("userId",l.userData.uid),a.save().then((n=>{u.handleUpdateUser(e,t,o)})).catch((e=>{t.confirmButtonText="确 认",t.confirmButtonLoading=!1,n.$message.error("校验失败，请重试")}))},handleVerifyKey(){l.checkIsLogin()||Q.prompt("请输入密钥","校验密钥",{confirmButtonText:"确 认",cancelButtonText:"取 消",showCancelButton:!1,inputErrorMessage:"验证失败，请重试",beforeClose:(e,t,o)=>{if("confirm"===e){if(""===t.inputValue||!t.inputValue)return n.$message.warning("请输入密钥");t.confirmButtonLoading=!0,t.confirmButtonText="正在校验...";const e=n.$bmob.Query("Key");e.equalTo("isUse","==","0"),e.equalTo("key","==",t.inputValue),e.select("objectId","key","exp","version"),e.limit(1),e.find(!1).then((e=>{if(!e.length)return t.confirmButtonLoading=!1,t.confirmButtonText="确 认",n.$message.error("校验失败，密钥不存在或已被使用");u.handleUpdateKey(e[0],t,o)})).catch((e=>{n.$message.error("校验失败，请联系作者"),t.confirmButtonText="确 认",t.confirmButtonLoading=!1}))}else o()}}).then((async({value:e})=>{})).catch((e=>{}))},getMessage(){if(l.isLogin&&l.userData){const e=n.$bmob.Query("Message");e.equalTo("isRead","==","0");const t=e.equalTo("userId","==",l.userData.uid),o=e.equalTo("userId","==","0");e.or(t,o),e.limit(1),e.find(!1).then((e=>{e.length?a.isShowMessage=!0:a.isShowMessage=!1})).catch((e=>{a.isShowMessage=!1}))}},handleOpenMessage(){a.isShowMessage=!1,n.$router.push({name:"message"})}};return g((()=>{u.getMessage()})),r(s(r(s(s(s({},h(a)),u),function(){const{proxy:e}=c();return{ScreenFull:()=>{if(!et.isEnabled)return d.warning(e.$t("message.fullscreenError")),!1;et.toggle()}}}()),{checkIsClientEnv:f,checkIsDevelopEnv:z,checkDate:q}),i),{editSpaceStore:l})}}),rn={class:"full-w home-header"},dn={class:"flex-start",style:{gap:"10px"}},cn={class:"image-slot"},un=["src"],pn={class:"isShowWebTitle"},mn={class:"flex-end",style:{gap:"20px"}},gn=["innerHTML"],fn=["innerHTML"],hn=["innerHTML"],vn=["innerHTML"],bn=["innerHTML"],yn=["innerHTML"],kn=["innerHTML"],wn=["innerHTML"],xn=["innerHTML"],Cn=A(" 登录 ");var Sn=v(sn,[["render",function(e,t,n,o,l,a){const i=x("el-image"),s=x("el-tag"),r=x("el-tooltip"),d=x("el-badge"),c=x("User"),u=x("el-icon"),p=x("el-avatar"),m=x("DonateDialog"),g=x("AddLinkOrDonateDialog"),f=x("SettingsDialog"),h=x("ValidateSecretDialog");return C(),V($,null,[D("div",rn,[D("div",dn,[_(' <img :src="requireLogo" style="margin-top:1px" class="pointer" @click="$router.push(\'/about\')"> '),T(i,{src:e.requireLogo,fit:"contain",class:"pointer",onClick:t[0]||(t[0]=t=>e.$router.push("/about"))},{error:I((()=>[D("div",cn,[D("img",{src:Be},null,8,un)])])),_:1},8,["src"]),D("h1",pn,U(e.$t("message.webTitle")),1),T(r,{content:e.getUserVipEndAt,placement:"bottom"},{default:I((()=>[T(s,{type:e.getUserVip.type,effect:"dark",class:"pointer isShowWebVersion",style:{"margin-top":"2px"}},{default:I((()=>[A(U(e.getUserVip.label),1)])),_:1},8,["type"])])),_:1},8,["content"])]),D("div",mn,[T(r,{content:"添加链接",placement:"bottom"},{default:I((()=>[_(" <el-icon v-if=\"checkIsDevelopEnv()\" @click=\"handleAdd('Link', '添加链接')\"><Link /></el-icon> "),e.checkIsDevelopEnv()?(C(),V("i",{key:0,innerHTML:e.$iconSvg.link,class:"el-icon",style:{"font-size":"20px"},onClick:t[1]||(t[1]=t=>e.handleAdd("Link","添加链接"))},null,8,gn)):_("v-if",!0)])),_:1}),T(r,{content:"添加赞助",placement:"bottom"},{default:I((()=>[_(" <el-icon v-if=\"checkIsDevelopEnv()\" @click=\"handleAdd('Donate', '添加赞助')\"><Coin /></el-icon> "),e.checkIsDevelopEnv()?(C(),V("i",{key:0,innerHTML:e.$iconSvg.donate,class:"el-icon",style:{"font-size":"20px"},onClick:t[2]||(t[2]=t=>e.handleAdd("Donate","添加赞助"))},null,8,fn)):_("v-if",!0)])),_:1}),T(r,{content:"我的消息",placement:"bottom"},{default:I((()=>[e.editSpaceStore.isLogin?(C(),S(d,{key:0,"is-dot":"",hidden:!e.isShowMessage,style:{height:"20px"}},{default:I((()=>[_(' <el-icon  @click="handleOpenMessage"><MessageBox /></el-icon> '),_(' <el-icon @click="handleOpenMessage"><Bell /></el-icon> '),D("i",{innerHTML:e.$iconSvg.message,class:"el-icon",style:{"font-size":"20px"},onClick:t[3]||(t[3]=(...t)=>e.handleOpenMessage&&e.handleOpenMessage(...t))},null,8,hn)])),_:1},8,["hidden"])):_("v-if",!0)])),_:1}),T(r,{content:"校验密钥",placement:"bottom"},{default:I((()=>[_(' <el-icon @click="validateVisible=true"><Key /></el-icon> '),D("i",{innerHTML:e.$iconSvg.key,class:"el-icon",style:{"font-size":"20px"},onClick:t[4]||(t[4]=t=>e.editSpaceStore.validateVisible=!0)},null,8,vn)])),_:1}),_(' <el-tooltip\r\n            content="客户端下载"\r\n            placement="bottom">\r\n                <el-icon style="margin-right: 20px;" v-if="!checkIsClientEnv()" @click="handleDownloadClient"><Monitor /></el-icon>\r\n            </el-tooltip> '),T(r,{content:"设 置",placement:"bottom"},{default:I((()=>[_(' <el-icon @click="editSpaceStore.settingVisible=true"><Setting /></el-icon> '),D("i",{innerHTML:e.$iconSvg.settings,class:"el-icon",style:{"font-size":"20px"},onClick:t[5]||(t[5]=t=>e.editSpaceStore.settingVisible=!0)},null,8,bn)])),_:1}),T(r,{content:e.editSpaceStore.themeValue?"深色模式":"浅色模式",placement:"bottom"},{default:I((()=>[_(' <el-icon @click="changeTheme" v-if="editSpaceStore.themeValue"><Moon /></el-icon> '),_(' <el-icon @click="changeTheme" v-else><Sunny /></el-icon> '),e.editSpaceStore.themeValue?(C(),V("i",{key:0,innerHTML:e.$iconSvg.moon,class:"el-icon",style:{"font-size":"20px"},onClick:t[6]||(t[6]=(...t)=>e.changeTheme&&e.changeTheme(...t))},null,8,yn)):(C(),V("i",{key:1,innerHTML:e.$iconSvg.sun,class:"el-icon",style:{"font-size":"20px"},onClick:t[7]||(t[7]=(...t)=>e.changeTheme&&e.changeTheme(...t))},null,8,kn))])),_:1},8,["content"]),T(r,{effect:"dark",content:e.$t("message.donate"),placement:"bottom"},{default:I((()=>[_(' <el-icon @click="editSpaceStore.donateVisible=true"><ShoppingCart /></el-icon> '),D("i",{innerHTML:e.$iconSvg.cart,class:"el-icon",style:{"font-size":"20px"},onClick:t[8]||(t[8]=t=>e.editSpaceStore.donateVisible=!0)},null,8,wn)])),_:1},8,["content"]),T(r,{effect:"dark",content:e.$t("message.fullscreen"),placement:"bottom"},{default:I((()=>[_(' <el-icon  @click="ScreenFull"><FullScreen /></el-icon> '),D("i",{innerHTML:e.$iconSvg.fullscreen,class:"el-icon",style:{"font-size":"20px"},onClick:t[9]||(t[9]=(...t)=>e.ScreenFull&&e.ScreenFull(...t))},null,8,xn)])),_:1},8,["content"]),_(' <el-dropdown trigger="click" @command="handleCommand">\r\n                <span class="el-dropdown-link flex-center flex-nowarp">\r\n                    {{ $t(\'message.language\')}}\r\n                    <el-icon class="el-icon--right"><arrow-down /></el-icon>\r\n                </span>\r\n                <template #dropdown>\r\n                <el-dropdown-menu>\r\n                    <el-dropdown-item command="en">{{ $t(\'message.en\') }}</el-dropdown-item>\r\n                    <el-dropdown-item command="zh">{{ $t(\'message.zh\') }}</el-dropdown-item>\r\n                </el-dropdown-menu>\r\n                </template>\r\n            </el-dropdown> '),e.editSpaceStore.isLogin?(C(),S(p,{key:0,size:30,src:e.getUserAvatar,class:"pointer box-shadow",style:{"min-width":"30px"},onClick:t[10]||(t[10]=t=>e.$router.push({name:"user",params:{username:e.editSpaceStore.userData.username}}))},{default:I((()=>[T(u,null,{default:I((()=>[T(c)])),_:1})])),_:1},8,["src"])):(C(),S(p,{key:1,size:34,class:"pointer",style:{"font-size":"12px","min-width":"34px"},onClick:t[11]||(t[11]=t=>e.$router.push("/login"))},{default:I((()=>[Cn])),_:1}))])]),(C(),S(W,{to:"body"},[e.editSpaceStore.donateVisible?(C(),S(m,{key:0,visible:e.editSpaceStore.donateVisible,onClose:t[12]||(t[12]=t=>e.editSpaceStore.donateVisible=!1)},null,8,["visible"])):_("v-if",!0),e.addVisible?(C(),S(g,{key:1,visible:e.addVisible,type:e.addType,title:e.addTitle,onClose:t[13]||(t[13]=t=>e.addVisible=!1)},null,8,["visible","type","title"])):_("v-if",!0),e.editSpaceStore.settingVisible?(C(),S(f,{key:2,visible:e.editSpaceStore.settingVisible,onClose:t[14]||(t[14]=t=>e.editSpaceStore.settingVisible=!1)},null,8,["visible"])):_("v-if",!0),e.editSpaceStore.validateVisible?(C(),S(h,{key:3,visible:e.editSpaceStore.validateVisible,onClose:t[15]||(t[15]=t=>e.editSpaceStore.validateVisible=!1)},null,8,["visible"])):_("v-if",!0)]))],64)}],["__scopeId","data-v-58b91708"],["__file","D:/project/pixel-grid/src/components/HomeHeader.vue"]]);var In=v({},[["render",function(e,t){return C(),V($,null,L(50,(e=>D("div",{key:e,class:"snowflake"}))),64)}],["__scopeId","data-v-49d90122"],["__file","D:/project/pixel-grid/src/components/others/Snow.vue"]]);const Dn={},_n={class:"deng-box1"},Vn=[K('<div class="deng" data-v-7b166e6a><div class="xian" data-v-7b166e6a></div><div class="deng-a" data-v-7b166e6a><div class="deng-b" data-v-7b166e6a><div class="deng-t" data-v-7b166e6a>春</div></div></div><div class="shui shui-a" data-v-7b166e6a><div class="shui-c" data-v-7b166e6a></div><div class="shui-b" data-v-7b166e6a></div></div></div>',1)];var $n=v(Dn,[["render",function(e,t){return C(),V("div",_n,Vn)}],["__scopeId","data-v-7b166e6a"],["__file","D:/project/pixel-grid/src/components/others/Redbao.vue"]]);const Tn=u({name:"HomeSideNav",components:{},props:{},setup(e,t){const n=J(),o=O();let l=p({isCollapse:!1,menuList:[]}),a={handleChangeSize(){if(window.innerWidth<1100){if(l.isCollapse)return;l.isCollapse=!0}else{if(!l.isCollapse)return;l.isCollapse=!1}}},i=n.options.routes[1].children.map(((e,t)=>{let n=null;return t<6&&(n={path:`/${e.path}`,title:e.meta.title,icon:e.meta.icon}),n}));l.menuList=i.filter((e=>null!==e));const d=((e,t)=>{let n;return function(){n&&clearTimeout(n),n=setTimeout((()=>{e()}),t)}})(a.handleChangeSize,500);return g((()=>{window.addEventListener("resize",d),a.handleChangeSize()})),G((()=>{window.removeEventListener("resize",d)})),r(s(s({},h(l)),a),{checkDate:q,editSpaceStore:o})}}),Ln=["innerHTML"],En=["innerHTML"],Pn={style:{"margin-left":"10px"}},Un={class:"static-santa-claus"},Mn={key:0,class:"move-santa-claus"};var Bn=v(Tn,[["render",function(e,t,n,o,l,a){const i=x("el-menu-item"),s=x("DArrowRight"),r=x("el-icon"),d=x("DArrowLeft"),c=x("lottie-player"),u=x("el-menu");return C(),V($,null,[T(u,{"default-active":e.$route.path,router:"",collapse:e.isCollapse,class:"scrollbar scrollY",style:{"min-width":"60px",position:"relative"}},{default:I((()=>[(C(!0),V($,null,L(e.menuList,(t=>(C(),S(i,{key:t.path,index:t.path,class:E({active:t.path===e.$route.path,active1:e.$route.path.includes("/draw")&&"/project"===t.path}),style:{"justify-content":"center"}},{title:I((()=>[D("p",Pn,U(e.$t(`message.${t.title}`)),1)])),default:I((()=>[e.checkDate()?(C(),V("i",{key:1,innerHTML:e.$iconSvg[`${e.checkDate()}-${t.icon}`],style:{width:"20px",height:"20px","font-size":"20px"},class:"el-icon"},null,8,En)):(C(),V("i",{key:0,innerHTML:e.$iconSvg[`${t.title}`],style:{width:"20px",height:"20px","font-size":"20px"},class:"el-icon"},null,8,Ln))])),_:2},1032,["index","class"])))),128)),_(' <el-tooltip\r\n            effect="dark"\r\n            content="回收站"\r\n            placement="top">\r\n                <div class="collapseIcon recycleIcon flex-center" @click="$router.push(\'/recycle\')" v-if="editSpaceStore.isLogin">\r\n                    <el-icon><Delete /></el-icon>\r\n                </div>\r\n        </el-tooltip> '),D("div",{class:"collapseIcon flex-center",onClick:t[0]||(t[0]=t=>e.isCollapse=!e.isCollapse)},[e.isCollapse?(C(),S(r,{key:0},{default:I((()=>[T(s)])),_:1})):(C(),S(r,{key:1},{default:I((()=>[T(d)])),_:1}))]),Z(D("div",Un,[T(c,{src:"/lottie/圣诞老人2.json",background:"transparent",speed:"1",style:{width:"100px",height:"100px"},loop:"",autoplay:""})],512),[[X,!e.isCollapse&&e.checkDate().includes("christmas")]])])),_:1},8,["default-active","collapse"]),(C(),S(W,{to:"body"},[e.checkDate().includes("christmas")?(C(),V("div",Mn,[T(c,{src:"/lottie/圣诞老人1.json",background:"transparent",speed:"1",style:{width:"150px",height:"150px"},loop:"",autoplay:""})])):_("v-if",!0)]))],64)}],["__scopeId","data-v-229739ed"],["__file","D:/project/pixel-grid/src/components/HomeSideNav.vue"]]);var An=v(u({name:"HomeRouter",components:{},emits:[],props:{},setup(e,t){let n=O(),o=p({cacheRouter:["about","work","project","pindou","module","price","draw","customPindou"]});return r(s(s({},h(o)),{}),{editSpaceStore:n})}}),[["render",function(e,t,n,o,l,a){const i=x("router-view"),s=x("el-main");return C(),S(s,{class:E(["routerview-right scrollbar",{relative:!e.editSpaceStore.isFullWork}])},{default:I((()=>[_(' <el-backtop :right="40" :bottom="40" target=".routerview-right .scrollbar"/> '),T(i,null,{default:I((({Component:t})=>[(C(),S(Y,{include:e.cacheRouter},[(C(),S(ee(t)))],1032,["include"]))])),_:1})])),_:1},8,["class"])}],["__scopeId","data-v-d5ad2990"],["__file","D:/project/pixel-grid/src/components/HomeRouter.vue"]]);const On=u({name:"Loading",components:{},emits:[],props:{},setup(e,t){let n=O(),o=p({color:["primary","success","danger","warning"],randomStatus:0}),l={handleChange(){o.randomStatus=Math.floor(Math.random()*o.color.length)}};return g((()=>{o.randomStatus=Math.floor(Math.random()*o.color.length),document.body.addEventListener("click",l.handleChange)})),G((()=>{document.body.removeEventListener("click",l.handleChange)})),r(s(s({},h(o)),l),{editSpaceStore:n,isSupportPaintWorklet:te})}}),jn={key:0,class:"loader"},Rn={key:1,class:"flex-column-center full-h",style:{gap:"10px",width:"300px"}},Fn=(e=>(M("data-v-efe9d588"),e=e(),B(),e))((()=>D("p",{style:{color:"#808080"}},"正在加载ing...",-1)));var Hn=v(On,[["render",function(e,t,n,o,l,a){const i=x("px-progress");return e.isSupportPaintWorklet()?(C(),V("div",Rn,[T(i,{class:"full-w",percentage:100,"stroke-width":24,showText:!1,striped:"","striped-flow":"",duration:6,status:e.color[e.randomStatus]},null,8,["status"]),Fn])):(C(),V("div",jn))}],["__scopeId","data-v-efe9d588"],["__file","D:/project/pixel-grid/src/components/Loading.vue"]]),Nn={name:"zh-cn",el:{breadcrumb:{label:"面包屑"},colorpicker:{confirm:"确定",clear:"清空",defaultLabel:"颜色选择器",description:"当前颜色 {color}，按 Enter 键选择新颜色",alphaLabel:"选择透明度的值"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",dateTablePrompt:"使用方向键与 Enter 键可选择日期",monthTablePrompt:"使用方向键与 Enter 键可选择月份",yearTablePrompt:"使用方向键与 Enter 键可选择年份",selectedDate:"已选日期",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},weeksFull:{sun:"星期日",mon:"星期一",tue:"星期二",wed:"星期三",thu:"星期四",fri:"星期五",sat:"星期六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},inputNumber:{decrease:"减少数值",increase:"增加数值"},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},dropdown:{toggleDropdown:"切换下拉选项"},mention:{loading:"加载中"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},dialog:{close:"关闭此对话框"},drawer:{close:"关闭此对话框"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!",close:"关闭此对话框"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},slider:{defaultLabel:"滑块介于 {min} 至 {max}",defaultRangeStartLabel:"选择起始值",defaultRangeEndLabel:"选择结束值"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tour:{next:"下一步",previous:"上一步",finish:"结束导览"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"},carousel:{leftArrow:"上一张幻灯片",rightArrow:"下一张幻灯片",indicator:"幻灯片切换至索引 {index}"}}};
/*! Element Plus v2.8.4 */const zn={name:"LoginDialog",props:{visible:{type:Boolean,default:!1}},components:{ForgetPasswordDialog:Oe},emits:["close"],setup(e,t){const n=O(),{proxy:o}=c(),l=je();let a=p({loginInfo:{username:"",password:""},logonInfo:{username:"",password:"",sex:"0",nickname:""},isLogon:!1,isloading:!1,isRemeber:!1,forgetPasswordVisible:!1}),i={async handleQQLogin(){try{if(o.$utils.cache.qqInfo.get())return;const e=re(location.href);if(!e.access_token)return;const t=await l.getOpenId(e.access_token);if(!t.data.content||!t.data)return;let a=t.data.content,s={accessToken:a.accessToken,openId:a.openId};o.$utils.cache.qqInfo.set(JSON.stringify(s));const r=a.userData;let d="QQ"+s.openId;s.password=o.$utils.secret.MD5(d);const c=o.$bmob.Query("User");c.equalTo("username","==",s.openId),c.equalTo("password","==",s.password),c.limit(1),c.select(...o.$config.UserField),c.find(!1).then((async e=>{if(e.length){if("0"===e[0].isEnable)return void o.$message.warning("账号异常，无法登陆");i.handleClose();let t=e[0];t.browserId||(t.browserId="0"),t.vip||(t.vip="0"),t.vipEndAt||(t.vipEndAt="0"),t.backupCount||(t.backupCount="0"),t.extraBackupCount||(t.extraBackupCount="0"),n.saveUserInfo(t),o.$message.success("登陆成功")}else i.handleQQLogon(s,r)})).catch((e=>{o.$message.error("登录失败")}))}catch(e){n.saveErrorToBmob("QQ登录",e)}},async handleQQLogon(e,t){a.logonInfo.username=e.openId,a.logonInfo.password=e.password,a.logonInfo.avatar=t.figureurl_2,a.logonInfo.nickname=t.nickname,a.logonInfo.sex="2"==t.gender_type?"0":"1";let l=Object.keys(a.logonInfo);const s=o.$bmob.Query("User");for(let n=0;n<l.length;n++){let e=l[n];s.set(e,a.logonInfo[e])}s.set("isGoogle","0"),s.set("platform","2"),s.set("vip","0"),s.set("vipEndAt","0"),s.set("browserId",n.browserId),s.set("backupCount","0"),s.set("avatarUpdatedAt",""),s.set("nameUpdatedAt",""),s.set("uid",y.v4()),s.set("isEnable","1");const r=o.$bmob.Query("User"),d=await r.count();s.set("rank",d.count+1),s.save().then((async e=>{a.logonInfo.objectId=e.objectId;try{a.logonInfo=await n.getRemoteUserInfo(o,e.objectId),i.handleClose(),n.saveUserInfo(a.logonInfo),o.$message.success("登录成功")}catch(t){delete a.logonInfo.password,i.handleClose(),n.saveUserInfo(a.logonInfo)}})).catch((e=>{o.$message.error("登录失败")}))},async handleqqLogin(){try{Fe.Login.showPopup({appId:o.$config.QQ_APP_ID,redirectURI:"https://pg.zwpyyds.com/about"})}catch(e){}},handleGoogleLogin(e){const t=de(e.credential);a.isloading=!0;let l=t.sub,s="Google"+t.sub;const r=o.$bmob.Query("User");r.equalTo("username","==",l),r.equalTo("password","==",o.$utils.secret.MD5(s)),r.limit(1),r.select(...o.$config.UserField),r.find(!1).then((async e=>{if(e.length){if("0"===e[0].isEnable)return void o.$message.warning("账号异常，无法登陆");i.handleClose(),a.isloading=!1;let t=e[0];t.browserId||(t.browserId="0"),t.vip||(t.vip="0"),t.vipEndAt||(t.vipEndAt="0"),t.backupCount||(t.backupCount="0"),t.extraBackupCount||(t.extraBackupCount="0"),n.saveUserInfo(t),o.$message.success("登陆成功")}else{a.logonInfo.username=l,a.logonInfo.password=s,a.logonInfo.avatar=t.picture,a.logonInfo.nickname=t.family_name+t.given_name;let e=Object.keys(a.logonInfo);for(let t=0;t<e.length;t++){let n=e[t];if("password"===n){let e=o.$utils.secret.MD5(a.logonInfo[n]);r.set(n,e)}else r.set(n,a.logonInfo[n])}r.set("isGoogle","1"),r.set("platform","1"),r.set("vip","0"),r.set("vipEndAt","0"),r.set("browserId",n.browserId),r.set("backupCount","0"),r.set("avatarUpdatedAt",""),r.set("nameUpdatedAt",""),r.set("uid",y.v4()),r.set("isEnable","1");const d=o.$bmob.Query("User"),c=await d.count();r.set("rank",c.count+1),r.save().then((async e=>{a.logonInfo.objectId=e.objectId;try{a.logonInfo=await n.getRemoteUserInfo(o,e.objectId),i.handleClose(),a.isloading=!1,n.saveUserInfo(a.logonInfo),o.$message.success("登录成功")}catch(t){delete a.logonInfo.password,i.handleClose(),n.saveUserInfo(a.logonInfo),a.isloading=!1}})).catch((e=>{a.isloading=!1,o.$message.error("登录失败")}))}})).catch((e=>{a.isloading=!1,o.$message.error("登录失败")}))},handleChangeRemeber(e){a.isRemeber=e.target.checked},handleGo(){i.handleClose(),o.$router.push("/project")},handleClose(){t.emit("close"),setTimeout((()=>{a.isLogon=!1}),1e3)},handleCheck(e){let t=!1;for(let n in e)if(""===e[n]){t=!0;break}return t},handleRemeber(){if(a.isRemeber){let e=s({},a.loginInfo);e.password=o.$utils.secret.Encrypt(e.password),o.$utils.cache.user.set(JSON.stringify(e))}else o.$utils.cache.user.remove()},handleLogin(){if(i.handleCheck(a.loginInfo))return o.$message.warning("请填写完整信息");a.isloading=!0;const e=o.$bmob.Query("User");e.equalTo("username","==",a.loginInfo.username),e.equalTo("password","==",o.$utils.secret.MD5(a.loginInfo.password)),e.limit(1),e.select(...o.$config.UserField),e.find(!1).then((e=>{if(a.isloading=!1,e.length){if("0"===e[0].isEnable)return void o.$message.warning("账号异常，无法登陆");i.handleRemeber(),i.handleClose();let t=e[0];return t.browserId||(t.browserId="0"),t.vip||(t.vip="0"),t.vipEndAt||(t.vipEndAt="0"),t.backupCount||(t.backupCount="0"),t.extraBackupCount||(t.extraBackupCount="0"),n.saveUserInfo(t),n.getProjectList(),void o.$message.success("登陆成功")}o.$message.warning("用户名或密码错误")})).catch((e=>{a.isloading=!1,o.$message.error("登录失败")}))},async handleLogon(){try{const e=Me.validateEmpty(a.logonInfo),t=Me.validateUserName(a.logonInfo.username),l=Me.validateNickname(a.logonInfo.nickname),i=Me.validatePwd(a.logonInfo.password);await Promise.all([e,t,i,l]).catch((e=>{throw o.$message.warning(e.message),new Error(e.message)})),a.isloading=!0;const s=o.$bmob.Query("User");s.equalTo("username","==",a.logonInfo.username),s.limit(1),s.select("username","browserId"),s.find().then((async e=>{if(e.results.length)return a.isloading=!1,o.$message.warning("用户名已存在");let t=Object.keys(a.logonInfo);for(let n=0;n<t.length;n++){let e=t[n];if("password"===e){let t=o.$utils.secret.MD5(a.logonInfo[e]);s.set(e,t)}else s.set(e,a.logonInfo[e])}s.set("isGoogle","0"),s.set("platform","0"),s.set("vip","0"),s.set("vipEndAt","0"),s.set("browserId",n.browserId),s.set("backupCount","0"),s.set("avatar",""),s.set("avatarUpdatedAt",""),s.set("nameUpdatedAt",""),s.set("uid",y.v4()),s.set("isEnable","1");const l=o.$bmob.Query("User"),i=await l.count();s.set("rank",i.count+1),s.save().then((async e=>{a.logonInfo.objectId=e.objectId;try{a.logonInfo=await n.getRemoteUserInfo(o,e.objectId),n.saveUserInfo(a.logonInfo),o.$message.success("注册成功"),a.isloading=!1}catch(t){delete a.logonInfo.password,a.logonInfo.avatar="",n.saveUserInfo(a.logonInfo),a.isloading=!1}})).catch((e=>{a.isloading=!1,o.$message.error("注册失败"),n.saveErrorToBmob("注册",e)}))})).catch((e=>{o.$message.error("注册失败"),n.saveErrorToBmob("注册",e)}))}catch(e){}finally{a.isloading=!1}}};return g((()=>{i.handleQQLogin()})),ne((()=>{if(a.isLogon)for(let e in a.logonInfo)a.logonInfo[e]="","sex"===e&&(a.logonInfo[e]="0")})),oe((()=>n.loginVisible),((e,t)=>{if(e){let e=o.$utils.cache.user.get();if(e){a.isRemeber=!0;let t=JSON.parse(e);t.password=o.$utils.secret.Decrypt(t.password),a.loginInfo=t}}})),r(s(s({},h(a)),i),{editSpaceStore:n,checkIsPGComEnv:le,checkIsClientEnv:f})}},qn=e=>(M("data-v-4d26acba"),e=e(),B(),e),Qn={class:"login-dialog gs-filter"},Wn={class:"flex-between login-dialog-header"},Kn={key:0,class:"login-body flex-column-center"},Jn={class:"input-search"},Gn={class:"input-search"},Zn={class:"flex-between full-w",style:{padding:"0 10px","font-size":"14px"}},Xn={class:"flex"},Yn={class:"checkbox-container"},eo=["checked"],to=qn((()=>D("span",{class:"checkmark"},null,-1))),no=A(" 记住我 "),oo={class:"flex-center"},lo=A("忘记密码"),ao=A("登 录"),io={class:"flex",style:{gap:"10px","font-size":"14px"}},so=A("没有账号？ "),ro=A("去注册"),co=["src"],uo=A(" 用QQ账号登录 "),po={key:1,class:"login-body logon-body flex-column-center"},mo={class:"input-search"},go={class:"input-search"},fo={class:"input-search"},ho={class:"sex-select flex-between"},vo=["src"],bo=["src"],yo=A("注 册"),ko={class:"flex",style:{gap:"10px","font-size":"14px"}},wo=A("已有账号？ "),xo=A("去登录"),Co={class:"flex-between login-dialog-header"},So=qn((()=>D("p",null,"欢 迎",-1))),Io={key:0,class:"welcome-body flex-column-center text-center"},Do={key:1,class:"welcome-body flex-column-center text-center"},_o=A("去创作");var Vo=v(zn,[["render",function(e,t,n,o,l,a){const i=x("CloseBold"),s=x("el-icon"),r=x("User"),d=x("Lock"),c=x("el-link"),u=x("el-button"),p=x("GoogleLogin"),m=x("EditPen"),g=x("ForgetPasswordDialog");return C(),S(se,{name:"xpDialog",persisted:""},{default:I((()=>[Z(D("div",Qn,[o.editSpaceStore.isLogin?o.editSpaceStore.isLogin&&e.isLogon?(C(),V($,{key:1},[D("div",Co,[So,T(s,{onClick:ae(e.handleClose,["stop"])},{default:I((()=>[T(i)])),_:1},8,["onClick"])]),o.editSpaceStore.userData.rank&&o.editSpaceStore.userData.rank>0?(C(),V("div",Io," 欢迎加入像素格子，您将成为像素格子的第"+U(o.editSpaceStore.userData.rank)+"位用户，快去创作属于自己的像素艺术吧！ ",1)):(C(),V("div",Do," 欢迎加入像素格子，快去创作属于自己的像素艺术吧！ ")),T(u,{type:"primary",round:"",class:"full-w",onClick:e.handleGo},{default:I((()=>[_o])),_:1},8,["onClick"])],64)):_("v-if",!0):(C(),V($,{key:0},[D("div",Wn,[D("p",null,U(e.isLogon?"注 册":"登 录"),1),T(s,{onClick:ae(e.handleClose,["stop"])},{default:I((()=>[T(i)])),_:1},8,["onClick"])]),e.isLogon?(C(),V("div",po,[D("div",mo,[T(s,null,{default:I((()=>[T(r)])),_:1}),Z(D("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=t=>e.logonInfo.username=t),placeholder:"请输入用户名"},null,512),[[ie,e.logonInfo.username]])]),D("div",go,[T(s,null,{default:I((()=>[T(d)])),_:1}),Z(D("input",{type:"password","onUpdate:modelValue":t[7]||(t[7]=t=>e.logonInfo.password=t),placeholder:"请输入密码"},null,512),[[ie,e.logonInfo.password]])]),D("div",fo,[T(s,null,{default:I((()=>[T(m)])),_:1}),Z(D("input",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.logonInfo.nickname=t),placeholder:"请输入昵称"},null,512),[[ie,e.logonInfo.nickname]])]),D("div",ho,[D("div",{class:E(["sex-item",{active:"0"==e.logonInfo.sex}]),onClick:t[9]||(t[9]=t=>e.logonInfo.sex="0")},[D("img",{src:Pe},null,8,vo)],2),D("div",{class:E(["sex-item",{active:"1"==e.logonInfo.sex}]),onClick:t[10]||(t[10]=t=>e.logonInfo.sex="1")},[D("img",{src:Ue},null,8,bo)],2)]),T(u,{type:"primary",round:"",class:"full-w",onClick:e.handleLogon,loading:e.isloading},{default:I((()=>[yo])),_:1},8,["onClick","loading"]),D("p",ko,[wo,T(c,{type:"success",underline:!1,onClick:t[11]||(t[11]=t=>e.isLogon=!1)},{default:I((()=>[xo])),_:1})])])):(C(),V("div",Kn,[D("div",Jn,[T(s,null,{default:I((()=>[T(r)])),_:1}),Z(D("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=t=>e.loginInfo.username=t),placeholder:"请输入用户名"},null,512),[[ie,e.loginInfo.username]])]),D("div",Gn,[T(s,null,{default:I((()=>[T(d)])),_:1}),Z(D("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=t=>e.loginInfo.password=t),placeholder:"请输入密码"},null,512),[[ie,e.loginInfo.password]])]),D("div",Zn,[D("div",Xn,[D("label",Yn,[D("input",{class:"custom-checkbox",checked:e.isRemeber,type:"checkbox",onChange:t[2]||(t[2]=(...t)=>e.handleChangeRemeber&&e.handleChangeRemeber(...t))},null,40,eo),to]),no]),D("div",oo,[T(c,{type:"success",underline:!1,onClick:t[3]||(t[3]=t=>e.forgetPasswordVisible=!0)},{default:I((()=>[lo])),_:1})])]),T(u,{type:"primary",round:"",class:"full-w",onClick:e.handleLogin,loading:e.isloading},{default:I((()=>[ao])),_:1},8,["onClick","loading"]),D("p",io,[so,T(c,{type:"success",underline:!1,onClick:t[4]||(t[4]=t=>e.isLogon=!0)},{default:I((()=>[ro])),_:1})]),!o.checkIsClientEnv()&&o.checkIsPGComEnv()?(C(),V("div",{key:0,class:"qq",onClick:t[5]||(t[5]=(...t)=>e.handleqqLogin&&e.handleqqLogin(...t))},[D("div",null,[D("img",{src:Re,alt:"QQ登录"},null,8,co)]),uo])):_("v-if",!0),o.checkIsClientEnv()?_("v-if",!0):(C(),S(p,{key:1,callback:e.handleGoogleLogin,class:"scrollHidden",style:{"border-radius":"10px",padding:"2px"}},null,8,["callback"]))]))],64)),(C(),S(W,{to:"body"},[e.forgetPasswordVisible?(C(),S(g,{key:0,style:{"z-index":"2001"},visible:e.forgetPasswordVisible,onClose:t[12]||(t[12]=t=>e.forgetPasswordVisible=!1)},null,8,["visible"])):_("v-if",!0)]))],512),[[X,n.visible]])])),_:1})}],["__scopeId","data-v-4d26acba"],["__file","D:/project/pixel-grid/src/components/dialog/LoginDialog.vue"]]);const $o=u({name:"slotWindow",components:{windowHeader:Ne},props:{dataSource:{type:Object,default:null},selected:{type:String,default:""}},emits:["select","zoom","close","hide"],setup:(e,t)=>s({},{handleSelect(e){t.emit("select",e)},handleZoom(e){t.emit("zoom",e)},handleClose(e){t.emit("close",e)},handleHide(e){t.emit("hide",e)}})}),To=["title"],Lo={style:{padding:"6px",height:"calc(100% - 40px)"}},Eo={class:"full-layout-1 scrollbar"},Po=(e=>(M("data-v-2ae34cad"),e=e(),B(),e))((()=>D("div",{style:{display:"none"},class:"absolute-full"},null,-1)));var Uo=v($o,[["render",function(e,t,n,o,l,a){const i=x("windowHeader");return C(),V("div",{title:e.dataSource.name,onClick:t[0]||(t[0]=t=>e.handleSelect(e.dataSource)),class:E({window:!0,"window-active":e.dataSource.id===e.selected}),onContextmenu:t[1]||(t[1]=ae((()=>{}),["stop"]))},[T(i,{value:e.dataSource,onHide:e.handleHide,onZoom:e.handleZoom,onClose:e.handleClose},null,8,["value","onHide","onZoom","onClose"]),D("div",Lo,[D("div",Eo,[ce(e.$slots,"default",{},void 0,!0),Po])])],42,To)}],["__scopeId","data-v-2ae34cad"],["__file","D:/project/pixel-grid/src/components/window/slotWindow.vue"]]);const Mo=u({name:"iframeWindow",components:{windowHeader:Ne},props:{dataSource:{type:Object,default:null},selected:{type:String,default:""},loading:{type:Boolean,default:!0}},emits:["select","load","zoom","close","hide"],setup:(e,t)=>s({},{handleSelect(e){t.emit("select",e)},handleIframeLoad(){t.emit("load",e.dataSource)},handleZoom(e){t.emit("zoom",e)},handleClose(e){t.emit("close",e)},handleHide(e){t.emit("hide",e)}})}),Bo=["title"],Ao={style:{padding:"6px",height:"calc(100% - 40px)"}},Oo={class:"full-layout-1 scrollbar"},jo=["src","name"],Ro=(e=>(M("data-v-689b8813"),e=e(),B(),e))((()=>D("div",{style:{height:"100%",width:"100%",display:"none",position:"absolute"}},null,-1)));var Fo=v(Mo,[["render",function(e,t,n,o,l,a){const i=x("windowHeader"),s=ue("loading");return C(),V("div",{title:e.dataSource.name,onClick:t[1]||(t[1]=t=>e.handleSelect(e.dataSource)),class:E({window:!0,"window-active":e.dataSource.id===e.selected}),onContextmenu:t[2]||(t[2]=ae((()=>{}),["stop"]))},[T(i,{value:e.dataSource,onZoom:e.handleZoom,onHide:e.handleHide,onClose:e.handleClose},null,8,["value","onZoom","onHide","onClose"]),D("div",Ao,[Z((C(),V("div",Oo,[D("iframe",{target:"_self",id:"iframe",src:e.dataSource.link,name:e.dataSource.name,frameborder:"0",onLoad:t[0]||(t[0]=(...t)=>e.handleIframeLoad&&e.handleIframeLoad(...t)),scrolling:"yes"},"\r\n                ",40,jo),Ro])),[[s,e.loading]])])],42,Bo)}],["__scopeId","data-v-689b8813"],["__file","D:/project/pixel-grid/src/components/window/iframeWindow.vue"]]);const Ho=u({name:"CustomPindouDialog",components:{},props:{},emits:["close","update"],setup(e,t){let{proxy:n}=c();const o=O();let l=p({dialogVisible:!1,loading:!1,list:null,myCustom:[],pindouBrand:"",customPindouKey:"",customPindouName:"",customPindouLabel:"",innerVisible:!1,name:"",color:"",editMask:-1,customData:{},isAddPindou:!1,searchValue:"",searchData:[],selectRows:[],pindouColorScheme:"",isloading:!1,pindouColorSchemeOptions:[{num:"0",label:"黑色系"},{num:"1",label:"白色系"},{num:"2",label:"灰色系"},{num:"3",label:"棕色系"},{num:"4",label:"红色系"},{num:"5",label:"红橙色系"},{num:"6",label:"橙色系"},{num:"7",label:"橙黄色系"},{num:"8",label:"黄色系"},{num:"9",label:"黄绿色系"},{num:"10",label:"绿色系"},{num:"11",label:"蓝绿色系"},{num:"12",label:"蓝色系"},{num:"13",label:"蓝紫色系"},{num:"14",label:"紫色系"},{num:"15",label:"紫红色系"},{num:"16",label:"粉色系"}]}),a={selectable:e=>!0,handleSelectionChange(e){l.selectRows=e},handleSearchColorScheme(){let e=l.list&&l.list.data;l.isloading=!0,l.searchValue="";let t=[];for(let n=0;n<e.length;n++){let o=ye(e[n].color);ke(we(o[0],o[1],o[2]),l.pindouColorScheme)&&t.push(e[n])}l.searchData=t,l.isloading=!1},handleSearch(){if(""===l.searchValue.trim())return l.searchData=[],n.$message.warning("请输入搜索内容");l.isloading=!0;let e=new RegExp(l.searchValue,"i");l.searchData=l.list&&l.list.data.filter((t=>e.test(t.name))),l.isloading=!1},handleClose(){l.dialogVisible=!1,t.emit("close")},handleOpen(){l.dialogVisible=!0;let e=n.$utils.cache.pindou.get();e&&(l.myCustom=JSON.parse(e),""===l.pindouBrand&&(l.pindouBrand=l.myCustom[0].value,l.list=a.getList()))},getList:(e=l.pindouBrand)=>e&&""!==e&&JSON.parse(JSON.stringify(o.pindouMaps[e]))||null,saveData(){n.$utils.cache.pindou.set(JSON.stringify(l.myCustom)),t.emit("update")},handleChange(e){""===l.pindouBrand?l.list=null:(a.handleReset(),l.list=a.getList(l.pindouBrand))},async handleSavePindou(e){if("edit"===e){if(""===l.customPindouLabel.trim())return n.$message.warning("请输入拼豆名称");return void(await o.editPindouData({id:l.pindouBrand,value:l.list})&&(l.myCustom.forEach((e=>{e.value===l.pindouBrand&&(e.label=l.customPindouLabel)})),a.saveData(),n.$message.success("已保存")))}if(l.customPindouKey=y.v1(),""===l.customPindouName.trim()||""===l.customPindouKey.trim())return n.$message.warning("请输入拼豆名称");if(Object.keys(o.pindouMaps).find((e=>e===l.customPindouKey)))return n.$message.warning("拼豆属性不能重复");await o.savePindouData({id:l.customPindouKey,value:{data:[],label:l.customPindouName}})&&(l.myCustom.push({label:l.customPindouName,value:l.customPindouKey}),l.pindouBrand=l.customPindouKey,l.list=a.getList(),a.saveData(),n.$message.success("已新增"),l.isAddPindou=!1,l.customPindouKey="",l.customPindouName="")},async handleDeletePindou(){var e,t;if(xe.has(l.pindouBrand))return n.$message.warning("该拼豆不能删除");let i=l.myCustom.findIndex((e=>e.value===l.pindouBrand));if(i>=0){await o.deletePindouById(l.pindouBrand)&&(l.myCustom.splice(i,1),l.pindouBrand=(null==(e=l.myCustom[0])?void 0:e.value)?null==(t=l.myCustom[0])?void 0:t.value:"",l.list=a.getList(),a.saveData(),n.$message.success("已删除"))}},handleAdd(){l.innerVisible=!0,l.editMask=-1,l.name="",l.color=""},hideDiaog(){l.innerVisible=!1},handleAddColorTemplate(){let e=n.$utils.cache.mycolor.get();if(e){let t=JSON.parse(e);o.setMyColorList(l.list);let a=l.list&&l.list.data.map((e=>({label:null==e?void 0:e.name,color:String(e.color).startsWith("#")?e.color:`#${e.color}`})));t.push({id:y.v1(),groupName:l.list.label,list:a}),n.$utils.cache.mycolor.set(JSON.stringify(t)),o.setMyColorList(t),n.$message.success("添加成功")}},handleReset(){l.searchValue="",l.searchData=[],l.pindouColorScheme=""},handleEdit(){if(""===l.name)return n.$message.warning("色号不能为空");if(""===l.color)return n.$message.warning("颜色不能为空");if(!Ce(l.color)&&!Se(l.color))return n.$message.warning("颜色不规范，请输入十六进制的颜色值");if(l.editMask>=0)l.list&&(l.list.data[l.editMask]={name:l.name,color:l.color.slice(1,7).toLowerCase()});else{if(l.list&&l.list.data.find((e=>e.name===l.name)))return n.$message.warning("色号不能重复");l.list.data.push({name:l.name,color:l.color.slice(1,7).toLowerCase()})}o.editPindouData({id:l.pindouBrand,value:l.list}).then((e=>{n.$message.success("已保存"),a.hideDiaog()})).catch((e=>{n.$message.error("保存失败")}))},handleDelete(e){let t=l.list&&l.list.data.findIndex((t=>t.name===e.name));t>=0&&l.list.data.splice(t,1),o.editPindouData({id:l.pindouBrand,value:l.list}).then((e=>{n.$message.success("已删除")})).catch((e=>{n.$message.error("删除失败")}))},handleBatchDelete(){if(!l.selectRows.length)return n.$message.warning("请先选择拼豆色号");l.selectRows.forEach((e=>{let t=l.list&&l.list.data.findIndex((t=>t.name===e.name));t>=0&&l.list.data.splice(t,1)})),o.editPindouData({id:l.pindouBrand,value:l.list}).then((e=>{a.handleSearch(),n.$message.success("已删除")})).catch((e=>{n.$message.error("删除失败")}))},exportFile(e=!1){if(!e&&o.checkVipFunction("customPindouExport"))return;let t=e?"拼豆色卡模板":`${l.pindouBrand}-${l.customPindouLabel}`;const n=ze.book_new(),a=ze.json_to_sheet(e?[{name:"A1",color:"000000"}]:l.list?l.list.data:[]);ze.book_append_sheet(n,a,"Sheet1"),qe(n,`${t}.xlsx`)},exportJSONFile(){if(o.checkVipFunction("customPindouExport"))return;const e=JSON.stringify(l.list?l.list.data:[]),t=new Blob([e],{type:""});Ie.saveAs(t,`${l.pindouBrand}-${l.customPindouLabel}.json`)},importExcelFile(){const e=document.createElement("input");e.type="file",e.accept=".xls,.xlsx",e.addEventListener("change",(function(){const t=e.files[0];if(t){const e=new FileReader;e.onload=function(e){const t=new Uint8Array(e.target.result),n=Qe(t,{type:"array",cellStyles:!0});let o=[];n.SheetNames.forEach((function(e){const t=n.Sheets[e],l=ze.sheet_to_json(t);o=o.concat(l)})),a.openInfo(o)},e.readAsArrayBuffer(t)}})),document.body.appendChild(e),e.click(),document.body.removeChild(e)},importJSONFile(){const e=document.createElement("input");e.type="file",e.accept="application/json",e.addEventListener("change",(function(){const t=e.files[0];if(t){const e=new FileReader;e.onload=function(e){const t=JSON.parse(e.target.result);a.openInfo(t)},e.readAsText(t)}})),document.body.appendChild(e),e.click(),document.body.removeChild(e)},openInfo(e){Q.confirm("是否覆盖已有数据?","提 示",{confirmButtonText:"确 认",cancelButtonText:"取 消",type:"warning"}).then((()=>{l.list?l.list.data=e:l.list={data:e,label:l.pindouBrand},o.editPindouData({id:l.pindouBrand,value:l.list,label:l.customPindouLabel}).then((e=>{n.$message.success("已覆盖")})).catch((e=>{n.$message.error("保存失败")}))})).catch((()=>{}))},handleInput(e){l.customPindouKey=l.customPindouKey.replace(/[\u4E00-\u9FA5]/g,"")}};return g((()=>{a.handleOpen()})),oe((()=>l.pindouBrand),((e,t)=>{if(e){let t=l.myCustom.find((t=>t.value===e));l.customPindouLabel=t?t.label:""}else l.customPindouLabel="",l.pindouBrand=""})),oe((()=>l.customPindouLabel),((e,t)=>{l.list&&(l.list.label=e)})),r(s(s({},h(l)),a),{Upload:pe,Plus:me,Delete:ge,Edit:fe,getFontColor:he,copyText:ve,FolderOpened:be})}}),No={class:"content scrollbar"},zo={class:"item flex-start"},qo=A(" 新建拼豆色卡 "),Qo={class:"flex-column-start"},Wo={class:"flex-end"},Ko=A("取消"),Jo=A("保存"),Go=A("下载空模板"),Zo=A("导入为Excel"),Xo=A("导出为Excel"),Yo=A("导入为JSON"),el=A("导出为JSON"),tl={class:"flex",style:{gap:"10px"}},nl=A("重 置"),ol=A("批量删除"),ll=A("新 增"),al=["onClick"],il=A("删 除"),sl=A("编 辑"),rl={class:"text-center",style:{"margin-top":"10px","font-size":"14px"}},dl={class:"flex-between",style:{"margin-top":"10px"}},cl={class:"dialog-footer"};var ul={CustomPindouDialog:v(Ho,[["render",function(e,t,n,o,l,a){const i=x("el-option"),s=x("el-button"),r=x("el-input"),d=x("el-select"),c=x("el-tooltip"),u=x("el-popconfirm"),p=x("el-dropdown-item"),m=x("el-dropdown-menu"),g=x("el-dropdown"),f=x("el-table-column"),h=x("el-table"),v=x("el-color-picker"),b=x("el-dialog"),y=ue("loading");return C(),V($,null,[_(' <el-dialog \r\n    v-model="dialogVisible" \r\n    title="自定义拼豆"\r\n    :width="600"\r\n    append-to-body\r\n    :before-close="handleClose"\r\n    :lock-scroll="false"\r\n    class="z-dialog" center> '),D("div",No,[D("div",zo,[T(d,{modelValue:e.pindouBrand,"onUpdate:modelValue":t[4]||(t[4]=t=>e.pindouBrand=t),placeholder:"请选择",style:{width:"200px","min-width":"100px"},onChange:e.handleChange,clearable:""},{footer:I((()=>[e.isAddPindou?(C(),V($,{key:1},[D("div",Qo,[_(' <el-input\r\n                                v-model="customPindouKey"\r\n                                class="option-input"\r\n                                placeholder="请输入拼豆属性[仅支持数字和英文]"\r\n                                size="small"\r\n                                maxlength="20"\r\n                                @input="handleInput"\r\n                                /> '),T(r,{modelValue:e.customPindouName,"onUpdate:modelValue":t[1]||(t[1]=t=>e.customPindouName=t),class:"option-input",placeholder:"请输入拼豆名称",size:"small",maxlength:"15"},null,8,["modelValue"])]),D("div",Wo,[T(s,{size:"small",onClick:t[2]||(t[2]=t=>{e.customPindouKey="",e.customPindouName="",e.isAddPindou=!1})},{default:I((()=>[Ko])),_:1}),T(s,{type:"primary",size:"small",onClick:t[3]||(t[3]=t=>e.handleSavePindou("save"))},{default:I((()=>[Jo])),_:1})])],64)):(C(),S(s,{key:0,text:"",bg:"",size:"small",onClick:t[0]||(t[0]=t=>e.isAddPindou=!0)},{default:I((()=>[qo])),_:1}))])),default:I((()=>[(C(!0),V($,null,L(e.myCustom,(e=>(C(),S(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),T(r,{modelValue:e.customPindouLabel,"onUpdate:modelValue":t[5]||(t[5]=t=>e.customPindouLabel=t),placeholder:"请输入拼豆名称",style:{width:"200px","min-width":"100px"},disabled:""===e.pindouBrand},null,8,["modelValue","disabled"]),T(c,{content:"保存",placement:"top"},{default:I((()=>[T(s,{type:"primary",icon:e.Edit,onClick:t[6]||(t[6]=t=>e.handleSavePindou("edit")),disabled:""===e.pindouBrand},null,8,["icon","disabled"])])),_:1}),T(u,{title:"确定删除该拼豆?",onConfirm:e.handleDeletePindou},{reference:I((()=>[T(s,{type:"danger",icon:e.Delete,disabled:""===e.pindouBrand},null,8,["icon","disabled"])])),_:1},8,["onConfirm"]),T(g,null,{dropdown:I((()=>[T(m,null,{default:I((()=>[T(p,{onClick:t[7]||(t[7]=t=>e.exportFile(!0))},{default:I((()=>[Go])),_:1}),T(p,{onClick:e.importExcelFile},{default:I((()=>[Zo])),_:1},8,["onClick"]),T(p,{onClick:t[8]||(t[8]=t=>e.exportFile(!1))},{default:I((()=>[Xo])),_:1}),T(p,{onClick:e.importJSONFile},{default:I((()=>[Yo])),_:1},8,["onClick"]),T(p,{onClick:e.exportJSONFile},{default:I((()=>[el])),_:1},8,["onClick"])])),_:1})])),default:I((()=>[T(s,{type:"warning",icon:e.FolderOpened,disabled:""===e.pindouBrand},null,8,["icon","disabled"])])),_:1}),T(c,{content:"添加到颜色模板",placement:"top"},{default:I((()=>[T(s,{type:"success",icon:e.Plus,onClick:e.handleAddColorTemplate,disabled:""===e.pindouBrand},null,8,["icon","onClick","disabled"])])),_:1})]),D("div",tl,[T(r,{modelValue:e.searchValue,"onUpdate:modelValue":t[9]||(t[9]=t=>e.searchValue=t),style:{width:"150px","min-width":"100px"},placeholder:"搜索色号",clearable:"",onKeyup:De(e.handleSearch,["enter"]),disabled:""===e.pindouBrand},null,8,["modelValue","onKeyup","disabled"]),T(d,{modelValue:e.pindouColorScheme,"onUpdate:modelValue":t[10]||(t[10]=t=>e.pindouColorScheme=t),placeholder:"请选择色系",style:{width:"150px","min-width":"100px"},onChange:e.handleSearchColorScheme,clearable:""},{default:I((()=>[(C(!0),V($,null,L(e.pindouColorSchemeOptions,(e=>(C(),S(i,{key:e.num,label:e.label,value:e.label},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),T(s,{type:"primary",onClick:e.handleReset,disabled:""===e.pindouBrand},{default:I((()=>[nl])),_:1},8,["onClick","disabled"]),T(s,{type:"danger",onClick:e.handleBatchDelete,disabled:""===e.pindouBrand,style:{"margin-left":"0"}},{default:I((()=>[ol])),_:1},8,["onClick","disabled"]),T(s,{type:"success",onClick:e.handleAdd,disabled:""===e.pindouBrand,style:{"margin-left":"0"}},{default:I((()=>[ll])),_:1},8,["onClick","disabled"])]),D("div",null,[Z((C(),S(h,{data:e.searchData.length?e.searchData:e.list?e.list.data||e.list:[],style:{width:"100%"},"max-height":"500","element-loading-background":"#00000000",onSelectionChange:e.handleSelectionChange},{default:I((()=>[T(f,{type:"selection",selectable:e.selectable,width:"55"},null,8,["selectable"]),T(f,{prop:"name",label:"色 号",width:"150",sortable:""}),T(f,{prop:"color",label:"色 值"},{default:I((t=>[D("div",{class:"flex-center color-item pointer",onClick:n=>e.copyText(`#${t.row.color}`),style:P({backgroundColor:"#"+t.row.color,color:e.getFontColor("#"+t.row.color)})}," #"+U(t.row.color),13,al)])),_:1}),T(f,{fixed:"right",label:"操 作",width:"120"},{default:I((t=>[T(u,{title:"确定删除该色号?",onConfirm:n=>e.handleDelete(t.row)},{reference:I((()=>[T(s,{link:"",type:"primary",size:"small"},{default:I((()=>[il])),_:1})])),_:2},1032,["onConfirm"]),T(s,{link:"",type:"primary",size:"small",onClick:n=>{e.innerVisible=!0,e.editMask=t.$index,e.color=`#${t.row.color}`,e.name=t.row.name}},{default:I((()=>[sl])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"])),[[y,e.isloading]])]),D("div",rl,"色号总数："+U(e.searchData.length?e.searchData.length:e.list?e.list.data.length||e.list.length:0),1)]),_(' <template #footer>\r\n            <span class="dialog-footer">\r\n                <el-button @click="handleClose"\r\n                >{{$t(\'message.cancel\')}}</el-button>\r\n                <el-button type="primary" @click="handleConfirm" :loading="loading"\r\n                >{{$t(\'message.save\')}}</el-button>\r\n            </span>\r\n        </template> '),T(b,{modelValue:e.innerVisible,"onUpdate:modelValue":t[13]||(t[13]=t=>e.innerVisible=t),width:"300",title:e.editMask>=0?"修改":"添加","append-to-body":"",class:"z-dialog"},{footer:I((()=>[D("div",cl,[T(s,{onClick:e.hideDiaog},{default:I((()=>[A(U(e.$t("message.cancel")),1)])),_:1},8,["onClick"]),T(s,{type:"primary",onClick:e.handleEdit},{default:I((()=>[A(U(e.$t("message.save")),1)])),_:1},8,["onClick"])])])),default:I((()=>[D("div",dl,[T(r,{modelValue:e.name,"onUpdate:modelValue":t[11]||(t[11]=t=>e.name=t),placeholder:"请输入",style:{width:"200px"}},null,8,["modelValue"]),T(v,{modelValue:e.color,"onUpdate:modelValue":t[12]||(t[12]=t=>e.color=t)},null,8,["modelValue"])])])),_:1},8,["modelValue","title"]),_(" </el-dialog> ")],64)}],["__scopeId","data-v-12581535"],["__file","D:/project/pixel-grid/src/components/dialog/CustomPindouDialog.vue"]])};const pl={name:"RecordMenu",props:{visible:{type:Boolean,default:!1},left:{type:Number,default:0},top:{type:Number,default:0},contextData:{type:Object,default:null}},components:{},emits:[],setup(e,t){const n=He();let o=p({timer:null,newTop:e.top,newLeft:e.left}),l={handleDelete(){n.methods.handleClose(e.contextData)}};return g((()=>{let t=document.body.offsetHeight,n=document.body.offsetWidth,l=document.querySelector("#contextMenu");e.top+l.offsetHeight>t?o.newTop=t-l.offsetHeight:e.left+l.offsetWidth>n&&(o.newLeft=n-70-l.offsetWidth)})),s(s({},h(o)),l)}},ml=(e=>(M("data-v-cc10a380"),e=e(),B(),e))((()=>D("span",null,"删 除",-1)));const gl={class:"app-back"},fl={class:"app-body scrollbar"},hl={ref:"appBackNode",class:"flex-column-start full-layout",id:"app-back-box"},vl=["data-key","onContextmenu"],bl=["onClick"],yl=["src"],kl={class:"oneline"};var wl=v({name:"RecordBox",props:{dataSource:{type:Array,default:null}},components:{RecordMenu:v(pl,[["render",function(e,t,n,o,l,a){const i=x("Delete"),s=x("el-icon");return n.visible?(C(),V("ul",{key:0,id:"contextMenu",style:P({left:e.newLeft+"px",top:e.newTop+"px"}),class:"contextmenu"},[D("li",{class:"flex-between",onClick:t[0]||(t[0]=(...t)=>e.handleDelete&&e.handleDelete(...t))},[ml,T(s,null,{default:I((()=>[T(i)])),_:1})])],4)):_("v-if",!0)}],["__scopeId","data-v-cc10a380"],["__file","D:/project/pixel-grid/src/components/menu/RecordMenu.vue"]])},emits:[],setup(e,t){const n=He();let o=p({isExpand:!1,menuVisible:!1,left:0,top:0,contextData:null}),l={closeMenu(){o.menuVisible=!1},handleMenu(e,t){l.closeMenu(),setTimeout((()=>{o.menuVisible=!0,o.left=e.pageX,o.top=e.pageY,o.contextData=t}),100)},handleShow(e){l.closeMenu(),l.handleExpand(),n.methods.showWindow(e)},handleExpand(){o.isExpand=!o.isExpand;let e=document.querySelector(".app-back"),t=document.querySelector(".app-back-icon");o.isExpand?(e.style.transform="translateX(0)",t.children[0].style.transform="rotate(180deg)"):(e.style.transform="translateX(100%)",t.children[0].style.transform="rotate(0deg)"),l.closeMenu()}};return g((()=>{document.addEventListener("click",l.closeMenu)})),G((()=>{document.removeEventListener("click",l.closeMenu)})),s(s({},h(o)),l)}},[["render",function(e,t,n,o,l,a){const i=x("DArrowLeft"),s=x("el-icon"),r=x("el-avatar"),d=x("el-tooltip"),c=x("RecordMenu");return C(),V("div",gl,[D("div",{class:"app-back-icon",onClick:t[0]||(t[0]=(...t)=>e.handleExpand&&e.handleExpand(...t))},[T(s,null,{default:I((()=>[T(i)])),_:1})]),D("div",fl,[D("ul",hl,[(C(!0),V($,null,L(n.dataSource,(n=>(C(),V("li",{draggable:"true",key:n.id,"data-key":n.id,onContextmenu:ae((t=>e.handleMenu(t,n)),["prevent"]),class:"app-content flex-column-center"},[T(d,{effect:"dark",content:n.name,placement:"left"},{default:I((()=>[D("div",{class:"app-img",onClick:t=>e.handleShow(n)},[T(r,{shape:"square",onError:t[1]||(t[1]=()=>!0),src:n.icon},{default:I((()=>[D("img",{src:Be},null,8,yl)])),_:2},1032,["src"]),D("p",kl,U(n.name),1)],8,bl)])),_:2},1032,["content"])],40,vl)))),128))],512)]),(C(),S(W,{to:"body"},[e.menuVisible?(C(),S(c,{key:0,visible:e.menuVisible,left:e.left,top:e.top,contextData:e.contextData},null,8,["visible","left","top","contextData"])):_("v-if",!0)]))])}],["__scopeId","data-v-4d8c860c"],["__file","D:/project/pixel-grid/src/components/drawer/RecordBox.vue"]]);const xl={name:"PetMenu",props:{visible:{type:Boolean,default:!1},left:{type:Number,default:0},top:{type:Number,default:0},contextData:{type:Object,default:null}},components:{},emits:["run"],setup(e,t){const n=O();let o=p({timer:null,newTop:e.top,newLeft:e.left}),l={handleDelete(){n.PetVisible=!1}};return g((()=>{let t=document.body.offsetHeight,n=document.body.offsetWidth,l=document.querySelector("#contextMenu");e.top+l.offsetHeight>t?o.newTop=t-l.offsetHeight:e.left+l.offsetWidth>n&&(o.newLeft=n-70-l.offsetWidth)})),s(s({},h(o)),l)}},Cl=e=>(M("data-v-78b5275e"),e=e(),B(),e),Sl=[Cl((()=>D("span",null,"回窝里",-1)))],Il=[Cl((()=>D("span",null,"跑一圈",-1)))];const Dl=u({name:"Pet",components:{PetMenu:v(xl,[["render",function(e,t,n,o,l,a){return n.visible?(C(),V("ul",{key:0,id:"contextMenu",style:P({left:e.newLeft+"px",top:e.newTop+"px"}),class:"contextmenu"},[D("li",{class:"flex-between",onClick:t[0]||(t[0]=(...t)=>e.handleDelete&&e.handleDelete(...t))},Sl),D("li",{class:"flex-between",onClick:t[1]||(t[1]=t=>e.$emit("run"))},Il)],4)):_("v-if",!0)}],["__scopeId","data-v-78b5275e"],["__file","D:/project/pixel-grid/src/components/menu/PetMenu.vue"]])},emits:[],props:{},setup(e,t){const n=j();let o=O(),l=p({currentPet:"dog",currentEvent:"0",currentState:"0",eventInfo:{0:["0","1","2"],1:["0"],2:["0","1"],3:["0"]},gifRes:"",timer:null,timer1:null,timer2:null,speed:0,moveDistance:20,isRunning:!1,direction:1,animationId:null,beforeEvent:"-1",talk:"",menuVisible:!1,left:0,top:0,time:15e3,taskEvent:"random",currentMoveDistance:0,triedTalks:["累死了，QAQ","跑不动了，实在跑不动啦！","要死啦，要死啦！"],cuteTalks:["我可爱吗？主人","嘿嘿嘿~","噜啦啦噜啦啦~","今天心情美美哒！"],cryTalks:["汪 ~ 汪 ~","嗷呜~"],runTalks:["冲啊啊啊啊~","冲啊啊~","要多运动减肥","GoGoGo，出发咯"],dailyTalks:["今天吃什么？","别画了，快来摸摸我","今天去哪玩？"]}),a={handleCloseMenu(){l.menuVisible=!1},handleContextMenu(e){l.menuVisible=!1,setTimeout((()=>{l.menuVisible=!0,l.left=e.pageX,l.top=e.pageY}),100)},getGreeting(){const e=(new Date).getHours();l.talk=e>=0&&e<6?"主人，你怎么还不睡觉！":e>=6&&e<12?"早上好呀！主人":e>=12&&e<18?"下午好呀！主人":"晚上好呀！主人"},handleRandomEvent(){var e;if("random"!==l.taskEvent)return;null==(e=n.value)||e.hide(),a.stopRunAnimation(),l.talk="";let t=Math.floor(101*Math.random());"2"===l.currentEvent&&"1"===l.currentState?(t=35,l.talk=l.triedTalks[Math.floor(Math.random()*l.triedTalks.length)]):"2"===l.currentEvent&&"0"===l.currentState?t=15:"3"===l.currentEvent&&t>=80&&(t=10),t>=0&&t<=20?(l.currentEvent="0",l.currentState="0",l.talk=l.dailyTalks[Math.floor(Math.random()*l.dailyTalks.length)]):t>20&&t<=30?(l.currentEvent="0",l.currentState="1",l.talk=l.dailyTalks[Math.floor(Math.random()*l.dailyTalks.length)]):t>30&&t<=40?(l.currentEvent="0",l.currentState="2"):t>40&&t<=60?(l.currentEvent="1",l.currentState="0",l.talk=l.cuteTalks[Math.floor(Math.random()*l.cuteTalks.length)]):t>60&&t<=70?(l.currentEvent="2",l.currentState="0",l.speed=20,l.talk=l.runTalks[Math.floor(Math.random()*l.runTalks.length)]):t>70&&t<=80?(l.currentEvent="2",l.currentState="1",l.speed=40,l.talk=l.runTalks[Math.floor(Math.random()*l.runTalks.length)]):t>80&&t<=100&&(l.currentEvent="3",l.currentState="0",l.talk=l.cryTalks[Math.floor(Math.random()*l.cryTalks.length)]),l.beforeEvent=l.currentEvent,a.handleUpdate(),a.startRunAnimation()},handleUpdate(){var e;l.gifRes=new URL(`/img/${l.currentPet}_${l.currentEvent}_${l.currentState}.gif`,window.location.origin).href,""!==l.talk&&(l.timer1&&clearTimeout(l.timer1),null==(e=n.value)||e.show(),l.timer1=setTimeout((()=>{var e;null==(e=n.value)||e.hide()}),3e3))},startRunAnimation(){if(0===l.speed)return;l.isRunning=!0;let e=0;l.animationId=requestAnimationFrame((function t(n){var o;e||(e=n);const i=(n-e)/1e3;e=n;const s=l.speed*i*l.direction,r=l.speed*i;l.moveDistance+=s,l.currentMoveDistance+=r;let d=document.body.offsetWidth;const c=d,u=null==(o=document.querySelector(".pet-box"))?void 0:o.offsetWidth;if(l.moveDistance<=0?(l.moveDistance=0,l.direction=1):l.moveDistance>=c-u&&(l.moveDistance=c-u,l.direction=-1),"run"===l.taskEvent&&l.currentMoveDistance>=d)return l.taskEvent="random",a.stopRunAnimation(),void a.handleRandomEvent();l.isRunning&&(l.animationId=requestAnimationFrame(t))}))},stopRunAnimation(){l.isRunning=!1,l.speed=0,l.animationId&&cancelAnimationFrame(l.animationId),l.currentMoveDistance=0},handleRunEvent(){l.taskEvent="run",l.currentEvent="2",l.currentState="1",l.speed=40,l.talk=l.runTalks[Math.floor(Math.random()*l.runTalks.length)],a.handleUpdate(),a.startRunAnimation()},handleCryEvent(){l.timer2&&clearTimeout(l.timer2),l.timer2=setTimeout((()=>{l.taskEvent="cry",l.currentEvent="3",l.currentState="0",l.talk=l.cryTalks[Math.floor(Math.random()*l.cryTalks.length)],a.handleUpdate(),setTimeout((()=>{l.taskEvent="random",a.handleRandomEvent()}),5e3)}),200)}};return g((()=>{a.getGreeting(),a.handleUpdate(),l.timer=setInterval((()=>{a.handleRandomEvent()}),l.time),document.body.addEventListener("click",a.handleCloseMenu)})),G((()=>{l.timer&&clearInterval(l.timer),l.animationId&&cancelAnimationFrame(l.animationId),document.body.removeEventListener("click",a.handleCloseMenu)})),r(s(s({},h(l)),a),{editSpaceStore:o,tooltipRef:n})}}),_l=["src"];var Vl=v(Dl,[["render",function(e,t,n,o,l,a){const i=x("px-tooltip"),s=x("PetMenu");return C(),V($,null,[D("div",{class:"pet-box",onContextmenu:t[1]||(t[1]=ae((t=>e.handleContextMenu(t)),["prevent"])),style:P({right:e.moveDistance+"px"})},[T(i,{ref:"tooltipRef",manual:"",content:e.talk,placement:"top"},{default:I((()=>[D("img",{src:e.gifRes,class:"pointer",onClick:t[0]||(t[0]=(...t)=>e.handleCryEvent&&e.handleCryEvent(...t)),style:P({transform:`scaleX(${e.direction})`})},null,12,_l)])),_:1},8,["content"])],36),(C(),S(W,{to:"body"},[e.menuVisible?(C(),S(s,{key:0,onRun:e.handleRunEvent,visible:e.menuVisible,left:e.left,top:e.top},null,8,["onRun","visible","left","top"])):_("v-if",!0)]))],64)}],["__scopeId","data-v-5399a0c2"],["__file","D:/project/pixel-grid/src/components/Pet.vue"]]);const $l=u({name:"home",components:r(s({ElConfigProvider:_e,HomeHeader:Sn,HomeSideNav:Bn,HomeRouter:An,NoticeDialog:Ae,LoginDialog:Vo,Loading:Hn,Snow:In,Redbao:$n,slotWindow:Uo,iframeWindow:Fo},ul),{RecordBox:wl,Pet:Vl}),props:{},emits:[],setup(e,t){const n=He(),{proxy:o}=c(),l=O();let a=p({locale:Nn,notice:{id:"",title:"",content:"",isForceUpdate:"0"},noticeVisible:!1,loading:!0,isShowEffect:!1,autoThemeTimer:null});const i=m((()=>q().includes("christmas")?"Snow":q().includes("newyear")?"Redbao":"")),d=Ve({storageKey:"px-theme",valueDark:"dark",valueLight:"light"}),u=$e(d),v=()=>{const e=(new Date).getHours();e>=6&&e<18?(d.value=!1,l.themeValue=!1):(d.value=!0,l.themeValue=!0)};let b={changeTheme(){u(),l.themeValue=!l.themeValue},changeLanguage(){a.locale=Nn,l.lang="zh",localStorage.setItem("px-lang",l.lang)},getBmobNoticeData(){const e=o.$bmob.Query("Notice");e.limit(1),e.equalTo("type","==",f()?"client":"web"),e.equalTo("lang","==",o.$utils.cache.lang.get()),e.order("-updatedAt"),e.find().then((e=>{e.results.length&&(o.$utils.cache.isHideNotice.get()||o.$utils.cache.isHideNotice.set("0"),a.notice=e.results[0],o.$utils.cache.isHideNotice.get()!==a.notice.id&&(a.noticeVisible=!0))})).catch((e=>{b.getNoticeData()}))},getNoticeData(){Te.get(`${Le()}json/notice.json`).then((e=>{e.data.length>0&&(o.$utils.cache.isHideNotice.get()||o.$utils.cache.isHideNotice.set("0"),f()?a.notice=e.data[2]:a.notice=e.data[0],o.$utils.cache.isHideNotice.get()!==a.notice.id&&(a.noticeVisible=!0))})).catch((e=>{f()?a.notice={id:"1",title:"公告",content:"客户端异常，暂时无法使用！如长时间无法使用请联系作者\n<span style='color:green'>作者QQ：2152456816（Java）</span>",isForceUpdate:"1"}:a.notice={id:"1",title:"公告",content:"网站异常，暂时无法使用！如长时间无法使用请联系作者\n<span style='color:green'>作者QQ：2152456816（Java）</span>",isForceUpdate:"1"},a.noticeVisible=!0}))},getColorModules(){Te.get(`${Le()}json/color.json`).then((e=>{l.colorModules=e.data})).catch((e=>{}))},getOptionsData(){Te.get(`${Le()}json/option.json`).then((e=>{l.clientDownloadLink=e.data[0].url})).catch((e=>{}))},async getUserData(){let e=o.$utils.cache.userInfo.get();try{if(e){let t=JSON.parse(e).objectId,n=await l.getRemoteUserInfo(o,t);if(!n)return o.$message.warning("账号已过期，请重新登录"),void l.deleteUserInfo();if("0"===(null==n?void 0:n.isEnable))o.$message.warning("账号异常，已退出登录"),l.deleteUserInfo();else{if((null==n?void 0:n.browserId)||l.updateUserInfo(o,{browserId:l.browserId,vip:"0",vipEndAt:"0",backupCount:"0",extraBackupCount:"0"},(()=>{n.browserId=l.browserId,n.vip="0",n.vipEndAt="0",n.backupCount="0",n.extraBackupCount="0"})),(null==n?void 0:n.vipEndAt)&&"0"!==n.vipEndAt&&Ee(n.vipEndAt)<(new Date).getTime())return o.$message.warning("版本套餐已过期，请重新登录"),void l.updateUserInfo(o,{vip:"0",vipEndAt:"0"},(()=>{l.settingsOption.autoBackup=!1,o.$utils.cache.settings.set(JSON.stringify(l.settingsOption)),l.deleteUserInfo()}),(()=>l.deleteUserInfo()));n.vip||(n.vip="0"),n.vipEndAt||(n.vipEndAt="0"),n.backupCount||(n.backupCount="0"),n.extraBackupCount||(n.extraBackupCount="0"),l.saveUserInfo(n),l.getProjectList()}}}catch(t){o.$message.error("请重新登录"),l.deleteUserInfo()}finally{l.isCheckUser=!0}},getVersionInfo(){const e=o.$bmob.Query("Version");e.equalTo("platform","==","pc"),e.find().then((e=>{e.results.length&&(l.versionInfoData=e.results.map((e=>r(s({},e),{fun:e.fun.split(",")}))))})).catch((e=>{b.getVersionData()}))},getVersionData(){Te.get(`${Le()}json/version.json`).then((e=>{l.versionInfoData=e.data.map((e=>r(s({},e),{fun:e.fun.split(",")})))})).catch((e=>{o.$message.error("网络异常，版本信息获取失败"),a.loading=!1}))}};return ne((()=>{a.loading||setTimeout((()=>{a.isShowEffect=!0}),2e3),l.isCheckUser&&l.versionInfoData&&(a.loading=!1)})),oe((()=>l.settingsOption.autoTheme),((e,t)=>{e?(a.autoThemeTimer&&clearInterval(a.autoThemeTimer),a.autoThemeTimer=setInterval(v,18e5)):a.autoThemeTimer&&clearInterval(a.autoThemeTimer)})),g((()=>{window.onbeforeunload=function(e){e.returnValue="1111"},b.changeLanguage(),b.getColorModules(),setTimeout((()=>{if(z()){let e=o.$utils.cache.userInfo.get();return e&&l.saveUserInfo(JSON.parse(e)),l.isCheckUser=!0,l.getProjectList(),void b.getVersionData()}b.getBmobNoticeData(),b.getVersionInfo(),b.getUserData()}),2e3)})),s(s(r(s(s({},h(a)),b),{editSpaceStore:l,checkDate:q,getCurrentEffect:i}),h(n.data)),n.methods)}}),Tl={key:0,class:"full-layout flex-column-center",style:{"min-width":"360px"}},Ll={class:"dialog-mask gs-filter"},El={class:"loading-body flex-center"},Pl={class:"absolute-full",style:{"pointer-events":"none"}};var Ul=v($l,[["render",function(e,t,n,o,l,a){const i=x("HomeHeader"),s=x("HomeSideNav"),r=x("HomeRouter"),d=x("el-container"),c=x("Snow"),u=x("Pet"),p=x("NoticeDialog"),m=x("Loading"),g=x("LoginDialog"),f=x("RecordBox"),h=x("slotWindow"),v=x("iframeWindow"),b=x("el-config-provider");return C(),S(b,{locale:e.locale},{default:I((()=>[e.loading?_("v-if",!0):(C(),V("div",Tl,[T(i,{onChangeLanguage:e.changeLanguage,onChangeTheme:e.changeTheme},null,8,["onChangeLanguage","onChangeTheme"]),T(d,{direction:"horizontal",class:"home-box"},{default:I((()=>[T(s),T(r)])),_:1}),e.isShowEffect&&e.checkDate().includes("newyear")&&!["work","preview"].includes(e.$route.name)?(C(),S(c,{key:0})):_("v-if",!0),e.isShowEffect&&["/price","/about"].includes(e.$route.path)?(C(),S(ee(e.getCurrentEffect),{key:1,class:"isShowWebTitle"})):_("v-if",!0)])),(C(),S(W,{to:"body"},[_(' <img src="/img/dog_0_1.gif" class="pet-box"/> '),e.editSpaceStore.PetVisible&&!e.loading?(C(),S(u,{key:0})):_("v-if",!0),e.noticeVisible&&!e.loading?(C(),S(p,{key:1,visible:e.noticeVisible,notice:e.notice,onClose:t[0]||(t[0]=t=>e.noticeVisible=!1)},null,8,["visible","notice"])):_("v-if",!0),Z(D("div",Ll,null,512),[[X,e.editSpaceStore.loginVisible]]),Z(D("div",El,[T(m)],512),[[X,e.loading]]),T(g,{visible:e.editSpaceStore.loginVisible,onClose:t[1]||(t[1]=t=>e.editSpaceStore.loginVisible=!1)},null,8,["visible"]),e.editSpaceStore.windowList.length?(C(),S(f,{key:2,dataSource:e.editSpaceStore.windowList},null,8,["dataSource"])):_("v-if",!0),D("div",Pl,[(C(!0),V($,null,L(e.editSpaceStore.windowList,(t=>Z((C(),V("div",{key:t.id,style:{"pointer-events":"auto"}},["slot"===t.type?(C(),S(h,{key:0,dataSource:t,selected:e.editSpaceStore.currentSelectWindow,onSelect:e.handleSelect,onZoom:e.handleZoom,onHide:e.hideWindow,onClose:e.handleClose},{default:I((()=>[(C(),S(ee(t.component),{modelData:t.data||null},null,8,["modelData"]))])),_:2},1032,["dataSource","selected","onSelect","onZoom","onHide","onClose"])):(C(),S(v,{key:1,dataSource:t,selected:e.editSpaceStore.currentSelectWindow,loading:t.isLoading,onSelect:e.handleSelect,onZoom:e.handleZoom,onLoad:e.iframeLoad,onHide:e.hideWindow,onClose:e.handleClose},null,8,["dataSource","selected","loading","onSelect","onZoom","onLoad","onHide","onClose"]))])),[[X,!t.isHide]]))),128))])]))])),_:1},8,["locale"])}],["__scopeId","data-v-a83bd3b0"],["__file","D:/project/pixel-grid/src/views/index.vue"]]);export{Ul as default};
