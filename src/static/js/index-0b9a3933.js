var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,o=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&s(e,t,a[t]);if(l)for(var t of l(a))i.call(a,t)&&s(e,t,a[t]);return e},n=(e,l)=>a(e,t(l));import{d,A as c,r as u,c as p,o as h,U as g,t as m,aI as f,aB as v,aa as w,aK as y,a8 as D,al as b,am as x,aL as V,aM as C,aN as $,g as k,_ as j,b as P,a2 as S,l as _,O,j as z,n as N,h as I,ah as R,Y as E,k as K,F as L,p as T,f as U,T as A,e as F,z as B,v as M,s as J}from"./index-6a0d579b.js";import{u as Y}from"./useWindow-cd5ccb2a.js";import{g as W}from"./grid-33bc5412.js";import{h as q}from"./hot-d0a3d9b9.js";import{e as G}from"./empty-6662c720.js";var H=d({name:"pindou",components:{},props:{},emits:[],setup(e,a){Y();const{proxy:t}=k(),l=c();let r=u({list:[],isloading:!0,searchValue:"",searchColorValue:"",searchData:[],filterValue:[0],filterOptions:[{value:0,label:"全部"},{value:1,label:"低分辨率"},{value:2,label:"中分辨率"},{value:3,label:"高分辨率"},{value:4,label:"动态"},{value:5,label:"静态"}],currentPage:1,total:0,previewSearchData:[],previewData:null,previewLoading:!1});const i={getFrameImg:p((()=>e=>e&&""!==e?`${x()}pindouImg/${e}.png`:W))};let s={handleSearchColor(){if(""===r.searchColorValue.trim())return r.previewSearchData=[],void t.$message.warning("请输入搜索词");let e=new RegExp(r.searchColorValue,"i");r.previewSearchData=r.previewData.value.data.filter((a=>e.test(a.color)||e.test(a.name)))},search(){if(""===r.searchValue.trim())return t.$message.warning("请输入搜索词");let e=new RegExp(r.searchValue,"i");r.searchData=r.list.filter((a=>e.test(a.data.pindouName)||e.test(a.data.pindouKey)||e.test(a.data.desc)))},handleDownload({pindouKey:e,pindouName:a}){b.get(`${x()}pindou/${e}.json`).then((a=>{let t=a.data;V(JSON.stringify(t),"application/json",e)})).catch((e=>{t.$message.error("下载失败 - "+e)}))},handlePreview({pindouKey:e,pindouName:a}){r.previewSearchData=[],b.get(`${x()}pindou/${e}.json`).then((t=>{let l=t.data;r.previewLoading=!0,r.previewData={id:e,value:{data:l,label:a}}})).catch((e=>{r.previewLoading=!1,t.$message.error("预览失败 - "+e)}))},handleCurrentChange(e){r.currentPage=e,s.getData()},getData(){b.get(`${x()}json/pindou${r.currentPage}.json`).then((e=>{r.total=e.data.total,r.list=C(e.data.data,"createAt"),r.list=r.list.filter((e=>e.data.isEnable&&1===e.data.isEnable)),r.isloading=!1})).catch((e=>{t.$message.error(e),r.isloading=!1}))},filterData(e,a,t){let l=new RegExp(r.searchValue,"i");return e.filter((e=>""!==r.searchValue?(l.test(e.data.projectName)||l.test(e.data.desc))&&e.data.width*e.data.height<=a&&e.data.width*e.data.height>t:e.data.width*e.data.height<=a&&e.data.width*e.data.height>t))},filterData2(e,a){let t=new RegExp(r.searchValue,"i");return e.filter((e=>""!==r.searchValue?(t.test(e.data.projectName)||t.test(e.data.desc))&&e.data.tag.includes(a):e.data.tag.includes(a)))},handleFilter(e){if(r.isloading=!0,r.filterValue.length<=0&&(r.filterValue=[0]),r.filterValue.length>1)if(0===r.filterValue[r.filterValue.length-1])r.filterValue=[0];else{let e=r.filterValue.findIndex((e=>0===e));e>=0&&r.filterValue.splice(e,1)}if(r.searchData=[],r.filterValue.includes(0)&&(r.searchData=[...r.searchData,...s.filterData(r.list,4900,36)]),r.filterValue.includes(1)&&(r.searchData=[...r.searchData,...s.filterData(r.list,400,36)]),r.filterValue.includes(2)&&(r.searchData=[...r.searchData,...s.filterData(r.list,1600,400)]),r.filterValue.includes(3)&&(r.searchData=[...r.searchData,...s.filterData(r.list,4900,1600)]),r.filterValue.includes(4)){s.filterData2(r.list,1).forEach((e=>{r.searchData.find((a=>a.id===e.id))||r.searchData.push(e)}))}if(r.filterValue.includes(5)){s.filterData2(r.list,0).forEach((e=>{r.searchData.find((a=>a.id===e.id))||r.searchData.push(e)}))}r.isloading=!1},handleReset(){r.searchValue=""},handleImport({pindouKey:e,pindouName:a}){b.get(`${x()}pindou/${e}.json`).then((r=>{let i=r.data;l.savePindouData({id:e,value:{data:i,label:a}}).then((e=>{if(e){let e=Object.keys(l.pindouMaps).map((e=>({value:e,label:l.pindouMaps[e].label})));t.$utils.cache.pindou.set(JSON.stringify(e)),t.$message.success(t.$t("message.importSucceeded"))}})).catch((e=>{t.$message.error(t.$t("message.importFailed"))}))})).catch((e=>{t.$message.error("下载失败 - "+e)}))},onSortPindouList(){r.previewSearchData.length?r.previewSearchData=$(r.previewSearchData):r.previewData.value.data=$(r.previewData.value.data)},handleCustomPindou(){t.$router.push("/customPindou")}};return h((()=>{s.getData()})),g((()=>{""===r.searchValue.trim()&&(r.searchData=[])})),n(o(n(o(o({},m(r)),s),{Download:f,ArrowDownBold:v}),i),{hexToRgba:w,extractRgbaToString:y,copyText:D})}});const Q={class:"full-layout scrollbar routerview flex-center"},X={class:"full-layout flex flex-column","element-loading-background":"#00000000"},Z={class:"flex-start searchBox"},ee={class:"input-search"},ae={style:{"margin-left":"5px"}},te={key:0,class:"full-layout scrollbar grid-box scrollAuto"},le={class:"frameImg"},re=["src"],ie={class:"info"},se={class:"flex-between",style:{"padding-bottom":"5px"}},oe=["title"],ne={class:"twoline",style:{"font-size":"14px",display:"-webkit-inline-box",color:"#808080"}},de={key:1,class:"full-layout flex-center scrollbar scrollAuto"},ce={class:"flex-start",style:{"margin-bottom":"20px",gap:"20px"}},ue={class:"input-search",style:{width:"100%"}},pe={class:"full-layout",style:{height:"calc(100% - 60px)"}},he={class:"flex-center flex-warp scrollbar scrollY full-h",style:{"column-gap":"15px",padding:"10px"}},ge=["onClick"],me={class:"color-name"},fe={class:"color-meta flex-column-start",style:{gap:"10px"}},ve={style:{"font-size":"15px"}},we={style:{"font-size":"12px"}};var ye=j(H,[["render",function(e,a,t,l,r,i){const s=P("Search"),o=P("el-icon"),n=P("el-pagination"),d=P("el-skeleton-item"),c=P("el-skeleton"),u=P("el-image"),p=P("el-tag"),h=P("el-button"),g=P("el-dropdown-item"),m=P("el-dropdown-menu"),f=P("el-dropdown"),v=P("el-divider"),w=P("el-tooltip"),y=P("el-empty"),D=P("Sort"),b=P("el-drawer"),x=S("loading");return F(),_("div",Q,[O((F(),_("div",X,[z("div",Z,[z("div",ee,[N(o,null,{default:I((()=>[N(s)])),_:1}),O(z("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=a=>e.searchValue=a),placeholder:"请搜索拼豆",onKeyup:a[1]||(a[1]=R(((...a)=>e.search&&e.search(...a)),["enter"]))},null,544),[[E,e.searchValue]])]),K(' <el-select \r\n                v-model="filterValue" placeholder="请选择分类" \r\n                size="large"\r\n                @change="handleFilter"\r\n                class="select"\r\n                collapse-tags\r\n                collapse-tags-tooltip\r\n                :max-collapse-tags="3"\r\n                multiple>\r\n                    <el-option\r\n                        v-for="item in filterOptions"\r\n                        :key="item.value"\r\n                        :label="item.label"\r\n                        :value="item.value"\r\n                    />\r\n                </el-select> '),z("button",{class:"pixelButton",onClick:a[2]||(a[2]=(...a)=>e.handleReset&&e.handleReset(...a))},"重 置"),z("button",{class:"pixelButton",onClick:a[3]||(a[3]=(...a)=>e.handleCustomPindou&&e.handleCustomPindou(...a))},"自定义拼豆"),K(' <el-button type="success" @click="handleCustomPindou">自定义拼豆</el-button> '),z("div",ae,[N(n,{"current-page":e.currentPage,"onUpdate:current-page":a[4]||(a[4]=a=>e.currentPage=a),"page-size":20,background:"",layout:"total, prev, pager, next","hide-on-single-page":!0,total:e.total,onCurrentChange:e.handleCurrentChange},null,8,["current-page","total","onCurrentChange"])])]),!e.list.length&&!e.searchData.length||e.isloading?e.isloading||e.searchData.length&&e.list.length?K("v-if",!0):(F(),_("div",de,[N(y,{image:G,description:"空空如也","image-size":200},null,8,["image"])])):(F(),_("div",te,[(F(!0),_(L,null,T(e.searchData.length?e.searchData:e.list,(a=>(F(),_("div",{key:a.id,class:"download-item"},[z("div",le,[K(' <img :src="getFrameImg(item.data.pindouKey)"/> '),N(u,{src:e.getFrameImg(a.data.pic),fit:"cover",class:"full-layout"},{placeholder:I((()=>[N(c,{animated:"",class:"full-layout"},{template:I((()=>[N(d,{variant:"image",style:{height:"100%"}})])),_:1})])),_:2},1032,["src"]),a.data.isTop?(F(),_("img",{key:0,src:q,class:"top"},null,8,re)):K("v-if",!0),""!==a.data.tip?(F(),U(p,{key:1,type:"success",class:"size",effect:"dark"},{default:I((()=>[B(M(a.data.tip),1)])),_:2},1024)):K("v-if",!0)]),z("div",ie,[z("div",se,[z("h4",{class:"oneline project-name",title:a.data.pindouName+a.data.pindouKey.toUpperCase()},M(a.data.pindouName),9,oe),N(f,{trigger:"click",size:"small"},{dropdown:I((()=>[N(m,null,{default:I((()=>[K(' <el-dropdown-item @click="handleDownload(item.data)" icon="Download">{{ $t(\'message.download\')}}</el-dropdown-item> '),N(g,{onClick:t=>e.handleImport(a.data),icon:"Upload"},{default:I((()=>[B(M(e.$t("message.import")),1)])),_:2},1032,["onClick"]),N(g,{onClick:t=>e.handlePreview(a.data),icon:"View"},{default:I((()=>[B(M(e.$t("message.preview")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),default:I((()=>[N(h,{type:"primary",icon:e.ArrowDownBold,size:"small",style:{"margin-left":"5px"}},null,8,["icon"])])),_:2},1024)]),N(v,{"border-style":"dashed","content-position":"left",style:{margin:"5px 0"}},{default:I((()=>[B(M(a.data.createAt),1)])),_:2},1024),N(w,{content:a.data.desc,effect:"light"},{default:I((()=>[z("div",ne,[K(" {{ item.desc !== '' ? $t(`message.${item.desc}`) : $t(`message.None`) }} "),B(M(a.data.desc),1)])])),_:2},1032,["content"])])])))),128))])),e.previewData?(F(),U(b,{key:2,modelValue:e.previewLoading,"onUpdate:modelValue":a[7]||(a[7]=a=>e.previewLoading=a),title:`${e.previewData.value.label} - 色号预览（${e.previewData.value.data.length}色）`,direction:"rtl",size:"60%",onClose:a[8]||(a[8]=a=>{e.previewLoading=!1,e.previewData=null,e.searchColorValue=""})},{default:I((()=>[z("div",ce,[z("div",ue,[N(o,null,{default:I((()=>[N(s)])),_:1}),O(z("input",{type:"text","onUpdate:modelValue":a[5]||(a[5]=a=>e.searchColorValue=a),placeholder:"请搜索色号",onKeyup:a[6]||(a[6]=R(((...a)=>e.handleSearchColor&&e.handleSearchColor(...a)),["enter"]))},null,544),[[E,e.searchColorValue]])]),N(o,{style:{"margin-right":"15px"},class:"pointer",size:"16",onClick:e.onSortPindouList},{default:I((()=>[N(D)])),_:1},8,["onClick"])]),z("div",pe,[z("ul",he,[(F(!0),_(L,null,T(e.previewSearchData.length?e.previewSearchData:e.previewData.value.data,(a=>(F(),_("li",{key:a.name,class:"color-item",onClick:t=>e.copyText(`#${a.color}`)},[z("div",{style:J({backgroundColor:`#${a.color}`}),class:"color-preview"},[z("div",me,M(a.name),1)],4),z("div",fe,[z("span",ve,M(`#${a.color}`.toUpperCase()),1),z("span",we,M(e.extractRgbaToString(e.hexToRgba(a.color))),1)])],8,ge)))),128))])])])),_:1},8,["modelValue","title"])):K("v-if",!0)])),[[x,e.isloading]]),(F(),U(A,{to:"body"},[K(' <CustomPindouDialog ref="CustomPindouDialog"></CustomPindouDialog> ')]))])}],["__scopeId","data-v-6979ca1c"],["__file","D:/project/pixel-grid/src/views/pindou/index.vue"]]);export{ye as default};
