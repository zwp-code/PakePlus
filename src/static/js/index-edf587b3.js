var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(l,t,o)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[t]=o,s=(e,l)=>{for(var t in l||(l={}))a.call(l,t)&&n(e,t,l[t]);if(o)for(var t of o(l))i.call(l,t)&&n(e,t,l[t]);return e},d=(e,o)=>l(e,t(o));import{_ as r,d as u,A as c,B as p,r as g,N as f,t as m,b as h,f as b,h as x,au as w,ay as y,aO as v,aP as V,e as T,j as L,n as P,z as C,v as S,l as R,F as k,k as U,g as _,x as j,y as $,a2 as G,O as H,s as z,q as D,P as E,p as I,o as F,aI as A}from"./index-6a0d579b.js";import{W as O}from"./worker-cecf3bdf.js";import{p as W}from"./pro-f2363fe4.js";import{u as B}from"./useWindow-cd5ccb2a.js";const M=u({name:"PixelDrawDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close","import"],setup(e,l){const t=c(),{proxy:o}=_(),a=p();let i=g({loading:!1,dialogVisible:e.visible,mode:"NORMAL",fileList:[],fileListTemp:[],fileTypes:["image/jpg","image/jpeg","image/png"],targetSize:0,pxSize:1,gdSize:0,pxType:1,poster:"",transformPoster:"",scrollHeight:0,isLoad:!1,gdColor:"#808080",aiImageResults:[],compressSize:.8}),n={handleChangeAI(){if(t.checkVipFunction("AIPixelDraw"))return i.mode="NORMAL"},handleChangeTargetSize(){i.aiImageResults&&i.aiImageResults.length&&(i.transformPoster="data:image/png;base64,"+i.aiImageResults[i.targetSize].image)},handleExceed(e,l){a.value.clearFiles();const t=e[0];t.uid=w(),a.value.handleStart(t)},handleClose(){i.dialogVisible=!1,l.emit("close")},handleAIChangeImage(e){let l={image:e.split(",")[1]};o.$http.AIPixelDraw(l).then((e=>{var l;i.loading=!1;let t=e.data.content;(null==t?void 0:t.data)&&(null==(l=null==t?void 0:t.data)?void 0:l.images)&&(i.aiImageResults=t.data.images||[],i.transformPoster="data:image/png;base64,"+i.aiImageResults[i.targetSize].image,o.$message.success("转换完成"),y((()=>{let e=o.$refs.scroll;e&&(i.scrollHeight=e.scrollHeight,e.scrollTop=i.scrollHeight)})))})).catch((e=>{i.loading=!1}))},handleConfirm(){if(!i.fileList.length)return o.$message.warning("上传文件不能为空");i.loading=!0;const e=new Image,l=URL.createObjectURL(i.fileList[0].raw);e.src=l,e.onload=function(){const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const a=t.getContext("2d");if(a.drawImage(e,0,0),"AI"===i.mode)return e.width>1024||e.height>1024?(i.loading=!1,o.$message.warning("图片分辨率必须小于1024")):void n.handleAIChangeImage(t.toDataURL("image/jpeg",i.compressSize));const s=a.getImageData(0,0,t.width,t.height).data,d=new O;d.postMessage({type:12,variables:s,pxSize:i.pxSize,options:{width:e.width,height:e.height}}),d.onmessage=e=>{URL.revokeObjectURL(l);const s=e.data;i.transformPoster=n.handleDrawImage(t,a,s),i.loading=!1,i.transformPoster&&(o.$message.success("转换完成"),y((()=>{let e=o.$refs.scroll;e&&(i.scrollHeight=e.scrollHeight,e.scrollTop=i.scrollHeight)})))}}},handleDrawImage(e,l,t){if(l.clearRect(0,0,e.width,e.height),1===i.pxType)for(let o=0;o<t.length;o++){let e=t[o][0]*i.pxSize,a=t[o][1]*i.pxSize;l.fillStyle=t[o][2],l.fillRect(e,a,i.pxSize,i.pxSize)}else if(2===i.pxType){let e=i.pxSize/2-.5;for(let o=0;o<t.length;o++){let a=t[o][0]*i.pxSize+e,n=t[o][1]*i.pxSize+e;l.fillStyle=t[o][2],l.beginPath(),l.arc(a+.5,n+.5,e,0,2*Math.PI),l.closePath(),l.fill()}}else if(3===i.pxType){let e=10,o=i.pxSize,a=i.pxSize;for(let n=0;n<t.length;n++){let s=t[n][0]*i.pxSize,d=t[n][1]*i.pxSize;l.fillStyle=t[n][2],l.beginPath(),l.moveTo(s+e,d),l.lineTo(s+o-e,d),l.arcTo(s+o,d,s+o,d+e,e),l.lineTo(s+o,d+a-e),l.arcTo(s+o,d+a,s+o-e,d+a,e),l.lineTo(s+e,d+a),l.arcTo(s,d+a,s,d+a-e,e),l.lineTo(s,d+e),l.arcTo(s,d,s+e,d,e),l.closePath(),l.fill()}}if(i.gdSize>0){if(i.gdSize>=i.pxSize)return o.$message.warning("网格尺寸应小于像素尺寸"),null;let t=Math.floor(e.width/i.pxSize),a=Math.floor(e.height/i.pxSize);l.strokeStyle=i.gdColor,l.lineWidth=i.gdSize,l.beginPath();for(let e=0;e<=a;e++)l.moveTo(0,e*i.pxSize),l.lineTo(i.pxSize*t,e*i.pxSize);for(let e=0;e<=t;e++)l.moveTo(e*i.pxSize,0),l.lineTo(e*i.pxSize,a*i.pxSize);l.stroke()}return e.toDataURL("image/png")},handleChange(e,l){if(i.fileList=l,i.fileTypes.includes(e.raw.type))i.poster=URL.createObjectURL(e.raw);else{let l=i.fileList.findIndex((l=>l.uid===e.uid));i.fileList.splice(l,1),o.$message.warning("导入文件格式不正确")}},handleDownload(){v(i.transformPoster,"像素画 - "+V(i.fileList[0].name))}};return f((()=>{URL.revokeObjectURL(i.poster)})),d(s(s({},m(i)),n),{uploadRef:a})}}),N=e=>(j("data-v-9da8bcf2"),e=e(),$(),e),X={class:"content scrollbar",ref:"scroll"},Y=N((()=>L("div",{class:"el-upload__text"},[C(" 拖拽文件到这 或者 "),L("em",null,"点击这里上传")],-1))),q={key:1,class:"poster flex-center"},J=["src"],K=N((()=>L("div",{class:"el-upload__tip"}," 支持上传 .png/jpg 文件 ",-1))),Z={style:{"margin-bottom":"10px",gap:"10px"},class:"flex-column-center"},Q={class:"flex-between full-w"},ee={style:{width:"100px",gap:"10px"},class:"flex-start"},le=C(" AI转换 "),te=["src"],oe={class:"flex-between full-w"},ae=N((()=>L("p",{style:{width:"100px"}},"图片压缩",-1))),ie={class:"flex-between full-w"},ne=N((()=>L("p",{style:{width:"100px"}},"目标尺寸",-1))),se={class:"flex-between full-w"},de=N((()=>L("p",{style:{width:"100px"}},"像素尺寸",-1))),re={class:"flex-between full-w"},ue=N((()=>L("p",{style:{width:"100px"}},"网格尺寸",-1))),ce={class:"flex-between full-w"},pe=N((()=>L("p",{style:{width:"100px"}},"网格颜色",-1))),ge={class:"flex-between full-w"},fe=N((()=>L("p",{style:{width:"100px"}},"像素类型",-1))),me=C("方形"),he=C("圆形"),be={key:2,class:"flex-column-start full-w",style:{gap:"5px"}},xe={class:"flex-between full-w"},we=C(" 预 览 "),ye=C("下 载"),ve={class:"poster flex-center"},Ve=["src"],Te={class:"dialog-footer"},Le=C("转 换");var Pe,Ce=r(M,[["render",function(e,l,t,o,a,i){const n=h("upload-filled"),s=h("el-icon"),d=h("el-upload"),r=h("el-switch"),u=h("el-slider"),c=h("el-option"),p=h("el-select"),g=h("el-color-picker"),f=h("el-radio"),m=h("el-radio-group"),w=h("el-button"),y=h("el-dialog");return T(),b(y,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=l=>e.dialogVisible=l),title:"像素画转换","before-close":e.handleClose,"close-on-click-modal":!1,"lock-scroll":!1,class:"z-dialog",center:"",width:400},{footer:x((()=>[L("span",Te,[P(w,{onClick:e.handleClose},{default:x((()=>[C(S(e.$t("message.cancel")),1)])),_:1},8,["onClick"]),P(w,{type:"primary",onClick:e.handleConfirm,loading:e.loading},{default:x((()=>[Le])),_:1},8,["onClick","loading"])])])),default:x((()=>[L("div",X,[P(d,{ref:"uploadRef",class:"flex-column-center","show-file-list":!1,drag:"",limit:1,"auto-upload":!1,accept:".png,.jpg,.jpeg","on-change":e.handleChange,"on-exceed":e.handleExceed,"file-list":e.fileList,"onUpdate:file-list":l[0]||(l[0]=l=>e.fileList=l)},{tip:x((()=>[K])),default:x((()=>[""===e.poster?(T(),R(k,{key:0},[P(s,{class:"el-icon--upload"},{default:x((()=>[P(n)])),_:1}),Y],64)):(T(),R("div",q,[L("img",{src:e.poster,style:{"object-fit":"contain"},draggable:"false",class:"image-pixelated"},null,8,J)]))])),_:1},8,["on-change","on-exceed","file-list"]),L("div",Z,[L("div",Q,[L("p",ee,[le,L("img",{style:{width:"20px"},src:W},null,8,te)]),P(r,{modelValue:e.mode,"onUpdate:modelValue":l[1]||(l[1]=l=>e.mode=l),"active-value":"AI","inactive-value":"NORMAL",onChange:e.handleChangeAI},null,8,["modelValue","onChange"])]),"AI"===e.mode?(T(),R(k,{key:0},[L("div",oe,[ae,P(u,{modelValue:e.compressSize,"onUpdate:modelValue":l[2]||(l[2]=l=>e.compressSize=l),min:.1,max:1,"show-input":"",step:.1},null,8,["modelValue","min","step"])]),L("div",ie,[ne,P(p,{modelValue:e.targetSize,"onUpdate:modelValue":l[3]||(l[3]=l=>e.targetSize=l),placeholder:"请选择目标尺寸",onChange:e.handleChangeTargetSize},{default:x((()=>[P(c,{label:"32x32",value:3}),P(c,{label:"48x48",value:2}),P(c,{label:"64x64",value:1}),P(c,{label:"128x128",value:0})])),_:1},8,["modelValue","onChange"])])],64)):(T(),R(k,{key:1},[L("div",se,[de,P(u,{modelValue:e.pxSize,"onUpdate:modelValue":l[4]||(l[4]=l=>e.pxSize=l),"show-input":"",min:0,max:100},null,8,["modelValue"])]),L("div",re,[ue,P(u,{modelValue:e.gdSize,"onUpdate:modelValue":l[5]||(l[5]=l=>e.gdSize=l),"show-input":"",min:0,max:20},null,8,["modelValue"])]),L("div",ce,[pe,P(g,{modelValue:e.gdColor,"onUpdate:modelValue":l[6]||(l[6]=l=>e.gdColor=l)},null,8,["modelValue"])]),L("div",ge,[fe,P(m,{modelValue:e.pxType,"onUpdate:modelValue":l[7]||(l[7]=l=>e.pxType=l)},{default:x((()=>[P(f,{value:1},{default:x((()=>[me])),_:1}),P(f,{value:2},{default:x((()=>[he])),_:1})])),_:1},8,["modelValue"])])],64)),e.transformPoster?(T(),R("div",be,[L("p",xe,[we,P(w,{type:"success",text:"",onClick:e.handleDownload},{default:x((()=>[ye])),_:1},8,["onClick"])]),L("div",ve,[L("img",{src:e.transformPoster,style:{"object-fit":"contain"},draggable:"false",class:"image-pixelated"},null,8,Ve)])])):U("v-if",!0)])],512)])),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-9da8bcf2"],["__file","D:/project/pixel-grid/src/components/dialog/tools/PixelDrawDialog.vue"]]),Se={exports:{}};Pe=Se,function(e){var l=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:l,mimeType:function(e){var t,o,a=l(e).toLowerCase();return(t="application/font-woff",o="image/jpeg",{woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:o,jpeg:o,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[a]||""},dataAsUrl:function(e,l){return"data:"+l+";base64,"+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise((function(l){e.toBlob(l)})):function(e){return new Promise((function(l){for(var t=window.atob(e.toDataURL().split(",")[1]),o=t.length,a=new Uint8Array(o),i=0;i<o;i++)a[i]=t.charCodeAt(i);l(new Blob([a],{type:"image/png"}))}))}(e)},resolveUrl:function(e,l){var t=document.implementation.createHTMLDocument(),o=t.createElement("base");t.head.appendChild(o);var a=t.createElement("a");return t.body.appendChild(a),o.href=l,a.href=e,a.href},getAndEncode:function(e){var l=3e4;return s.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime()),new Promise((function(t){var o,a=new XMLHttpRequest;if(a.onreadystatechange=n,a.ontimeout=d,a.responseType="blob",a.timeout=l,a.open("GET",e,!0),a.send(),s.impl.options.imagePlaceholder){var i=s.impl.options.imagePlaceholder.split(/,/);i&&i[1]&&(o=i[1])}function n(){if(4===a.readyState)if(200===a.status){var l=new FileReader;l.onloadend=function(){var e=l.result.split(/,/)[1];t(e)},l.readAsDataURL(a.response)}else o?t(o):r("cannot fetch resource: "+e+", status: "+a.status)}function d(){o?t(o):r("timeout of "+l+"ms occured while fetching resource: "+e)}function r(e){t("")}}))},uid:(e=0,function(){return"u"+l()+e++;function l(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}),delay:function(e){return function(l){return new Promise((function(t){setTimeout((function(){t(l)}),e)}))}},asArray:function(e){for(var l=[],t=e.length,o=0;o<t;o++)l.push(e[o]);return l},escapeXhtml:function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(e){return new Promise((function(l,t){var o=new Image;o.onload=function(){l(o)},o.onerror=t,o.src=e}))},width:function(e){var l=t(e,"border-left-width"),o=t(e,"border-right-width");return e.scrollWidth+l+o},height:function(e){var l=t(e,"border-top-width"),o=t(e,"border-bottom-width");return e.scrollHeight+l+o}};var e;function l(e){var l=/\.([^\.\/]*?)$/g.exec(e);return l?l[1]:""}function t(e,l){var t=window.getComputedStyle(e).getPropertyValue(l);return parseFloat(t.replace("px",""))}}(),t=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,l,i){return n()?Promise.resolve(e):Promise.resolve(e).then(o).then((function(t){var o=Promise.resolve(e);return t.forEach((function(e){o=o.then((function(t){return a(t,e,l,i)}))})),o}));function n(){return!t(e)}},shouldProcess:t,impl:{readUrls:o,inline:a}};function t(l){return-1!==l.search(e)}function o(t){for(var o,a=[];null!==(o=e.exec(t));)a.push(o[1]);return a.filter((function(e){return!l.isDataUrl(e)}))}function a(e,t,o,a){return Promise.resolve(t).then((function(e){return o?l.resolveUrl(e,o):e})).then(a||l.getAndEncode).then((function(e){return l.dataAsUrl(e,l.mimeType(t))})).then((function(o){return e.replace((a=t,new RegExp("(url\\(['\"]?)("+l.escape(a)+")(['\"]?\\))","g")),"$1"+o+"$3");var a}))}}(),o=function(){return{resolveAll:function(){return e().then((function(e){return Promise.all(e.map((function(e){return e.resolve()})))})).then((function(e){return e.join("\n")}))},impl:{readAll:e}};function e(){return Promise.resolve(l.asArray(document.styleSheets)).then((function(e){var t=[];return e.forEach((function(e){try{l.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(o){}})),t})).then((function(e){return e.filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).filter((function(e){return t.shouldProcess(e.style.getPropertyValue("src"))}))})).then((function(l){return l.map(e)}));function e(e){return{resolve:function(){var l=(e.parentStyleSheet||{}).href;return t.inlineAll(e.cssText,l)},src:function(){return e.style.getPropertyValue("src")}}}}}(),a=function(){return{inlineAll:function o(a){return a instanceof Element?i(a).then((function(){return a instanceof HTMLImageElement?e(a).inline():Promise.all(l.asArray(a.childNodes).map((function(e){return o(e)})))})):Promise.resolve(a);function i(e){var l=e.style.getPropertyValue("background");return l?t.inlineAll(l).then((function(l){e.style.setProperty("background",l,e.style.getPropertyPriority("background"))})).then((function(){return e})):Promise.resolve(e)}},impl:{newImage:e}};function e(e){return{inline:function(t){return l.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||l.getAndEncode).then((function(t){return l.dataAsUrl(t,l.mimeType(e.src))})).then((function(l){return new Promise((function(t,o){e.onload=t,e.onerror=o,e.src=l}))}))}}}}(),i=void 0,n=!1,s={toSvg:d,toPng:function(e,l){return r(e,l||{}).then((function(e){return e.toDataURL()}))},toJpeg:function(e,l){return r(e,l=l||{}).then((function(e){return e.toDataURL("image/jpeg",l.quality||1)}))},toBlob:function(e,t){return r(e,t||{}).then(l.canvasToBlob)},toPixelData:function(e,t){return r(e,t||{}).then((function(t){return t.getContext("2d").getImageData(0,0,l.width(e),l.height(e)).data}))},impl:{fontFaces:o,images:a,util:l,inliner:t,options:{}}};function d(e,t){return function(e){void 0===e.imagePlaceholder?s.impl.options.imagePlaceholder=i:s.impl.options.imagePlaceholder=e.imagePlaceholder,void 0===e.cacheBust?s.impl.options.cacheBust=n:s.impl.options.cacheBust=e.cacheBust}(t=t||{}),Promise.resolve(e).then((function(e){return u(e,t.filter,!0)})).then(c).then(p).then((function(e){return t.bgcolor&&(e.style.backgroundColor=t.bgcolor),t.width&&(e.style.width=t.width+"px"),t.height&&(e.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach((function(l){e.style[l]=t.style[l]})),e})).then((function(o){return function(e,t,o){return Promise.resolve(e).then((function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)})).then(l.escapeXhtml).then((function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"})).then((function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+o+'">'+e+"</svg>"})).then((function(e){return"data:image/svg+xml;charset=utf-8,"+e}))}(o,t.width||l.width(e),t.height||l.height(e))}))}function r(e,t){return d(e,t).then(l.makeImage).then(l.delay(100)).then((function(o){var a=function(e){var o=document.createElement("canvas");if(o.width=t.width||l.width(e),o.height=t.height||l.height(e),t.bgcolor){var a=o.getContext("2d");a.fillStyle=t.bgcolor,a.fillRect(0,0,o.width,o.height)}return o}(e);return a.getContext("2d").drawImage(o,0,0),a}))}function u(e,t,o){return o||!t||t(e)?Promise.resolve(e).then((function(e){return e instanceof HTMLCanvasElement?l.makeImage(e.toDataURL()):e.cloneNode(!1)})).then((function(o){return function(e,t,o){var a=e.childNodes;return 0===a.length?Promise.resolve(t):i(t,l.asArray(a),o).then((function(){return t}));function i(e,l,t){var o=Promise.resolve();return l.forEach((function(l){o=o.then((function(){return u(l,t)})).then((function(l){l&&e.appendChild(l)}))})),o}}(e,o,t)})).then((function(t){return function(e,t){return t instanceof Element?Promise.resolve().then(o).then(a).then(i).then(n).then((function(){return t})):t;function o(){function o(e,t){function o(e,t){l.asArray(e).forEach((function(l){t.setProperty(l,e.getPropertyValue(l),e.getPropertyPriority(l))}))}e.cssText?t.cssText=e.cssText:o(e,t)}o(window.getComputedStyle(e),t.style)}function a(){function o(o){var a=window.getComputedStyle(e,o),i=a.getPropertyValue("content");if(""!==i&&"none"!==i){var n=l.uid();t.className=t.className+" "+n;var s=document.createElement("style");s.appendChild(d(n,o,a)),t.appendChild(s)}function d(e,t,o){var a="."+e+":"+t,i=o.cssText?n(o):s(o);return document.createTextNode(a+"{"+i+"}");function n(e){var l=e.getPropertyValue("content");return e.cssText+" content: "+l+";"}function s(e){return l.asArray(e).map(t).join("; ")+";";function t(l){return l+": "+e.getPropertyValue(l)+(e.getPropertyPriority(l)?" !important":"")}}}}[":before",":after"].forEach((function(e){o(e)}))}function i(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}function n(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach((function(e){var l=t.getAttribute(e);l&&t.style.setProperty(e,l)})))}}(e,t)})):Promise.resolve()}function c(e){return o.resolveAll().then((function(l){var t=document.createElement("style");return e.appendChild(t),t.appendChild(document.createTextNode(l)),e}))}function p(e){return a.inlineAll(e).then((function(){return e}))}Pe.exports=s}();var Re=Se.exports;const ke=u({name:"HalfFrameDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close","import"],setup(e,l){const{proxy:t}=_(),o=p();let a=g({loading:!1,dialogVisible:e.visible,fileList:[],fileListTemp:[],fileTypes:["image/jpg","image/jpeg","image/png"],fgStyle:{top:"50%",borderRadius:10,boxShadow:"1px 1px 10px",boxShadowColor:"#80808050"},bgRatioList:[[1440,2560,270,480],[2560,1440,480,270],[1600,1200,400,300]],fgWidth:90,fgHeight:40,bgBlur:10,bgRatio:0,fgPos:30,fgRadius:20,fgShadow:0,fgShadowColor:"#000000",fgPoster:"",bgPoster:"",poster:"",transformPoster:"",scrollHeight:0,isLoad:!1}),i={handleExceed(e,l){o.value.clearFiles();const t=e[0];t.uid=w(),o.value.handleStart(t)},handleClose(){a.dialogVisible=!1,l.emit("close")},handleConfirm(){if(!a.fileList.length)return t.$message.warning("上传文件不能为空");a.loading=!0,setTimeout((()=>{const e=document.getElementById("poster");e.style.width=a.bgRatioList[a.bgRatio][0]+"px",e.style.height=a.bgRatioList[a.bgRatio][1]+"px",Re.toPng(e).then((function(e){const l=new Image;l.src=e,l.onload=function(){const e=document.createElement("canvas");e.width=a.bgRatioList[a.bgRatio][0],e.height=a.bgRatioList[a.bgRatio][1];e.getContext("2d").drawImage(l,0,0),v(e.toDataURL("image/png"),`半框 - ${V(a.fileList[0].name)}`),URL.revokeObjectURL(a.bgPoster),URL.revokeObjectURL(a.fgPoster),a.bgPoster="",a.fgPoster="",a.loading=!1}})).catch((e=>{URL.revokeObjectURL(a.bgPoster),URL.revokeObjectURL(a.fgPoster),a.bgPoster="",a.fgPoster="",a.loading=!1,t.$message.error("保存失败")}))}),200)},handleDrawImage:(e,l,t)=>(l.clearRect(0,0,e.width,e.height),e.toDataURL("image/png")),handleChange(e,l){if(a.fileList=l,a.fileTypes.includes(e.raw.type))a.bgPoster=URL.createObjectURL(e.raw),a.fgPoster=URL.createObjectURL(e.raw);else{let l=a.fileList.findIndex((l=>l.uid===e.uid));a.fileList.splice(l,1),t.$message.warning("导入文件格式不正确")}},handleDownload(){v(a.transformPoster,"半框 - "+V(a.fileList[0].name))}};return f((()=>{URL.revokeObjectURL(a.bgPoster),URL.revokeObjectURL(a.fgPoster)})),d(s(s({},m(a)),i),{uploadRef:o})}}),Ue=e=>(j("data-v-f48da4d2"),e=e(),$(),e),_e={class:"content scrollbar",ref:"scroll","element-loading-text":"正在保存图片...","element-loading-background":"var(--el-bg-color)"},je=Ue((()=>L("div",{class:"el-upload__text"},[C(" 拖拽文件到这 或者 "),L("em",null,"点击这里上传")],-1))),$e=["src"],Ge=["src"],He=Ue((()=>L("div",{class:"el-upload__tip"}," 支持上传 .png/jpg 文件 ",-1))),ze={class:"fun-box scrollY scrollbar full-h full-w"},De={class:"flex-column-center fun-list"},Ee={class:"flex-between full-w"},Ie=Ue((()=>L("p",{style:{width:"100px"}},"模 糊",-1))),Fe={class:"flex-between full-w"},Ae=Ue((()=>L("p",{style:{width:"100px"}},"宽 度",-1))),Oe={class:"flex-between full-w"},We=Ue((()=>L("p",{style:{width:"100px"}},"高 度",-1))),Be={class:"flex-between full-w"},Me=Ue((()=>L("p",{style:{width:"100px"}},"位 置",-1))),Ne={class:"flex-between full-w"},Xe=Ue((()=>L("p",{style:{width:"100px"}},"圆 角",-1))),Ye={class:"flex-between full-w",style:{gap:"20px"}},qe=Ue((()=>L("p",{style:{width:"100px"}},"阴 影",-1))),Je={class:"flex-between full-w"},Ke=Ue((()=>L("p",{style:{width:"100px"}},"分辨率",-1))),Ze=C("手机"),Qe=C("电脑"),el=C("平板"),ll={class:"dialog-footer"},tl=C("保 存");var ol=r(ke,[["render",function(e,l,t,o,a,i){const n=h("upload-filled"),s=h("el-icon"),d=h("el-upload"),r=h("el-slider"),u=h("el-color-picker"),c=h("el-radio"),p=h("el-radio-group"),g=h("el-button"),f=h("el-dialog"),m=G("loading");return T(),b(f,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[9]||(l[9]=l=>e.dialogVisible=l),title:"半 框","before-close":e.handleClose,"close-on-click-modal":!1,"lock-scroll":!1,top:"10vh",class:"z-dialog",center:"",width:1e3},{footer:x((()=>[L("span",ll,[P(g,{onClick:e.handleClose},{default:x((()=>[C(S(e.$t("message.cancel")),1)])),_:1},8,["onClick"]),P(g,{type:"primary",onClick:e.handleConfirm,loading:e.loading},{default:x((()=>[tl])),_:1},8,["onClick","loading"])])])),default:x((()=>[H((T(),R("div",_e,[P(d,{ref:"uploadRef",class:"flex-column-center","show-file-list":!1,drag:"",limit:1,"auto-upload":!1,accept:".png,.jpg,.jpeg","on-change":e.handleChange,"on-exceed":e.handleExceed,"file-list":e.fileList,"onUpdate:file-list":l[0]||(l[0]=l=>e.fileList=l)},{tip:x((()=>[He])),default:x((()=>[""===e.bgPoster?(T(),R(k,{key:0},[P(s,{class:"el-icon--upload"},{default:x((()=>[P(n)])),_:1}),je],64)):(T(),R("div",{key:1,id:"poster",class:"poster flex-center",style:z({width:`${e.bgRatioList[e.bgRatio][2]}px`,height:`${e.bgRatioList[e.bgRatio][3]}px`,position:"relative",top:"0"})},[L("img",{src:e.bgPoster,style:z([{"object-fit":"cover"},{filter:`blur(${e.bgBlur}px)`,transform:"scale(1.2)"}]),draggable:"false"},null,12,$e),L("img",{src:e.fgPoster,class:"fg",style:z([{top:`${e.fgPos}%`,borderRadius:`${e.fgRadius}px`,boxShadow:`0px 0px ${e.fgShadow}px ${e.fgShadowColor}`,height:`${e.fgHeight}%`,width:`${e.fgWidth}%`},{"object-fit":"cover"}]),draggable:"false"},null,12,Ge)],4))])),_:1},8,["on-change","on-exceed","file-list"]),L("div",ze,[L("div",De,[L("div",Ee,[Ie,P(r,{modelValue:e.bgBlur,"onUpdate:modelValue":l[1]||(l[1]=l=>e.bgBlur=l),"show-input":"",min:0,max:30},null,8,["modelValue"])]),L("div",Fe,[Ae,P(r,{modelValue:e.fgWidth,"onUpdate:modelValue":l[2]||(l[2]=l=>e.fgWidth=l),"show-input":"",min:10,max:90},null,8,["modelValue"])]),L("div",Oe,[We,P(r,{modelValue:e.fgHeight,"onUpdate:modelValue":l[3]||(l[3]=l=>e.fgHeight=l),"show-input":"",min:10,max:90},null,8,["modelValue"])]),L("div",Be,[Me,P(r,{modelValue:e.fgPos,"onUpdate:modelValue":l[4]||(l[4]=l=>e.fgPos=l),"show-input":"",min:0,max:100},null,8,["modelValue"])]),L("div",Ne,[Xe,P(r,{modelValue:e.fgRadius,"onUpdate:modelValue":l[5]||(l[5]=l=>e.fgRadius=l),"show-input":"",min:0,max:100},null,8,["modelValue"])]),L("div",Ye,[qe,P(r,{modelValue:e.fgShadow,"onUpdate:modelValue":l[6]||(l[6]=l=>e.fgShadow=l),min:0,max:10},null,8,["modelValue"]),P(u,{modelValue:e.fgShadowColor,"onUpdate:modelValue":l[7]||(l[7]=l=>e.fgShadowColor=l),"show-alpha":""},null,8,["modelValue"])]),L("div",Je,[Ke,P(p,{modelValue:e.bgRatio,"onUpdate:modelValue":l[8]||(l[8]=l=>e.bgRatio=l)},{default:x((()=>[P(c,{value:0},{default:x((()=>[Ze])),_:1}),P(c,{value:1},{default:x((()=>[Qe])),_:1}),P(c,{value:2},{default:x((()=>[el])),_:1})])),_:1},8,["modelValue"])]),U(' <div class="flex-column-start full-w" style="gap:5px" v-if="transformPoster">\r\n                        <p class="flex-between full-w">\r\n                            预 览\r\n                            <el-button type="success" text @click="handleDownload">下 载</el-button>\r\n                        </p>\r\n                        <div class="poster flex-center">\r\n                            <img :src="transformPoster" style="object-fit: contain;" draggable="false">\r\n                        </div>\r\n                    </div> ')])])])),[[m,e.loading]])])),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-f48da4d2"],["__file","D:/project/pixel-grid/src/components/dialog/tools/HalfFrameDialog.vue"]]);const al=u({name:"BorderDrawDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close","import"],setup(e,l){const{proxy:t}=_(),o=p(),a=c();let i=g({loading:!1,dialogVisible:e.visible,fileList:[],fileListTemp:[],fileTypes:["image/jpg","image/jpeg","image/png"],fgStyle:{top:"50%",borderRadius:10,boxShadow:"1px 1px 10px",boxShadowColor:"#80808050"},bdTemplate:"0",fontFamilyOptions:[{label:"像素字体",value:"PixelFont"},{label:"方正黑体",value:"Founder Heiti"},{label:"宋体",value:"SimSun"},{label:"方正楷体",value:"SimKai"},{label:"阿里巴巴普惠体",value:"AlibabaPuHuiTi-Black"},{label:"辰宇落雁体",value:"ChenYuluoyan"},{label:"钟齐志莽行书",value:"ZhiMangXing"},{label:"Autumn Flowers",value:"AutumnFlowers"}],bgRatioList:[[1440,2560,270,480],[2560,1440,480,270],[1600,1200,400,300]],fgWidth:90,fgHeight:40,bgBlur:10,bdType:0,bdColor:"#ffffff",bdTextColor:"#000000",bdTextSecondColor:"#000000",bdText:"像素格子",bdTextSize:16,bdTextPos:[50,50],bdTextFamily:"PixelFont",isEnableTextGradient:!1,bdLogo:"/logo.png",logoSize:1,bdTextWeight:400,bdTextStyle:"normal",bdHeight:10,bdLogoGap:5,bdGap:1,bdTextRotate:-22,bdTextWidth:120,bdTextHeight:64,bdTextGaps:[90,90],bdTextFont:{fontSize:16,color:"rgba(0, 0, 0, 0.15)",fontWeight:400,fontFamily:"PixelFont",fontStyle:"normal"},isEnableLogo:!1,isVerticalLogo:!1,fgPos:30,fgRadius:20,fgShadow:0,fgShadowColor:"#000000",fgPoster:"",bgPoster:"",poster:"",transformPoster:"",scrollHeight:0,isLoad:!1,realPicHeight:0,realPicWidth:0,renderPicWidth:0,renderPicHeight:0,bdRenderHeight:0,bdRealHeight:0,bdRenderGap:0,bdRealGap:0}),n={handleChangeTemplate(e){"0"===e?(i.bdColor="#ffffff",i.isEnableTextGradient=!1,i.bdTextColor="#000000",i.bdTextSecondColor="#000000",i.isEnableLogo=!0,i.bdLogo="/logo.png",i.bdText="像素格子",i.bdTextFamily="PixelFont"):"1"===e&&(i.bdColor="#B81E19",i.isEnableTextGradient=!0,i.bdTextColor="rgba(223, 206, 132, 1)",i.bdTextSecondColor="#c1a940",i.isEnableLogo=!0,i.bdLogo="/bdLogo/blessing.png",i.bdText="事业有成 阖家欢乐",i.bdTextFamily="AlibabaPuHuiTi-Black")},handleBorderSize(){let e=Math.max(i.renderPicHeight,i.renderPicWidth)*(i.bdHeight/100),l=Math.max(i.realPicHeight,i.realPicWidth)*(i.bdHeight/100);i.bdRenderHeight=Math.floor(e),i.bdRealHeight=Math.floor(l)},handleBorderGap(){i.bdGap>i.bdHeight&&(i.bdGap=i.bdHeight,t.$message.warning("间距不能大于边框大小"));let e=Math.max(i.renderPicHeight,i.renderPicWidth)*(i.bdGap/100),l=Math.max(i.realPicHeight,i.realPicWidth)*(i.bdGap/100);i.bdRenderGap=Math.floor(e),i.bdRealGap=Math.floor(l)},handleLoad(e){const l=document.querySelector(".fg");i.renderPicWidth=l.offsetWidth,i.renderPicHeight=l.offsetHeight,n.handleBorderSize(),1===i.bdType&&n.handleBorderGap()},handleUploadLogo(){if(a.checkVipFunction("borderMarkCustomLogo"))return;const e=document.createElement("input");e.type="file",e.accept="image/png,image/jpeg",e.addEventListener("change",(function(){const l=e.files[0];if(l){const e=new FileReader;e.onload=function(e){i.bdLogo=e.target.result},e.readAsDataURL(l)}})),document.body.appendChild(e),e.click(),document.body.removeChild(e)},handleExceed(e,l){o.value.clearFiles();const t=e[0];t.uid=w(),o.value.handleStart(t)},handleClose(){i.dialogVisible=!1,l.emit("close")},handleConfirm(){if(!i.fileList.length)return t.$message.warning("上传文件不能为空");i.loading=!0,setTimeout((()=>{const e=document.getElementById("poster"),l=document.querySelector(".water-mask-box"),o=document.querySelector(".mask"),a=document.querySelector(".logo"),n=document.querySelector(".fg");let s=e.offsetWidth,d=e.offsetHeight;0===i.bdType?(n.style.height=i.realPicHeight+"px",n.style.width=i.realPicWidth+"px",l.style.height=i.bdRealHeight+"px"):1===i.bdType?(n.style.height=i.realPicHeight+"px",n.style.width=i.realPicWidth+"px",l.style.padding=`${i.bdRealHeight}px ${i.bdRealHeight}px ${i.bdRealHeight-i.bdRealGap}px ${i.bdRealHeight}px`,l.style.gap=`${i.bdRealGap}px`):2!==i.bdType&&3!==i.bdType||(n.style.height=i.realPicHeight+"px",n.style.width=i.realPicWidth+"px");let r=~~(Math.max(e.offsetWidth,e.offsetHeight)/Math.max(s,d));3===i.bdType&&(i.bdTextFont.fontSize=r*i.bdTextFont.fontSize,i.bdTextGaps[0]=r*i.bdTextGaps[0],i.bdTextGaps[1]=r*i.bdTextGaps[1]),o&&(o.style.fontSize=r*i.bdTextSize+"px"),a&&(a.style.height=a.getBoundingClientRect().height*r+"px",a.style.width=a.getBoundingClientRect().width*r+"px",l.children[0].style.gap=r*i.bdLogoGap+"px"),Re.toPng(e).then((function(e){const l=new Image;l.src=e,l.onload=function(){const e=document.createElement("canvas");if(0===i.bdType)e.width=i.realPicWidth,e.height=i.realPicHeight+i.bdRealHeight;else if(1===i.bdType){let l=document.querySelector(".mask-1").offsetHeight;e.width=2*i.bdRealHeight+i.realPicWidth,e.height=i.bdRealHeight+i.realPicHeight+(i.bdRealHeight-i.bdRealGap)+i.bdRealGap+l}else 2!==i.bdType&&3!==i.bdType||(e.width=i.realPicWidth,e.height=i.realPicHeight);e.getContext("2d").drawImage(l,0,0),v(e.toDataURL("image/png"),`边框水印 - ${V(i.fileList[0].name)}`),i.bgPoster&&URL.revokeObjectURL(i.bgPoster),URL.revokeObjectURL(i.fgPoster),i.bgPoster="",i.fgPoster="",i.loading=!1,i.bdTextFont.fontSize=i.bdTextFont.fontSize/r,i.bdTextGaps[0]=i.bdTextGaps[0]/r,i.bdTextGaps[1]=i.bdTextGaps[1]/r}})).catch((e=>{i.bgPoster&&URL.revokeObjectURL(i.bgPoster),URL.revokeObjectURL(i.fgPoster),i.bgPoster="",i.fgPoster="",i.loading=!1,i.bdTextFont.fontSize=i.bdTextFont.fontSize/r,t.$message.error("保存失败")}))}),400)},handleDrawImage:(e,l,t)=>(l.clearRect(0,0,e.width,e.height),e.toDataURL("image/png")),handleChange(e,l){if(i.fileList=l,i.fileTypes.includes(e.raw.type)){i.fgPoster=URL.createObjectURL(e.raw);const l=new Image;l.src=i.fgPoster,l.onload=()=>{i.realPicHeight=l.height,i.realPicWidth=l.width}}else{let l=i.fileList.findIndex((l=>l.uid===e.uid));i.fileList.splice(l,1),t.$message.warning("导入文件格式不正确")}},handleDownload(){v(i.transformPoster,"像素画 - "+V(i.fileList[0].name))}};return f((()=>{""!==i.bgPoster&&URL.revokeObjectURL(i.bgPoster),""!==i.fgPoster&&URL.revokeObjectURL(i.fgPoster)})),d(s(s({},m(i)),n),{uploadRef:o})}}),il=e=>(j("data-v-39bc6213"),e=e(),$(),e),nl={class:"content scrollbar",ref:"scroll","element-loading-text":"正在保存图片...","element-loading-background":"var(--el-bg-color)"},sl=il((()=>L("div",{class:"el-upload__text"},[C(" 拖拽文件到这 或者 "),L("em",null,"点击这里上传")],-1))),dl={key:1,class:"scrollbar scrollY",style:{"max-height":"600px"}},rl={id:"poster",class:"poster flex-column-center"},ul=["src"],cl=["src"],pl=["src"],gl=["src"],fl={key:2,class:"water-mask-box"},ml=["src"],hl=["src"],bl=["src"],xl=il((()=>L("div",{class:"el-upload__tip"}," 支持上传 .png/jpg 文件 ",-1))),wl={class:"fun-box scrollY scrollbar full-h full-w",style:{flex:"1"}},yl={class:"flex-column-center fun-list"},vl={class:"flex-between full-w"},Vl=il((()=>L("p",{style:{width:"100px"}},"样式",-1))),Tl=C("经典"),Ll=C("边框"),Pl=C("无边框"),Cl=C("全屏水印"),Sl={class:"flex-between full-w"},Rl=il((()=>L("p",{style:{width:"100px"}},"模板",-1))),kl={key:0,class:"flex-between full-w"},Ul=il((()=>L("p",{style:{width:"100px"}},"边框背景",-1))),_l={key:1,class:"flex-between full-w"},jl=il((()=>L("p",{style:{width:"100px"}},"边框大小",-1))),$l={key:2,class:"flex-between full-w"},Gl=il((()=>L("p",{style:{width:"100px"}},"间距",-1))),Hl={class:"flex-between full-w"},zl=il((()=>L("p",{style:{width:"100px"}},"水印内容",-1))),Dl={class:"flex-between full-w"},El=il((()=>L("p",{style:{width:"100px"}},"水印位置",-1))),Il={class:"flex-between full-w"},Fl=il((()=>L("p",{style:{width:"100px"}},"水印大小",-1))),Al={class:"flex-between full-w"},Ol=il((()=>L("p",{style:{width:"100px"}},"水印字重",-1))),Wl={class:"flex-between full-w"},Bl=il((()=>L("p",{style:{width:"100px"}},"水印样式",-1))),Ml={class:"flex-between full-w"},Nl=il((()=>L("p",{style:{width:"100px"}},"水印字体",-1))),Xl={class:"flex-between full-w"},Yl=il((()=>L("p",{style:{width:"100px"}},"水印渐变",-1))),ql={class:"flex-between full-w"},Jl=il((()=>L("p",{style:{width:"100px"}},"水印颜色",-1))),Kl={class:"flex-end",style:{gap:"10px"}},Zl={class:"flex-between full-w"},Ql={style:{width:"100px",gap:"10px"},class:"flex-start"},et=C(" Logo "),lt=["src"],tt={class:"flex-end",style:{gap:"10px"}},ot=C("上传LOGO"),at={class:"flex-between full-w"},it=il((()=>L("p",{style:{width:"100px"}},"Logo大小",-1))),nt={class:"flex-between full-w"},st=il((()=>L("p",{style:{width:"100px"}},"Logo间距",-1))),dt={class:"flex-between full-w"},rt=il((()=>L("p",{style:{width:"100px"}},"垂直排列",-1))),ut={key:3,class:"flex-between full-w"},ct=il((()=>L("p",{style:{width:"100px"}},"图片圆角",-1))),pt={key:4,class:"flex-between full-w",style:{gap:"20px"}},gt=il((()=>L("p",{style:{width:"100px"}},"图片阴影",-1))),ft={class:"flex-between full-w"},mt=il((()=>L("p",{style:{width:"100px"}},"水印内容",-1))),ht={class:"flex-between full-w"},bt=il((()=>L("p",{style:{width:"100px"}},"水印宽度",-1))),xt={class:"flex-between full-w"},wt=il((()=>L("p",{style:{width:"100px"}},"水印高度",-1))),yt={class:"flex-between full-w"},vt=il((()=>L("p",{style:{width:"100px"}},"旋转角度",-1))),Vt={class:"flex-between full-w"},Tt=il((()=>L("p",{style:{width:"100px"}},"水印大小",-1))),Lt={class:"flex-between full-w"},Pt=il((()=>L("p",{style:{width:"100px"}},"水印字重",-1))),Ct={class:"flex-between full-w"},St=il((()=>L("p",{style:{width:"100px"}},"水印样式",-1))),Rt={class:"flex-between full-w"},kt=il((()=>L("p",{style:{width:"100px"}},"水印字体",-1))),Ut={class:"flex-between full-w"},_t=il((()=>L("p",{style:{width:"100px"}},"水印颜色",-1))),jt={class:"flex-between full-w"},$t={style:{width:"100px",gap:"10px"},class:"flex-start"},Gt=C(" Logo "),Ht=["src"],zt={class:"flex-end",style:{gap:"10px"}},Dt=C("上传LOGO"),Et={class:"flex-between full-w"},It=il((()=>L("p",{style:{width:"100px"}},"间距",-1))),Ft={class:"dialog-footer"},At=C("保 存");var Ot=r(al,[["render",function(e,l,t,o,a,i){const n=h("upload-filled"),s=h("el-icon"),d=h("el-watermark"),r=h("el-upload"),u=h("el-radio"),c=h("el-radio-group"),p=h("el-option"),g=h("el-select"),f=h("el-color-picker"),m=h("el-slider"),w=h("el-input"),y=h("el-input-number"),v=h("el-space"),V=h("el-switch"),_=h("el-link"),j=h("el-button"),$=h("el-dialog"),F=G("loading");return T(),b($,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[39]||(l[39]=l=>e.dialogVisible=l),title:"边框水印","before-close":e.handleClose,"close-on-click-modal":!1,"lock-scroll":!1,top:"10vh",class:"z-dialog",center:"",width:1e3},{footer:x((()=>[L("span",Ft,[P(j,{onClick:e.handleClose},{default:x((()=>[C(S(e.$t("message.cancel")),1)])),_:1},8,["onClick"]),P(j,{type:"primary",onClick:e.handleConfirm,loading:e.loading},{default:x((()=>[At])),_:1},8,["onClick","loading"])])])),default:x((()=>[H((T(),R("div",nl,[P(r,{ref:"uploadRef",style:{flex:"1"},class:"flex-column-center","show-file-list":!1,drag:"",limit:1,"auto-upload":!1,accept:".png,.jpg,.jpeg","on-change":e.handleChange,"on-exceed":e.handleExceed,"file-list":e.fileList,"onUpdate:file-list":l[4]||(l[4]=l=>e.fileList=l)},{tip:x((()=>[xl])),default:x((()=>[""===e.fgPoster?(T(),R(k,{key:0},[P(s,{class:"el-icon--upload"},{default:x((()=>[P(n)])),_:1}),sl],64)):(T(),R("div",dl,[L("div",rl,[U(' <img \r\n                            :src="bgPoster" \r\n                            v-if="bgPoster"\r\n                            style="object-fit: cover;" \r\n                            draggable="false" \r\n                            :style="{\r\n                                filter:`blur(${bgBlur}px)`,\r\n                                transform:\'scale(1.2)\'\r\n                            }"> '),0===e.bdType?(T(),R(k,{key:0},[L("img",{src:e.fgPoster,class:"fg fg0",onLoad:l[0]||(l[0]=(...l)=>e.handleLoad&&e.handleLoad(...l)),style:{"object-fit":"contain"},draggable:"false"},null,40,ul),L("div",{class:"water-mask-box full-w",style:z({backgroundColor:e.bdColor,height:`${e.bdRenderHeight}px`})},[L("div",{class:D(["water-mask-content",{"flex-column":e.isVerticalLogo,"flex-row":!e.isVerticalLogo}]),style:z({left:`${e.bdTextPos[0]}%`,top:`${e.bdTextPos[1]}%`,gap:`${e.bdLogoGap}px`})},[e.isEnableLogo&&e.bdLogo?(T(),R("img",{key:0,src:e.bdLogo,class:"logo",style:z({transform:`scale(${e.logoSize})`,height:"20px",width:"20px"})},null,12,cl)):U("v-if",!0),L("p",{style:z({color:e.bdTextColor,fontFamily:e.bdTextFamily,fontSize:`${e.bdTextSize}px`,fontWeight:e.bdTextWeight,fontStyle:e.bdTextStyle,background:e.isEnableTextGradient?`text linear-gradient(to right, ${e.bdTextColor}, ${e.bdTextSecondColor})`:"none"}),class:D(["mask oneline",{gradientColor:e.isEnableTextGradient}])},S(e.bdText),7)],6)],4)],64)):U("v-if",!0),1===e.bdType?(T(),R("div",{key:1,class:"water-mask-box flex-column-center",style:z({backgroundColor:e.bdColor,gap:`${e.bdRenderGap}px`,padding:`${e.bdRenderHeight}px ${e.bdRenderHeight}px ${e.bdRenderHeight-e.bdRenderGap}px ${e.bdRenderHeight}px`})},[L("img",{src:e.fgPoster,onLoad:l[1]||(l[1]=(...l)=>e.handleLoad&&e.handleLoad(...l)),style:z([{top:`${e.fgPos}%`,borderRadius:`${e.fgRadius}px`,boxShadow:`0px 0px ${e.fgShadow}px ${e.fgShadowColor}`},{"object-fit":"contain"}]),class:"fg fg1",draggable:"false"},null,44,pl),L("div",{class:D(["flex-center full-w mask-1",{"flex-column":e.isVerticalLogo,"flex-row":!e.isVerticalLogo}]),style:z({gap:`${e.bdLogoGap}px`})},[e.isEnableLogo&&e.bdLogo?(T(),R("img",{key:0,src:e.bdLogo,class:"logo",style:z({transform:`scale(${e.logoSize})`,height:"20px",width:"20px"})},null,12,gl)):U("v-if",!0),L("p",{style:z({color:e.bdTextColor,fontFamily:e.bdTextFamily,fontSize:`${e.bdTextSize}px`,fontWeight:e.bdTextWeight,fontStyle:e.bdTextStyle,background:e.isEnableTextGradient?`text linear-gradient(to right, ${e.bdTextColor}, ${e.bdTextSecondColor})`:"none"}),class:D(["mask oneline",{gradientColor:e.isEnableTextGradient}])},S(e.bdText),7)],6)],4)):U("v-if",!0),2===e.bdType?(T(),R("div",fl,[L("img",{src:e.fgPoster,onLoad:l[2]||(l[2]=(...l)=>e.handleLoad&&e.handleLoad(...l)),class:"fg fg2",style:{"object-fit":"contain"},draggable:"false"},null,40,ml),L("div",{class:D(["water-mask-content",{"flex-column":e.isVerticalLogo,"flex-row":!e.isVerticalLogo}]),style:z({left:`${e.bdTextPos[0]}%`,top:`${e.bdTextPos[1]}%`,gap:`${e.bdLogoGap}px`})},[e.isEnableLogo&&e.bdLogo?(T(),R("img",{key:0,src:e.bdLogo,class:"logo",style:z({transform:`scale(${e.logoSize})`,height:"20px",width:"20px"})},null,12,hl)):U("v-if",!0),L("p",{style:z({color:e.bdTextColor,fontFamily:e.bdTextFamily,fontSize:`${e.bdTextSize}px`,fontWeight:e.bdTextWeight,fontStyle:e.bdTextStyle,background:e.isEnableTextGradient?`text linear-gradient(to right, ${e.bdTextColor}, ${e.bdTextSecondColor})`:"none"}),class:D(["mask oneline",{gradientColor:e.isEnableTextGradient}])},S(e.bdText),7)],6)])):U("v-if",!0),U(' <img :src="fgPoster" class="`fg2" :style="{\r\n                                top:`${fgPos}%`,\r\n                                borderRadius:`${fgRadius}px`,\r\n                                boxShadow:`0px 0px ${fgShadow}px ${fgShadowColor}`,\r\n                                height:`${fgHeight}%`,\r\n                                width:`${fgWidth}%`\r\n                            }" v-if="bdType===2"\r\n                            style="object-fit: contain;" draggable="false"> '),3===e.bdType?(T(),b(d,{key:3,class:"watermark",content:e.bdText,font:e.bdTextFont,rotate:e.bdTextRotate,gap:e.bdTextGaps,image:e.isEnableLogo?e.bdLogo:"",width:e.isEnableLogo?e.bdTextWidth:120,height:e.isEnableLogo?e.bdTextHeight:64},{default:x((()=>[L("img",{src:e.fgPoster,class:"fg fg3",onLoad:l[3]||(l[3]=(...l)=>e.handleLoad&&e.handleLoad(...l)),style:z([{},{"object-fit":"contain"}]),draggable:"false"},null,40,bl)])),_:1},8,["content","font","rotate","gap","image","width","height"])):U("v-if",!0)])]))])),_:1},8,["on-change","on-exceed","file-list"]),L("div",wl,[L("div",yl,[L("div",vl,[Vl,P(c,{modelValue:e.bdType,"onUpdate:modelValue":l[5]||(l[5]=l=>e.bdType=l)},{default:x((()=>[P(u,{value:0},{default:x((()=>[Tl])),_:1}),P(u,{value:1},{default:x((()=>[Ll])),_:1}),P(u,{value:2},{default:x((()=>[Pl])),_:1}),P(u,{value:3},{default:x((()=>[Cl])),_:1})])),_:1},8,["modelValue"])]),[0,1,2].includes(e.bdType)?(T(),R(k,{key:0},[L("div",Sl,[Rl,P(g,{modelValue:e.bdTemplate,"onUpdate:modelValue":l[6]||(l[6]=l=>e.bdTemplate=l),onChange:e.handleChangeTemplate},{default:x((()=>[P(p,{label:"自定义",value:"0"}),P(p,{label:"新春水印",value:"1"})])),_:1},8,["modelValue","onChange"])]),[0,1].includes(e.bdType)?(T(),R("div",kl,[Ul,P(f,{modelValue:e.bdColor,"onUpdate:modelValue":l[7]||(l[7]=l=>e.bdColor=l)},null,8,["modelValue"])])):U("v-if",!0),[0,1].includes(e.bdType)?(T(),R("div",_l,[jl,P(m,{modelValue:e.bdHeight,"onUpdate:modelValue":l[8]||(l[8]=l=>e.bdHeight=l),onChange:e.handleBorderSize,"show-input":"",min:10,max:100},null,8,["modelValue","onChange"])])):U("v-if",!0),[1].includes(e.bdType)?(T(),R("div",$l,[Gl,P(m,{modelValue:e.bdGap,"onUpdate:modelValue":l[9]||(l[9]=l=>e.bdGap=l),"show-input":"",onChange:e.handleBorderGap,min:0,max:100},null,8,["modelValue","onChange"])])):U("v-if",!0),L("div",Hl,[zl,P(w,{modelValue:e.bdText,"onUpdate:modelValue":l[10]||(l[10]=l=>e.bdText=l),placeholder:"请输入水印"},null,8,["modelValue"])]),H(L("div",Dl,[El,U(' <el-slider v-model="bdTextPos" show-input :min="0" :max="100"/> '),P(v,null,{default:x((()=>[P(y,{modelValue:e.bdTextPos[0],"onUpdate:modelValue":l[11]||(l[11]=l=>e.bdTextPos[0]=l),"controls-position":"right"},null,8,["modelValue"]),P(y,{modelValue:e.bdTextPos[1],"onUpdate:modelValue":l[12]||(l[12]=l=>e.bdTextPos[1]=l),"controls-position":"right"},null,8,["modelValue"])])),_:1})],512),[[E,[0,2].includes(e.bdType)]]),L("div",Il,[Fl,P(m,{modelValue:e.bdTextSize,"onUpdate:modelValue":l[13]||(l[13]=l=>e.bdTextSize=l),"show-input":"",min:12,max:60},null,8,["modelValue"])]),L("div",Al,[Ol,P(m,{modelValue:e.bdTextWeight,"onUpdate:modelValue":l[14]||(l[14]=l=>e.bdTextWeight=l),"show-input":"",min:300,max:1e3},null,8,["modelValue"])]),L("div",Wl,[Bl,P(g,{modelValue:e.bdTextStyle,"onUpdate:modelValue":l[15]||(l[15]=l=>e.bdTextStyle=l)},{default:x((()=>[P(p,{label:"正体",value:"normal"}),P(p,{label:"斜体",value:"italic"})])),_:1},8,["modelValue"])]),L("div",Ml,[Nl,P(g,{modelValue:e.bdTextFamily,"onUpdate:modelValue":l[16]||(l[16]=l=>e.bdTextFamily=l)},{default:x((()=>[(T(!0),R(k,null,I(e.fontFamilyOptions,(e=>(T(),b(p,{style:z({fontFamily:e.value}),key:e.value,label:e.label,value:e.value},null,8,["style","label","value"])))),128))])),_:1},8,["modelValue"])]),L("div",Xl,[Yl,P(V,{modelValue:e.isEnableTextGradient,"onUpdate:modelValue":l[17]||(l[17]=l=>e.isEnableTextGradient=l)},null,8,["modelValue"])]),L("div",ql,[Jl,L("div",Kl,[P(f,{modelValue:e.bdTextColor,"onUpdate:modelValue":l[18]||(l[18]=l=>e.bdTextColor=l),"show-alpha":""},null,8,["modelValue"]),e.isEnableTextGradient?(T(),b(f,{key:0,modelValue:e.bdTextSecondColor,"onUpdate:modelValue":l[19]||(l[19]=l=>e.bdTextSecondColor=l),"show-alpha":""},null,8,["modelValue"])):U("v-if",!0)])]),L("div",Zl,[L("p",Ql,[et,L("img",{style:{width:"20px"},src:W},null,8,lt)]),L("div",tt,[P(V,{modelValue:e.isEnableLogo,"onUpdate:modelValue":l[20]||(l[20]=l=>e.isEnableLogo=l)},null,8,["modelValue"]),P(_,{type:"primary",underline:!1,onClick:e.handleUploadLogo},{default:x((()=>[ot])),_:1},8,["onClick"])]),U(' <el-link type="primary" :underline="false" @click="handleUploadLogo">上传LOGO</el-link> ')]),L("div",at,[it,P(m,{modelValue:e.logoSize,"onUpdate:modelValue":l[21]||(l[21]=l=>e.logoSize=l),"show-input":"",min:.1,max:3,step:.1},null,8,["modelValue","min","step"])]),L("div",nt,[st,P(m,{modelValue:e.bdLogoGap,"onUpdate:modelValue":l[22]||(l[22]=l=>e.bdLogoGap=l),"show-input":"",min:5,max:100},null,8,["modelValue"])]),L("div",dt,[rt,P(V,{modelValue:e.isVerticalLogo,"onUpdate:modelValue":l[23]||(l[23]=l=>e.isVerticalLogo=l)},null,8,["modelValue"])]),U(' <div class="flex-between full-w" v-if="bdType === 1 && bgPoster">\r\n                            <p style="width:100px">模 糊</p>\r\n                            <el-slider v-model="bgBlur" show-input :min="0" :max="30"/>\r\n                        </div> '),U(' <div class="flex-between full-w" v-if="bdType === 1">\r\n                            <p style="width:100px">图片宽度</p>\r\n                            <el-slider v-model="fgWidth" show-input :min="10" :max="90"/>\r\n                        </div>\r\n                        <div class="flex-between full-w" v-if="bdType === 1">\r\n                            <p style="width:100px">图片高度</p>\r\n                            <el-slider v-model="fgHeight" show-input :min="10" :max="90"/>\r\n                        </div> '),U(' <div class="flex-between full-w" v-if="bdType === 1">\r\n                            <p style="width:100px">图片位置</p>\r\n                            <el-slider v-model="fgPos" show-input :min="0" :max="100"/>\r\n                        </div> '),1===e.bdType?(T(),R("div",ut,[ct,P(m,{modelValue:e.fgRadius,"onUpdate:modelValue":l[24]||(l[24]=l=>e.fgRadius=l),"show-input":"",min:0,max:100},null,8,["modelValue"])])):U("v-if",!0),1===e.bdType?(T(),R("div",pt,[gt,P(m,{modelValue:e.fgShadow,"onUpdate:modelValue":l[25]||(l[25]=l=>e.fgShadow=l),min:0,max:10},null,8,["modelValue"]),P(f,{modelValue:e.fgShadowColor,"onUpdate:modelValue":l[26]||(l[26]=l=>e.fgShadowColor=l),"show-alpha":""},null,8,["modelValue"])])):U("v-if",!0)],64)):U("v-if",!0),[3].includes(e.bdType)?(T(),R(k,{key:1},[L("div",ft,[mt,P(w,{modelValue:e.bdText,"onUpdate:modelValue":l[27]||(l[27]=l=>e.bdText=l),placeholder:"请输入水印"},null,8,["modelValue"])]),L("div",ht,[bt,P(m,{modelValue:e.bdTextWidth,"onUpdate:modelValue":l[28]||(l[28]=l=>e.bdTextWidth=l),"show-input":"",min:10,max:999},null,8,["modelValue"])]),L("div",xt,[wt,P(m,{modelValue:e.bdTextHeight,"onUpdate:modelValue":l[29]||(l[29]=l=>e.bdTextHeight=l),"show-input":"",min:10,max:999},null,8,["modelValue"])]),L("div",yt,[vt,P(m,{modelValue:e.bdTextRotate,"onUpdate:modelValue":l[30]||(l[30]=l=>e.bdTextRotate=l),"show-input":"",min:-180,max:180},null,8,["modelValue"])]),L("div",Vt,[Tt,P(m,{modelValue:e.bdTextFont.fontSize,"onUpdate:modelValue":l[31]||(l[31]=l=>e.bdTextFont.fontSize=l),"show-input":"",min:12,max:30},null,8,["modelValue"])]),L("div",Lt,[Pt,P(m,{modelValue:e.bdTextFont.fontWeight,"onUpdate:modelValue":l[32]||(l[32]=l=>e.bdTextFont.fontWeight=l),"show-input":"",min:300,max:1e3},null,8,["modelValue"])]),L("div",Ct,[St,P(g,{modelValue:e.bdTextFont.fontStyle,"onUpdate:modelValue":l[33]||(l[33]=l=>e.bdTextFont.fontStyle=l)},{default:x((()=>[P(p,{label:"正体",value:"normal"}),P(p,{label:"斜体",value:"italic"})])),_:1},8,["modelValue"])]),L("div",Rt,[kt,P(g,{modelValue:e.bdTextFont.fontFamily,"onUpdate:modelValue":l[34]||(l[34]=l=>e.bdTextFont.fontFamily=l)},{default:x((()=>[(T(!0),R(k,null,I(e.fontFamilyOptions,(e=>(T(),b(p,{style:z({fontFamily:e.value}),key:e.value,label:e.label,value:e.value},null,8,["style","label","value"])))),128))])),_:1},8,["modelValue"])]),L("div",Ut,[_t,P(f,{modelValue:e.bdTextFont.color,"onUpdate:modelValue":l[35]||(l[35]=l=>e.bdTextFont.color=l),"show-alpha":""},null,8,["modelValue"])]),L("div",jt,[L("p",$t,[Gt,L("img",{style:{width:"20px"},src:W},null,8,Ht)]),L("div",zt,[P(V,{modelValue:e.isEnableLogo,"onUpdate:modelValue":l[36]||(l[36]=l=>e.isEnableLogo=l)},null,8,["modelValue"]),P(_,{type:"primary",underline:!1,onClick:e.handleUploadLogo},{default:x((()=>[Dt])),_:1},8,["onClick"])])]),L("div",Et,[It,P(v,null,{default:x((()=>[P(y,{modelValue:e.bdTextGaps[0],"onUpdate:modelValue":l[37]||(l[37]=l=>e.bdTextGaps[0]=l),"controls-position":"right"},null,8,["modelValue"]),P(y,{modelValue:e.bdTextGaps[1],"onUpdate:modelValue":l[38]||(l[38]=l=>e.bdTextGaps[1]=l),"controls-position":"right"},null,8,["modelValue"])])),_:1})])],64)):U("v-if",!0)])])])),[[F,e.loading]])])),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-39bc6213"],["__file","D:/project/pixel-grid/src/components/dialog/tools/BorderDrawDialog.vue"]]);const Wt=u({name:"PintuDialog",components:{},props:{visible:{type:Boolean,default:!1}},emits:["close","import"],setup(e,l){const{proxy:t}=_(),o=c(),a=p();let i=g({loading:!1,dialogVisible:e.visible,fileList:[],fileListTemp:[],fileTypes:["image/jpg","image/jpeg","image/png"],ptGgColCount:2,ptGgCount:2,ptType:0,fgStyle:{top:"50%",borderRadius:10,boxShadow:"1px 1px 10px",boxShadowColor:"#80808050"},bgRatioList:[[1024,1024,512,512],[1600,1200,800,600],[1200,1600,600,800],[2560,1440,960,540],[2560,1440,540,960]],minPinjie:2,maxPinjie:6,ptPinjieType:0,bgColor:"#ffffff",bgPadding:15,fgFit:0,bgGap:15,fgWidth:90,fgHeight:40,bgBlur:10,bgRatio:0,fgPos:30,fgRadius:20,fgShadow:5,fgShadowColor:"#000000",fgShadowX:0,fgShadowY:0,fgPoster:"",bgPoster:"",poster:"",transformPoster:"",scrollHeight:0,isLoad:!1,fgPosterList:[]}),n={handleReset(){for(let e=0;e<i.fgPosterList.length;e++)URL.revokeObjectURL(i.fgPosterList[e].imgUrl);i.fgPosterList=[],i.fileList=[]},handleExceed(e,l){let o=0===i.ptType?i.ptGgCount:i.maxPinjie;e.length>o&&t.$message.warning("上传文件数量已达上限")},handleClose(){i.dialogVisible=!1,l.emit("close")},handleConfirm(){if(!i.fileList.length)return t.$message.warning("上传文件不能为空");i.loading=!0,setTimeout((()=>{const e=document.getElementById("poster");if(0===i.ptType){e.style.width=2*e.offsetWidth+"px",e.style.padding=2*i.bgPadding+"px",e.style.gridColumnGap=2*i.bgGap+"px",e.style.gridRowGap=2*i.bgGap+"px";const l=e.children;for(let e=0;e<l.length;e++)l[e].style.borderRadius=2*i.fgRadius+"px",l[e].style.boxShadow=`${2*i.fgShadowX}px ${2*i.fgShadowY}px ${2*i.fgShadow}px ${i.fgShadowColor}`}else if(1===i.ptType){const l=e.children;for(let e=0;e<l.length;e++)l[e].style.maxWidth="none",l[e].style.width=i.fgPosterList[e].width+"px",l[e].style.height=i.fgPosterList[e].height+"px";e.parentNode.style.maxWidth="none"}Re.toPng(e).then((function(l){v(l,(0===i.ptType?"宫格":"拼接")+"拼图");for(let e=0;e<i.fgPosterList.length;e++)URL.revokeObjectURL(i.fgPosterList[e].imgUrl);i.fgPosterList=[],i.fileList=[],i.loading=!1,e.parentNode.style.maxWidth="500px"})).catch((e=>{for(let l=0;l<i.fgPosterList.length;l++)URL.revokeObjectURL(i.fgPosterList[l].imgUrl);i.fgPosterList=[],i.fileList=[],i.loading=!1,t.$message.error("保存失败")}))}),200)},handleDrawImage:(e,l,t)=>(l.clearRect(0,0,e.width,e.height),e.toDataURL("image/png")),handleChange(e,l){if(i.fileList=l,i.fileTypes.includes(e.raw.type)){i.fgPosterList=[];for(let e=0;e<i.fileList.length;e++){const l=URL.createObjectURL(i.fileList[e].raw),t={imgUrl:l,width:0,height:0},o=new Image;o.src=l,o.onload=()=>{t.width=o.width,t.height=o.height},i.fgPosterList.push(t)}}else{let l=i.fileList.findIndex((l=>l.uid===e.uid));i.fileList.splice(l,1),t.$message.warning("导入文件格式不正确")}},handleDownload(){v(i.transformPoster,"拼图 - "+V(i.fileList[0].name))}};return F((()=>{var e;o.versionInfoData?i.maxPinjie=Number(o.versionInfoData[o.userData?Number(null==(e=o.userData)?void 0:e.vip):0].fun.find((e=>e.includes("pinjieCount"))).split("-")[1]):t.$message.warning("版本信息异常")})),f((()=>{for(let e=0;e<i.fgPosterList.length;e++)URL.revokeObjectURL(i.fgPosterList[e].imgUrl)})),d(s(s({},m(i)),n),{uploadRef:a,editSpaceStore:o})}}),Bt=e=>(j("data-v-3c3d2ef3"),e=e(),$(),e),Mt={class:"content scrollbar",ref:"scroll","element-loading-text":"正在保存图片...","element-loading-background":"var(--el-bg-color)"},Nt=Bt((()=>L("div",{class:"el-upload__text"},[C(" 拖拽文件到这 或者 "),L("em",null,"点击这里上传")],-1))),Xt={key:1,class:"scrollbar scrollY",style:{"max-height":"600px","max-width":"500px"}},Yt=["src"],qt=["src"],Jt=Bt((()=>L("div",{class:"el-upload__tip"}," 支持上传 .png/jpg 文件 ",-1))),Kt={class:"fun-box scrollY scrollbar full-h full-w",style:{flex:"1"}},Zt={class:"flex-column-start fun-list"},Qt={class:"flex-between full-w"},eo=Bt((()=>L("p",{style:{width:"100px"}},"样式",-1))),lo=C("宫格"),to=C("拼接"),oo=C("仅专业版及以上支持自定义图片数量，最大支持18张图片"),ao={key:1,class:"flex-between full-w",style:{gap:"10px"}},io=Bt((()=>L("p",{style:{width:"100px"}},"宫格列数",-1))),no={key:2,class:"flex-between full-w",style:{gap:"10px"}},so=Bt((()=>L("p",{style:{width:"100px"}},"图片数量",-1))),ro={class:"flex-between full-w"},uo=Bt((()=>L("p",{style:{width:"100px"}},"背景颜色",-1))),co={key:3,class:"flex-between full-w"},po=Bt((()=>L("p",{style:{width:"100px"}},"背景内边距",-1))),go={key:4,class:"flex-between full-w"},fo=Bt((()=>L("p",{style:{width:"100px"}},"图片间距",-1))),mo={class:"flex-between full-w"},ho=Bt((()=>L("p",{style:{width:"100px"}},"图片显示",-1))),bo=C("保持比例"),xo=C("放大占满"),wo={key:5,class:"flex-between full-w"},yo=Bt((()=>L("p",{style:{width:"100px"}},"图片圆角",-1))),vo={key:6,class:"flex-between full-w",style:{gap:"20px"}},Vo=Bt((()=>L("p",{style:{width:"100px"}},"图片阴影",-1))),To={key:7,class:"flex-between full-w",style:{gap:"20px"}},Lo=Bt((()=>L("p",{style:{width:"100px"}},"阴影偏移",-1))),Po={class:"flex-end",style:{gap:"5px"}},Co={key:8,class:"flex-between full-w"},So=Bt((()=>L("p",{style:{width:"100px"}},"拼接方式",-1))),Ro=C("横向拼接"),ko=C("竖向拼接"),Uo={class:"dialog-footer"},_o=C("重 置"),jo=C("保 存");var $o=r(Wt,[["render",function(e,l,t,o,a,i){const n=h("upload-filled"),s=h("el-icon"),d=h("el-upload"),r=h("el-radio"),u=h("el-radio-group"),c=h("el-tag"),p=h("el-input-number"),g=h("el-option"),f=h("el-select"),m=h("el-space"),w=h("el-color-picker"),y=h("el-slider"),v=h("el-button"),V=h("el-dialog"),_=G("loading");return T(),b(V,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[15]||(l[15]=l=>e.dialogVisible=l),title:"拼 图","before-close":e.handleClose,"close-on-click-modal":!1,"lock-scroll":!1,top:"10vh",class:"z-dialog",center:"",width:1e3},{footer:x((()=>[L("span",Uo,[P(v,{onClick:e.handleClose},{default:x((()=>[C(S(e.$t("message.cancel")),1)])),_:1},8,["onClick"]),P(v,{type:"primary",plain:"",onClick:e.handleReset},{default:x((()=>[_o])),_:1},8,["onClick"]),P(v,{type:"primary",onClick:e.handleConfirm,loading:e.loading},{default:x((()=>[jo])),_:1},8,["onClick","loading"])])])),default:x((()=>[H((T(),R("div",Mt,[P(d,{ref:"uploadRef",style:{flex:"1"},class:"flex-column-center","show-file-list":!1,drag:"",multiple:"",limit:0===e.ptType?e.ptGgCount:e.maxPinjie,"auto-upload":!1,accept:".png,.jpg,.jpeg","on-change":e.handleChange,"on-exceed":e.handleExceed,"file-list":e.fileList,"onUpdate:file-list":l[0]||(l[0]=l=>e.fileList=l)},{tip:x((()=>[Jt])),default:x((()=>[e.fgPosterList.length?(T(),R("div",Xt,[0===e.ptType?(T(),R("div",{key:0,id:"poster",class:"poster flex-center",style:z({backgroundColor:`${e.bgColor}`,padding:`${e.bgPadding}px`,gridColumnGap:`${e.bgGap}px`,gridRowGap:`${e.bgGap}px`,"--grid-column":e.ptGgColCount})},[(T(!0),R(k,null,I(e.fgPosterList,((l,t)=>(T(),R("img",{key:t,src:l.imgUrl,class:"fg",style:z({borderRadius:`${e.fgRadius}px`,boxShadow:`${e.fgShadowX}px ${e.fgShadowY}px ${e.fgShadow}px ${e.fgShadowColor}`,objectFit:0===e.fgFit?"contain":"cover"}),draggable:"false"},null,12,Yt)))),128))],4)):(T(),R("div",{key:1,id:"poster",class:"poster1 scrollbar scrollX",style:z({flexDirection:0===e.ptPinjieType?"row":"column",flexWarp:"none",backgroundColor:`${e.bgColor}`,overflowX:"auto"})},[(T(!0),R(k,null,I(e.fgPosterList,((l,t)=>(T(),R("img",{key:t,src:l.imgUrl,class:"fg",style:z({objectFit:0===e.fgFit?"contain":"cover",width:"auto",height:"auto",maxWidth:"200px"}),draggable:"false"},null,12,qt)))),128))],4))])):(T(),R(k,{key:0},[P(s,{class:"el-icon--upload"},{default:x((()=>[P(n)])),_:1}),Nt],64))])),_:1},8,["limit","on-change","on-exceed","file-list"]),L("div",Kt,[L("div",Zt,[L("div",Qt,[eo,P(u,{modelValue:e.ptType,"onUpdate:modelValue":l[1]||(l[1]=l=>e.ptType=l),style:{gap:"15px"}},{default:x((()=>[P(r,{value:0},{default:x((()=>[lo])),_:1}),P(r,{value:1},{default:x((()=>[to])),_:1})])),_:1},8,["modelValue"])]),0===e.ptType?(T(),b(c,{key:0,type:"warning",effect:"dark"},{default:x((()=>[oo])),_:1})):U("v-if",!0),U(' <el-tag type="warning" effect="dark" v-else>专业版支持12张图、高级版支持20张图</el-tag> '),0===e.ptType?(T(),R("div",ao,[io,P(p,{modelValue:e.ptGgColCount,"onUpdate:modelValue":l[2]||(l[2]=l=>e.ptGgColCount=l),"controls-position":"right",min:1,max:4},null,8,["modelValue"]),U(' <el-select v-model="ptGgColCount" style="width:200px">\r\n                            <el-option label="1" :value="1"/>\r\n                            <el-option label="2" :value="2"/>\r\n                            <el-option label="3" :value="3"/>\r\n                            <el-option label="4" :value="4"/>\r\n                        </el-select> ')])):U("v-if",!0),0===e.ptType?(T(),R("div",no,[so,P(f,{modelValue:e.ptGgCount,"onUpdate:modelValue":l[3]||(l[3]=l=>e.ptGgCount=l),disabled:e.fileList.length,style:{width:"200px"}},{default:x((()=>[P(g,{label:"2",value:2}),P(g,{label:"4",value:4}),P(g,{label:"6",value:6}),P(g,{label:"9",value:9})])),_:1},8,["modelValue","disabled"]),e.editSpaceStore.userData&&e.editSpaceStore.userData.vip>0?(T(),b(m,{key:0},{default:x((()=>[P(p,{disabled:e.fileList.length,modelValue:e.ptGgCount,"onUpdate:modelValue":l[4]||(l[4]=l=>e.ptGgCount=l),"controls-position":"right",min:1,max:18},null,8,["disabled","modelValue"])])),_:1})):U("v-if",!0)])):U("v-if",!0),L("div",ro,[uo,P(w,{modelValue:e.bgColor,"onUpdate:modelValue":l[5]||(l[5]=l=>e.bgColor=l)},null,8,["modelValue"])]),0===e.ptType?(T(),R("div",co,[po,P(y,{modelValue:e.bgPadding,"onUpdate:modelValue":l[6]||(l[6]=l=>e.bgPadding=l),"show-input":"",min:0,max:100},null,8,["modelValue"])])):U("v-if",!0),0===e.ptType?(T(),R("div",go,[fo,P(y,{modelValue:e.bgGap,"onUpdate:modelValue":l[7]||(l[7]=l=>e.bgGap=l),"show-input":"",min:0,max:100},null,8,["modelValue"])])):U("v-if",!0),L("div",mo,[ho,P(u,{modelValue:e.fgFit,"onUpdate:modelValue":l[8]||(l[8]=l=>e.fgFit=l),style:{gap:"15px"}},{default:x((()=>[P(r,{value:0},{default:x((()=>[bo])),_:1}),P(r,{value:1},{default:x((()=>[xo])),_:1})])),_:1},8,["modelValue"])]),0===e.ptType?(T(),R("div",wo,[yo,P(y,{modelValue:e.fgRadius,"onUpdate:modelValue":l[9]||(l[9]=l=>e.fgRadius=l),"show-input":"",min:0,max:100},null,8,["modelValue"])])):U("v-if",!0),0===e.ptType?(T(),R("div",vo,[Vo,P(y,{modelValue:e.fgShadow,"onUpdate:modelValue":l[10]||(l[10]=l=>e.fgShadow=l),min:0,max:10},null,8,["modelValue"]),P(w,{modelValue:e.fgShadowColor,"onUpdate:modelValue":l[11]||(l[11]=l=>e.fgShadowColor=l),"show-alpha":""},null,8,["modelValue"])])):U("v-if",!0),0===e.ptType?(T(),R("div",To,[Lo,L("div",Po,[P(p,{style:{width:"120px"},modelValue:e.fgShadowX,"onUpdate:modelValue":l[12]||(l[12]=l=>e.fgShadowX=l)},null,8,["modelValue"]),P(p,{style:{width:"120px"},modelValue:e.fgShadowY,"onUpdate:modelValue":l[13]||(l[13]=l=>e.fgShadowY=l)},null,8,["modelValue"])])])):U("v-if",!0),1===e.ptType?(T(),R("div",Co,[So,P(u,{modelValue:e.ptPinjieType,"onUpdate:modelValue":l[14]||(l[14]=l=>e.ptPinjieType=l),style:{gap:"15px"}},{default:x((()=>[P(r,{value:0},{default:x((()=>[Ro])),_:1}),P(r,{value:1},{default:x((()=>[ko])),_:1})])),_:1},8,["modelValue"])])):U("v-if",!0),U(' <div class="flex-column-start full-w" style="gap:5px" v-if="transformPoster">\r\n                        <p class="flex-between full-w">\r\n                            预 览\r\n                            <el-button type="success" text @click="handleDownload">下 载</el-button>\r\n                        </p>\r\n                        <div class="poster flex-center">\r\n                            <img :src="transformPoster" style="object-fit: contain;" draggable="false">\r\n                        </div>\r\n                    </div> ')])])])),[[_,e.loading]])])),_:1},8,["modelValue","before-close"])}],["__scopeId","data-v-3c3d2ef3"],["__file","D:/project/pixel-grid/src/components/dialog/tools/PintuDialog.vue"]]);const Go=u({name:"IframeDialog",components:{},props:{visible:{type:Boolean,default:!1},name:{type:String,default:""},url:{type:String,default:""}},emits:["close","import"],setup(e,l){let t=g({loading:!0,dialogVisible:e.visible}),o={iframeLoad(){t.loading=!1},handleClose(){t.dialogVisible=!1,l.emit("close")}};return s(s({},m(t)),o)}}),Ho={class:"content","element-loading-background":"#00000000"},zo=["src","name"];var Do=u({name:"tool",components:{PixelDrawDialog:Ce,HalfFrameDialog:ol,BorderDrawDialog:Ot,PintuDialog:$o,IframeDialog:r(Go,[["render",function(e,l,t,o,a,i){const n=h("el-dialog"),s=G("loading");return T(),b(n,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[1]||(l[1]=l=>e.dialogVisible=l),title:e.name,"before-close":e.handleClose,"close-on-click-modal":!1,"lock-scroll":!1,class:"z-dialog",center:"",width:"90%"},{default:x((()=>[H((T(),R("div",Ho,[L("iframe",{target:"_self",id:"iframe",src:e.url,name:e.name,frameborder:"0",onLoad:l[0]||(l[0]=(...l)=>e.iframeLoad&&e.iframeLoad(...l)),sandbox:"allow-scripts allow-top-navigation allow-same-origin",scrolling:"yes"},"\r\n            ",40,zo)])),[[s,e.loading]])])),_:1},8,["modelValue","title","before-close"])}],["__scopeId","data-v-2954b5a7"],["__file","D:/project/pixel-grid/src/components/dialog/tools/IframeDialog.vue"]])},props:{},emits:[],setup(e,l){const t=B(),o=c(),{proxy:a}=_();let i=g({visible1:!1,visible2:!1,visible3:!1,visible4:!1,visibleIframe:!1,iframeUrl:"",iframeName:"",toolList:[{id:1,isVip:!1,name:"像素画",pic:"/pic/tool1.jpg",height:"450px",isLoad:!1},{id:3,isVip:!1,name:"边框水印",pic:"/pic/tool4.jpg",height:"450px",isLoad:!1},{id:2,isVip:!1,name:"半 窗",pic:"/pic/tool3.jpg",height:"450px",isLoad:!1},{id:4,isVip:!1,name:"拼 图",pic:"/pic/tool2.jpg",height:"450px",isLoad:!1},{id:5,isVip:!1,name:"图片取色",pic:"/pic/tool5.png",height:"450px",isLoad:!1,type:"iframe",isIsland:!1,isOut:!1,link:"/html/colorPicker.html",component:"",background:"",icon:""}]}),n={handleVisible(e){"iframe"!==e.type?i[`visible${e.id}`]=!0:t.methods.openWindow(a.$config.windowApp.ImageColorPicker)}};return F((()=>{})),d(s(s({},m(i)),n),{Download:A,editSpaceStore:o})}});const Eo={class:"full-layout scrollbar routerview flex-center"},Io={class:"full-layout flex flex-column"},Fo=(e=>(j("data-v-115de5b5"),e=e(),$(),e))((()=>L("div",{class:"flex-between flex-warp",style:{padding:"20px 20px 10px 20px","row-gap":"10px"}},[L("h2",{class:"title"},"工具箱")],-1))),Ao={class:"full-layout scrollbar scrollAuto grid-box"},Oo=["onClick"],Wo={class:"frameImg"};var Bo=r(Do,[["render",function(e,l,t,o,a,i){const n=h("el-skeleton-item"),s=h("el-skeleton"),d=h("el-image"),r=h("PixelDrawDialog"),u=h("HalfFrameDialog"),c=h("BorderDrawDialog"),p=h("PintuDialog");return T(),R("div",Eo,[L("div",Io,[Fo,L("div",Ao,[(T(!0),R(k,null,I(e.toolList,(l=>(T(),R("div",{key:l.id,class:"tool-item",style:z({height:l.height}),onClick:t=>e.handleVisible(l)},[L("div",Wo,[P(d,{src:l.pic,fit:"cover",class:"full-layout img",onLoad:e=>l.isLoad=!0},{placeholder:x((()=>[P(s,{animated:"",class:"full-layout"},{template:x((()=>[P(n,{variant:"image",style:{height:"100%"}})])),_:1})])),_:2},1032,["src","onLoad"]),H(L("p",{class:"text text-center full-w"},S(l.name),513),[[E,l.isLoad]])])],12,Oo)))),128))])]),e.visible1?(T(),b(r,{key:0,visible:e.visible1,onClose:l[0]||(l[0]=l=>e.visible1=!1)},null,8,["visible"])):U("v-if",!0),e.visible2?(T(),b(u,{key:1,visible:e.visible2,onClose:l[1]||(l[1]=l=>e.visible2=!1)},null,8,["visible"])):U("v-if",!0),e.visible3?(T(),b(c,{key:2,visible:e.visible3,onClose:l[2]||(l[2]=l=>e.visible3=!1)},null,8,["visible"])):U("v-if",!0),e.visible4?(T(),b(p,{key:3,visible:e.visible4,onClose:l[3]||(l[3]=l=>e.visible4=!1)},null,8,["visible"])):U("v-if",!0),U(' <IframeDialog v-if="visibleIframe" :visible="visibleIframe" :url="iframeUrl" :name="iframeName" @close="visibleIframe=false"></IframeDialog> ')])}],["__scopeId","data-v-115de5b5"],["__file","D:/project/pixel-grid/src/views/tool/index.vue"]]);export{Bo as default};
